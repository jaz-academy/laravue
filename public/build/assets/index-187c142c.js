import{_ as S}from"./AppTextField-83dbabc7.js";import{_ as se}from"./AppSelect-ed6cd4b7.js";import{u as N}from"./useApi-e49bb4b3.js";import{r as P}from"./validators-32f2909a.js";import{b5 as ie,a6 as q,a0 as ne,r as p,bm as ge,w as ae,o as M,f as J,e as a,b as t,n as e,aV as b,a$ as _e,d as v,aj as $,v as g,x as h,z as K,aZ as ye,_ as De,a as we,c as Ce,a1 as Z,s as le}from"./main-3e75270a.js";import{_ as xe}from"./AppTextarea-fe657859.js";import{_ as he}from"./AppDrawerHeaderSection-7a5ac0d1.js";import{P as ke}from"./vue3-perfect-scrollbar.esm-f08b44c0.js";import{V as R}from"./VDivider-fe6e0e03.js";import{V as ue}from"./VCard-ae6aa82a.js";import{V as de}from"./VCardText-784ef706.js";import{V as Ue}from"./VForm-6153e7ab.js";import{V as me,a as c}from"./VRow-279ce7f3.js";import{V as Se}from"./VNavigationDrawer-23ebcf1d.js";import{p as je}from"./paginationMeta-4ad053a4.js";import{c as Ae}from"./createUrl-d75555b0.js";import{V as Oe}from"./VAlert-fb1907c4.js";import{V as Pe}from"./VSpacer-1e53768b.js";import{V as qe}from"./VDataTableServer-2165d987.js";import{V as $e}from"./VAvatar-6442f344.js";import{V as Te}from"./VMenu-8f8d9013.js";import{V as Be,a as re}from"./VList-021e7d82.js";import{V as Ne}from"./VPagination-b53a2f8c.js";import"./form-8fcd98db.js";import"./VTextField-0541cff2.js";/* empty css                   */import"./VCounter-1d8f08d6.js";import"./VImg-d48c399c.js";import"./VField-63465900.js";import"./easing-9f15041e.js";import"./VInput-6cf94696.js";import"./forwardRefs-8348545e.js";import"./VSelect-6618e2c9.js";import"./dialog-transition-76c1b16c.js";import"./VOverlay-86f5f384.js";import"./lazy-d118c49f.js";import"./scopeId-6361b14e.js";import"./VCheckboxBtn-5669f4d3.js";import"./VSelectionControl-63626414.js";import"./VChip-8aa9424f.js";import"./helpers-0d858970.js";import"./no-profile-4221a4a6.js";import"./ssrBoot-451ddb83.js";import"./index-9c720871.js";import"./VDataTable-b286073f.js";import"./VTable-1eac49f8.js";import"./filter-112fe26d.js";const Me={class:"d-flex justify-start"},We={__name:"AddCourses",props:{isDrawerOpen:{type:Boolean,required:!0},mode:{type:String,default:"add"},courseData:{type:Object,default:()=>({})}},emits:["update:isDrawerOpen","courseData"],async setup(X,{emit:j}){let k,C;const n=X,x=j,A=([k,C]=ie(()=>N("/subjects")),k=await k,C(),k),D=q(()=>{var l;return[...new Set((l=A==null?void 0:A.data.value.data)==null?void 0:l.map(d=>d.group))].map(d=>({value:d,label:d}))});console.log("subjectsData",D);const T=ne("userData").value,f=p(),_=p(!1),u=ge({name:"",subject:"",note:"",author:"",title:"",section:"",description:"",video_url:"",video_duration:""});ae(()=>[n.courseData,n.mode],()=>{(n.mode==="edit"||n.mode==="duplicate")&&n.courseData?Object.assign(u,{name:n.courseData.name||"",subject:n.courseData.subject||"",note:n.courseData.note||"",author:n.courseData.author||"",title:n.courseData.title||"",section:n.courseData.section||"",description:n.courseData.description||"",video_url:n.courseData.video_url||"",video_duration:n.courseData.video_duration||""}):Object.assign(u,{name:"",subject:"",note:"",author:"",title:"",section:"",description:"",video_url:"",video_duration:""})},{immediate:!0}),ae(()=>n.isDrawerOpen,i=>{var l,d;i||((l=f.value)==null||l.reset(),(d=f.value)==null||d.resetValidation())});const H=i=>{x("update:isDrawerOpen",i)},W=()=>{var i;x("update:isDrawerOpen",!1),(i=f.value)==null||i.reset()},Q=()=>{var i;(i=f.value)==null||i.validate().then(({valid:l})=>{if(!l)return;const d={...u};n.mode==="edit"?(d.id=n.courseData.id,x("courseData",{action:"update",data:d})):x("courseData",{action:"create",data:d}),x("update:isDrawerOpen",!1),ye(W)})};return(i,l)=>{const d=he,E=se,B=xe;return M(),J(Se,{"model-value":n.isDrawerOpen,temporary:"",location:"end",width:"370",class:"category-navigation-drawer scrollable-content","onUpdate:modelValue":H},{default:a(()=>[t(d,{title:n.mode==="edit"?"Edit Courses":n.mode==="duplicate"?"Duplicate Courses":"Add New Courses",onCancel:l[0]||(l[0]=U=>i.$emit("update:isDrawerOpen",!1))},null,8,["title"]),t(R),t(e(ke),{options:{wheelPropagation:!1}},{default:a(()=>[t(ue,{flat:""},{default:a(()=>[t(de,null,{default:a(()=>[t(e(Ue),{ref_key:"refVForm",ref:f,modelValue:e(_),"onUpdate:modelValue":l[10]||(l[10]=U=>b(_)?_.value=U:null),onSubmit:_e(Q,["prevent"])},{default:a(()=>[t(me,null,{default:a(()=>{var U;return[t(c,{cols:"12"},{default:a(()=>[t(S,{modelValue:e(u).name,"onUpdate:modelValue":l[1]||(l[1]=m=>e(u).name=m),label:"Name",placeholder:"Enter course name"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(E,{modelValue:e(u).subject,"onUpdate:modelValue":l[2]||(l[2]=m=>e(u).subject=m),label:"Subject",rules:["requiredValidator"in i?i.requiredValidator:e(P)],items:e(D),"item-title":"label","item-value":"value",placeholder:"Choose Project Subject"},null,8,["modelValue","rules","items"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(S,{modelValue:e(u).note,"onUpdate:modelValue":l[3]||(l[3]=m=>e(u).note=m),label:"Write Note",rules:["requiredValidator"in i?i.requiredValidator:e(P)],placeholder:"Courses Note"},null,8,["modelValue","rules"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(S,{modelValue:e(u).author,"onUpdate:modelValue":l[4]||(l[4]=m=>e(u).author=m),label:"Write Author",rules:["requiredValidator"in i?i.requiredValidator:e(P)],placeholder:"Courses Author"},null,8,["modelValue","rules"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(S,{modelValue:e(u).section,"onUpdate:modelValue":l[5]||(l[5]=m=>e(u).section=m),label:"Write Section",rules:["requiredValidator"in i?i.requiredValidator:e(P)],placeholder:"Courses Section"},null,8,["modelValue","rules"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(S,{modelValue:e(u).title,"onUpdate:modelValue":l[6]||(l[6]=m=>e(u).title=m),label:"Write Title",rules:["requiredValidator"in i?i.requiredValidator:e(P)],placeholder:"Courses Title"},null,8,["modelValue","rules"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(B,{modelValue:e(u).description,"onUpdate:modelValue":l[7]||(l[7]=m=>e(u).description=m),label:"Description",placeholder:"Write Description","auto-grow":""},null,8,["modelValue"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(B,{modelValue:e(u).video_url,"onUpdate:modelValue":l[8]||(l[8]=m=>e(u).video_url=m),label:"Video URL",placeholder:"Write Video URL","auto-grow":""},null,8,["modelValue"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(S,{modelValue:e(u).video_duration,"onUpdate:modelValue":l[9]||(l[9]=m=>e(u).video_duration=m),label:"Write Video Duration",rules:["requiredValidator"in i?i.requiredValidator:e(P)],placeholder:"Courses Video Duration"},null,8,["modelValue","rules"])]),_:1}),((U=e(T))==null?void 0:U.role)>=4?(M(),J(c,{key:0,cols:"12"},{default:a(()=>[v("div",Me,[t($,{type:"submit",color:"primary",class:"me-4"},{default:a(()=>[g(h(n.mode==="edit"?"Update":"Add"),1)]),_:1}),t($,{color:"error",variant:"tonal",onClick:W},{default:a(()=>l[11]||(l[11]=[g(" Discard ")])),_:1})])]),_:1})):K("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const Ee={class:"d-flex flex-wrap gap-4 mx-5"},Fe={class:"d-flex align-center"},ze={class:"d-flex gap-4 flex-wrap align-center"},Ge={class:"d-flex align-center gap-x-2"},Ie={class:"d-flex flex-column"},Le={class:"text-body-1 font-weight-medium"},Re={class:"text-sm text-disabled"},Je={class:"text-primary"},He={class:"text-body-1 font-weight-medium"},Qe={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},Ye={class:"text-sm text-medium-emphasis mb-0"},Ze={__name:"index",async setup(X){let j,k;const C=ne("userData").value,n=p(!1),x=p(""),A=p("primary"),D=(r,o="primary")=>{x.value=r,A.value=o,n.value=!0,setTimeout(()=>{n.value=!1},1e4)},T=N("/courses"),f=p(""),_=p(""),u=p(""),H=q(()=>[...new Set(T.data.value.data.map(r=>r.subject))].sort()),W=q(()=>[...new Set(T.data.value.data.filter(r=>!f.value||r.subject===f.value).map(r=>r.name))].sort()),Q=q(()=>[...new Set(T.data.value.data.filter(r=>!_.value||r.name===_.value).map(r=>r.section))].sort()),i=p(""),l=p(1),d=p(10),E=p(),B=p(),U=r=>{var o,y;l.value=r.page,E.value=(o=r.sortBy[0])==null?void 0:o.key,B.value=(y=r.sortBy[0])==null?void 0:y.order},{data:m,execute:ee}=([j,k]=ie(()=>N(Ae("/courses-custom",{query:{q:()=>i.value,page:()=>l.value,itemsPerPage:()=>d.value,subject:()=>f.value,name:()=>_.value,section:()=>u.value,sortBy:E.value||"",orderBy:B.value||""}}))),j=await j,k(),j);console.log("coursesData:",m);const pe=q(()=>m.value.data),F=q(()=>m.value.count),O=p(!1),z=p("add"),G=p({}),ce=r=>{G.value={...r},z.value="edit",O.value=!0},fe=r=>{G.value={...r},z.value="duplicate",O.value=!0},ve=[{title:"Course",key:"title"},{title:"Subject",key:"subject"},{title:"Author",key:"author"},{title:"Actions",key:"actions",sortable:!1}],te=r=>r==="Tahfidzh"?{color:"success",icon:"tabler-book-2"}:r==="Graphic Design"?{color:"primary",icon:"tabler-brand-adobe-illustrator"}:r==="Video Editing"?{color:"primary",icon:"tabler-brand-adobe-premier"}:r==="Python Programming"?{color:"info",icon:"tabler-brand-python"}:r==="JavaScript Programming"?{color:"info",icon:"tabler-brand-react"}:r==="Web Development"?{color:"info",icon:"tabler-device-imac"}:r==="Mobile Development"?{color:"info",icon:"tabler-device-mobile"}:r==="Google Workspace"?{color:"warning",icon:"tabler-brand-google"}:r==="Game Development"?{color:"info",icon:"tabler-device-gamepad-2"}:{color:"secondary",icon:"tabler-world"},Ve=async({action:r,data:o})=>{var I;if((C==null?void 0:C.role)<4){D("You do not have permission to modify plans","error");return}const y={...o};console.log("Sending CourseData:",y,"action:",r);try{let V="/courses",w="POST";r==="update"&&o.id&&(V=`/courses/${o.id}`,w="PUT");const{data:L,response:s}=await N(V,{method:w,body:JSON.stringify(y),headers:{"Content-Type":"application/json",Accept:"application/json"}});s.value.ok?(D(r==="create"?"Data berhasil ditambahkan":"Data berhasil diperbarui","success"),console.log("Course response:",L),ee()):D(s.value.statusText||"Gagal menyimpan data","error")}catch(V){console.error("Course save error:",((I=V==null?void 0:V.data)==null?void 0:I.errors)||V),D(V.message||"Gagal menyimpan data","error")}},be=async r=>{try{confirm("Apakah kamu yakin ingin menghapus data ini?")&&(console.log("Deleting Course with ID:",r),await N(`/courses/${r}`,{method:"DELETE"}),D("Data berhasil dihapus","success"),ee())}catch(o){D(o.message||"Gagal menghapus data","error"),console.error(o)}};return(r,o)=>{const y=se,I=S,V=we("IconBtn");return M(),Ce("div",null,[t(Oe,{modelValue:e(n),"onUpdate:modelValue":o[0]||(o[0]=w=>b(n)?n.value=w:null),closable:"","close-label":"Close Alert",class:"mb-6",color:e(A)},{default:a(()=>[g(h(e(x)),1)]),_:1},8,["modelValue","color"]),t(ue,{title:"Filters",class:"mb-6"},{default:a(()=>{var w,L;return[t(de,null,{default:a(()=>[t(me,null,{default:a(()=>[t(c,{cols:"12",sm:"4"},{default:a(()=>[t(y,{modelValue:e(f),"onUpdate:modelValue":o[1]||(o[1]=s=>b(f)?f.value=s:null),placeholder:"Subject",items:e(H),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",sm:"4"},{default:a(()=>[t(y,{modelValue:e(_),"onUpdate:modelValue":o[2]||(o[2]=s=>b(_)?_.value=s:null),placeholder:"Name",items:e(W),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",sm:"4"},{default:a(()=>[t(y,{modelValue:e(u),"onUpdate:modelValue":o[3]||(o[3]=s=>b(u)?u.value=s:null),placeholder:"Section",items:e(Q),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(R,{class:"my-4"}),v("div",Ee,[v("div",Fe,[t(I,{modelValue:e(i),"onUpdate:modelValue":o[4]||(o[4]=s=>b(i)?i.value=s:null),placeholder:"Search Course",density:"compact",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),t(Pe),v("div",ze,[t(y,{modelValue:e(d),"onUpdate:modelValue":o[5]||(o[5]=s=>b(d)?d.value=s:null),items:[5,10,20,25,50]},null,8,["modelValue"]),t($,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload"},{default:a(()=>o[11]||(o[11]=[g(" Export ")])),_:1}),(L=(w=e(C))==null?void 0:w.access)!=null&&L.includes("Courses")?(M(),J($,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:o[6]||(o[6]=()=>{z.value="add",G.value={},O.value=!0})},{default:a(()=>o[12]||(o[12]=[g(" Add Course ")])),_:1})):K("",!0)])]),t(R,{class:"mt-4"}),t(e(qe),{"items-per-page":e(d),"onUpdate:itemsPerPage":o[8]||(o[8]=s=>b(d)?d.value=s:null),page:e(l),"onUpdate:page":o[9]||(o[9]=s=>b(l)?l.value=s:null),headers:ve,"show-select":"",items:e(pe),"items-length":e(F),class:"text-no-wrap","onUpdate:options":U},{"item.title":a(({item:s})=>[v("div",Ge,[v("div",Ie,[v("span",Le,h(s.title),1),v("span",Re,[v("span",Je,h(s.name)+" : ",1),g(" "+h(s.section),1)])])])]),"item.subject":a(({item:s})=>[t($e,{size:"30",variant:"tonal",color:te(s.subject).color,class:"me-2"},{default:a(()=>[t(Z,{icon:te(s.subject).icon,size:"18"},null,8,["icon"])]),_:2},1032,["color"]),v("span",He,h(s.subject),1)]),"item.author":a(({item:s})=>[g(h(s.author),1)]),"item.actions":a(({item:s})=>{var Y;return[t(V,null,{default:a(()=>[t(Z,{icon:"tabler-edit",onClick:oe=>ce(s)},null,8,["onClick"])]),_:2},1024),((Y=e(C))==null?void 0:Y.role)>=4?(M(),J(V,{key:0},{default:a(()=>[t(Z,{icon:"tabler-dots-vertical"}),t(Te,{activator:"parent"},{default:a(()=>[t(Be,null,{default:a(()=>[t(re,{value:"delete","prepend-icon":"tabler-trash",onClick:oe=>be(s.id)},{default:a(()=>o[13]||(o[13]=[g(" Delete ")])),_:2},1032,["onClick"]),t(re,{value:"duplicate","prepend-icon":"tabler-copy",onClick:oe=>fe(s)},{default:a(()=>o[14]||(o[14]=[g(" Duplicate ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):K("",!0)]}),bottom:a(()=>[t(R),v("div",Qe,[v("p",Ye,h(e(je)({page:e(l),itemsPerPage:e(d)},e(F))),1),t(Ne,{modelValue:e(l),"onUpdate:modelValue":o[7]||(o[7]=s=>b(l)?l.value=s:null),length:Math.min(Math.ceil(e(F)/e(d)),5),"total-visible":r.$vuetify.display.xs?1:Math.min(Math.ceil(e(F)/e(d)),5)},{prev:a(s=>[t($,le({variant:"tonal",color:"default"},s,{icon:!1}),{default:a(()=>o[15]||(o[15]=[g(" Previous ")])),_:2},1040)]),next:a(s=>[t($,le({variant:"tonal",color:"default"},s,{icon:!1}),{default:a(()=>o[16]||(o[16]=[g(" Next ")])),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]}),_:1}),t(We,{"is-drawer-open":e(O),"onUpdate:isDrawerOpen":o[10]||(o[10]=w=>b(O)?O.value=w:null),mode:e(z),"course-data":e(G),onCourseData:Ve},null,8,["is-drawer-open","mode","course-data"])])}}},Lt=De(Ze,[["__scopeId","data-v-c97ee74e"]]);export{Lt as default};
