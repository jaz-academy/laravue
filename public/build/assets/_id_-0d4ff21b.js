import{u as $,h as M}from"./helpers-3fbb07dd.js";import{V as q}from"./VNodeRenderer-4c0717a1.js";import{j as G,a5 as S,r as w,b5 as P,n as e,o as c,c as b,b as l,e as o,z as g,f as h,d as t,I as R,x as a,F as T,v as r,a0 as F,i as H,ai as _}from"./main-7487d517.js";import{u as B}from"./useApi-2f2d676b.js";import{V as J}from"./VRow-9d945ad9.js";import{V as j}from"./VCol-fe7d94c6.js";import{V as p}from"./VCardText-5f738b43.js";import{V as x}from"./VDivider-6be2b96b.js";import{V as K}from"./VTable-2039da19.js";import{V}from"./VCard-a39876b1.js";import"./no-profile-4221a4a6.js";import"./VAvatar-6d04c863.js";import"./VImg-07fecb91.js";const Q={key:0},W={class:"ma-sm-4"},X={class:"d-flex align-center mb-6"},Y={class:"font-weight-bold text-capitalize text-h4"},Z={class:"mb-0"},tt={class:"my-2"},st={class:"mb-0"},et={class:"mt-4 ma-sm-4"},lt={class:"font-weight-medium text-h5"},ot={class:"mt-4 ma-sm-4"},at={class:"pb-1"},nt={class:"font-weight-medium"},it={class:"pb-1"},dt={class:"pb-1"},mt={class:"pb-1"},rt={class:"text-no-wrap"},ut={class:"text-no-wrap"},ct={class:"text-end"},pt={class:"my-2 mx-sm-4 text-base"},ft={class:"d-flex align-center mb-1"},bt={class:"my-2 mx-sm-4"},_t={class:"text-end"},xt={class:"font-weight-medium text-high-emphasis"},yt={class:"mb-0"},vt={class:"d-flex mx-sm-4"},Bt={__name:"[id]",async setup(wt){let d,f;const{hasRoleAndAccess:E,currentUser:gt}=$(),D=G(),y=S(()=>D.params.id),z=w(!1),i=w([]),u=w([]),{data:v}=([d,f]=P(()=>B(`/payments-by-invoice/${y.value}`)),d=await d,f(),d),{data:L}=([d,f]=P(()=>B("/schools")),d=await d,f(),d);//! Console Log to check the raw data from the API
console.log("Raw invoiceData from API:",v.value),i.value=v.value.data,u.value=L.value;const O=S(()=>i.value.reduce((k,s)=>k+(Number(s.amount)||0),0)),U=()=>{window.print()};return(k,s)=>e(v)?(c(),b("section",Q,[l(J,null,{default:o(()=>[l(j,{cols:"12",md:"9"},{default:o(()=>[e(y)!=="new"?(c(),h(V,{key:0},{default:o(()=>[l(p,{class:"d-flex flex-wrap justify-space-between flex-column flex-sm-row print-row"},{default:o(()=>{var n,m;return[t("div",W,[t("div",X,[l(e(q),{nodes:e(R).app.logo,class:"me-3"},null,8,["nodes"]),t("h6",Y,a(e(R).app.title),1)]),(m=(n=e(u))==null?void 0:n.data)!=null&&m.length?(c(),b(T,{key:0},[t("p",Z,[r(a(e(u).data[0].name)+" âœª ",1),t("strong",null,a(e(u).data[0].organization),1)]),t("p",tt,a(e(u).data[0].address),1),t("p",st,[l(F,{icon:"tabler-phone",class:"me-2"}),r(" "+a(e(u).data[0].phone)+" ",1),l(F,{icon:"tabler-mail",class:"mx-2"}),r(" "+a(e(u).data[0].email),1)])],64)):g("",!0)]),t("div",et,[t("h6",lt," Invoice #"+a(e(y)),1)])]}),_:1}),l(x),l(p,{class:"d-flex justify-space-between flex-wrap flex-column flex-sm-row print-row"},{default:o(()=>{var n,m,I,N,C,A;return[s[6]||(s[6]=t("div",{class:"ma-sm-4"},null,-1)),t("div",ot,[s[5]||(s[5]=t("h6",{class:"text-h6 font-weight-medium mb-6"}," Payment Details: ",-1)),t("table",null,[t("tbody",null,[t("tr",null,[s[1]||(s[1]=t("td",{class:"pe-6 pb-1"}," Date: ",-1)),t("td",at,[t("span",nt,a(e(M)((n=e(i)[0])==null?void 0:n.date)),1)])]),t("tr",null,[s[2]||(s[2]=t("td",{class:"pe-6 pb-1"}," Student: ",-1)),t("td",it,a((I=(m=e(i)[0])==null?void 0:m.admin_student)==null?void 0:I.name),1)]),t("tr",null,[s[3]||(s[3]=t("td",{class:"pe-6 pb-1"}," Payment Category: ",-1)),t("td",dt,a((C=(N=e(i)[0])==null?void 0:N.admin_student)==null?void 0:C.payment_category),1)]),t("tr",null,[s[4]||(s[4]=t("td",{class:"pe-6 pb-1"}," Period: ",-1)),t("td",mt,a((A=e(i)[0])==null?void 0:A.period),1)])])])])]}),_:1}),l(x),l(K,{class:"invoice-preview-table"},{default:o(()=>[s[9]||(s[9]=t("thead",null,[t("tr",null,[t("th",{class:"d-none d-md-table-cell"}),t("th",{scope:"col"}," NO "),t("th",{scope:"col"}," DESCRIPTION "),t("th",{scope:"col",class:"text-end"}," AMOUNT "),t("th",{class:"d-none d-md-table-cell"})])],-1)),t("tbody",null,[(c(!0),b(T,null,H(e(i),(n,m)=>(c(),b("tr",{key:m},[s[7]||(s[7]=t("td",{class:"d-none d-md-table-cell"},null,-1)),t("td",rt,a(m+1),1),t("td",ut,a(n.billing),1),t("td",ct,a(Number(n.amount).toLocaleString("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0})),1),s[8]||(s[8]=t("td",{class:"d-none d-md-table-cell"},null,-1))]))),128))])]),_:1}),l(x,{class:"mb-2"}),l(p,{class:"d-flex justify-space-between flex-column flex-sm-row print-row"},{default:o(()=>{var n;return[t("div",pt,[t("div",ft,[s[10]||(s[10]=t("h6",{class:"text-base font-weight-medium me-1"}," Admin: ",-1)),t("span",null,a((n=e(i)[0])==null?void 0:n.admin),1)]),s[11]||(s[11]=t("p",null,"Thanks for your contribution",-1))]),t("div",bt,[t("table",null,[t("tbody",null,[t("tr",_t,[s[12]||(s[12]=t("td",{class:"text-end"},[t("div",{class:"me-5"},[t("p",{class:"mb-0"}," Total: ")])],-1)),t("td",xt,[t("p",yt,a(Number(e(O)).toLocaleString("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0})),1)])])])])])]}),_:1}),l(x),l(p,null,{default:o(()=>{var n;return[t("div",vt,[s[13]||(s[13]=t("h6",{class:"text-base font-weight-medium me-1"}," Note: ",-1)),t("span",null,a((n=e(i)[0])==null?void 0:n.billing),1)])]}),_:1})]),_:1})):(c(),h(V,{key:1},{default:o(()=>[l(p,null,{default:o(()=>s[14]||(s[14]=[r(" Select the payment you want to preview. ")])),_:1})]),_:1}))]),_:1}),l(j,{cols:"12",md:"3",class:"d-print-none"},{default:o(()=>[l(V,null,{default:o(()=>[l(p,null,{default:o(()=>[l(_,{block:"","prepend-icon":"tabler-send",class:"mb-2 d-none",onClick:s[0]||(s[0]=n=>z.value=!0)},{default:o(()=>s[15]||(s[15]=[r(" Send Invoice ")])),_:1}),l(_,{block:"",class:"mb-2",onClick:U},{default:o(()=>s[16]||(s[16]=[r(" Print ")])),_:1}),e(E)(3,"Payment").value?(c(),h(_,{key:0,block:"",color:"secondary",variant:"tonal",class:"mb-2",to:{name:"financial-payment-edit-id",params:{id:e(D).params.id}}},{default:o(()=>s[17]||(s[17]=[r(" Edit Invoice ")])),_:1},8,["to"])):g("",!0),l(_,{block:"",color:"secondary",variant:"tonal",to:{name:"financial-payment-list"}},{default:o(()=>s[18]||(s[18]=[r(" Exit ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])):g("",!0)}};export{Bt as default};
