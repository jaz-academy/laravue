import{p as fe,a as Ve}from"./formatters-b77a216c.js";import{_ as O}from"./AppTextField-5723627d.js";import{_ as M}from"./AppSelect-c31ef19a.js";import{u as ge}from"./helpers-0ad46068.js";import{f as he,t as L,a as ye}from"./fetchTeacherData-f454908a.js";import{r as U}from"./validators-b7220445.js";import{r as i,o as N,f as R,e as t,b as e,n,aU as _,a$ as be,ai as $,v as w,aY as re,H as _e,a5 as Y,a as oe,c as Q,d,F as we,i as ke,x as f,y as Se,a0 as K,z as xe,s as se}from"./main-37de545e.js";import{_ as Ce}from"./AppDateTimePicker-5406148e.js";import{_ as Te}from"./AppDrawerHeaderSection-03920035.js";import{P as Pe}from"./vue3-perfect-scrollbar.esm-8e676bb4.js";import{V as E}from"./VCard-c1035577.js";import{V as j}from"./VCardText-87a2555b.js";import{V as De}from"./VForm-8be29ffd.js";import{V as X,a as p}from"./VRow-fac58b63.js";import{V as Ue}from"./VNavigationDrawer-dbfad57c.js";import{p as Ae}from"./paginationMeta-4ad053a4.js";import{u as ne}from"./useApi-7afb6e9f.js";import{V as qe}from"./VAlert-df2ee2c3.js";import{V as ie}from"./VAvatar-93aa4262.js";import{V as Be}from"./VSpacer-33f3a832.js";import{V as ue}from"./VDivider-bd657aeb.js";import{V as Ne}from"./VDataTableServer-7c77b74a.js";import{V as Fe}from"./VImg-ab0ba356.js";import{V as Le}from"./VChip-eda1d933.js";import{V as Oe}from"./VPagination-35ceb8ed.js";import"./form-2eea43bf.js";import"./VTextField-e524b538.js";/* empty css                   */import"./VCounter-2e970494.js";import"./VField-5bdf7c6e.js";import"./easing-9f15041e.js";import"./VInput-9309032d.js";import"./forwardRefs-8348545e.js";import"./VSelect-89c1ecf3.js";import"./VList-002b35c7.js";import"./ssrBoot-a125e40e.js";import"./dialog-transition-4715d8ab.js";import"./VMenu-77bc6832.js";import"./VOverlay-f715a3c8.js";import"./lazy-f1e50cea.js";import"./scopeId-3f0b9f79.js";import"./VCheckboxBtn-ecef6dcc.js";import"./VSelectionControl-8d59c827.js";import"./no-profile-4221a4a6.js";import"./VDataTable-9f9d9fdf.js";import"./VTable-b1abc415.js";import"./filter-53777fba.js";const $e={__name:"AddNewTeacher",props:{isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","userData"],setup(Z,{emit:z}){const G=Z,k=z,A=new Date().getFullYear(),C=i(!1),g=i(),S=i(""),q=i(""),B=i(""),h=i(""),c=i(A),V=i("7"),T=i(""),P=i(""),y=i(""),W=s=>Array.from({length:s},(o,D)=>A-D),I=()=>{k("update:isDrawerOpen",!1),re(()=>{var s,o;(s=g.value)==null||s.reset(),(o=g.value)==null||o.resetValidation()})},x=()=>{var s;(s=g.value)==null||s.validate().then(({valid:o})=>{o&&(k("userData",{nig:S.value,name:q.value,nickname:B.value,gender:h.value,grade:V.value,registered:c.value,phone:T.value,birth_date:y.value,birth_place:P.value}),k("update:isDrawerOpen",!1),re(()=>{var D,F;(D=g.value)==null||D.reset(),(F=g.value)==null||F.resetValidation()}))})},H=s=>{k("update:isDrawerOpen",s)};return(s,o)=>{const D=Te,F=Ce;return N(),R(Ue,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":G.isDrawerOpen,"onUpdate:modelValue":H},{default:t(()=>[e(D,{title:"Add New Teacher",onCancel:I}),e(n(Pe),{options:{wheelPropagation:!1}},{default:t(()=>[e(E,{flat:""},{default:t(()=>[e(j,null,{default:t(()=>[e(De,{ref_key:"refForm",ref:g,modelValue:n(C),"onUpdate:modelValue":o[9]||(o[9]=u=>_(C)?C.value=u:null),onSubmit:be(x,["prevent"])},{default:t(()=>[e(X,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[e(O,{modelValue:n(S),"onUpdate:modelValue":o[0]||(o[0]=u=>_(S)?S.value=u:null),rules:["requiredValidator"in s?s.requiredValidator:n(U)],label:"NIG",placeholder:"201122"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(O,{modelValue:n(q),"onUpdate:modelValue":o[1]||(o[1]=u=>_(q)?q.value=u:null),rules:["requiredValidator"in s?s.requiredValidator:n(U)],label:"Name",placeholder:"John Doe"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(O,{modelValue:n(B),"onUpdate:modelValue":o[2]||(o[2]=u=>_(B)?B.value=u:null),rules:["requiredValidator"in s?s.requiredValidator:n(U)],label:"Nickname",placeholder:"John"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(M,{modelValue:n(h),"onUpdate:modelValue":o[3]||(o[3]=u=>_(h)?h.value=u:null),label:"Select Gender",placeholder:"Select Gender",rules:["requiredValidator"in s?s.requiredValidator:n(U)],items:["Laki-laki","Perempuan"]},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(M,{modelValue:n(c),"onUpdate:modelValue":o[4]||(o[4]=u=>_(c)?c.value=u:null),rules:["requiredValidator"in s?s.requiredValidator:n(U)],label:"Registered",placeholder:"2025",items:W(3)},null,8,["modelValue","rules","items"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(M,{modelValue:n(V),"onUpdate:modelValue":o[5]||(o[5]=u=>_(V)?V.value=u:null),rules:["requiredValidator"in s?s.requiredValidator:n(U)],label:"Grade",placeholder:"1",items:["1","2","3","4","5","6","7"]},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(O,{modelValue:n(T),"onUpdate:modelValue":o[6]||(o[6]=u=>_(T)?T.value=u:null),rules:["requiredValidator"in s?s.requiredValidator:n(U)],label:"Phone Number",placeholder:"+62 888 1234 5678"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(O,{modelValue:n(P),"onUpdate:modelValue":o[7]||(o[7]=u=>_(P)?P.value=u:null),rules:["requiredValidator"in s?s.requiredValidator:n(U)],label:"Birth Place",placeholder:"Where your Birth place?"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(F,{modelValue:n(y),"onUpdate:modelValue":o[8]||(o[8]=u=>_(y)?y.value=u:null),label:"Select Birth Date",placeholder:"Select date"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e($,{type:"submit",class:"me-3"},{default:t(()=>o[10]||(o[10]=[w(" Submit ")])),_:1}),e($,{type:"reset",variant:"outlined",color:"secondary",onClick:I},{default:t(()=>o[11]||(o[11]=[w(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},ze={class:"d-flex mb-6"},Ye={class:"d-flex justify-space-between"},Ge={class:"d-flex flex-column gap-y-1"},Ie={class:"text-body-1 text-medium-emphasis"},Me={class:"text-h4"},Re={class:"text-sm"},Ee={class:"me-3 d-flex gap-3"},je={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},We={style:{"inline-size":"10rem"}},He={class:"d-flex align-center"},Je={key:1},Qe={class:"d-flex flex-column"},Ke={class:"text-base"},Xe={class:"text-sm text-medium-emphasis"},Ze={class:"d-flex align-center gap-4"},ea={class:"text-capitalize"},aa={class:"text-capitalize font-weight-medium"},la={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},ta={class:"text-sm text-disabled mb-0"},Ka={__name:"index",setup(Z){const{hasRoleAndAccess:z,hasRoleOrTeacher:G}=ge();_e(()=>{he()});const k=i(""),A=i(""),C=i(""),g=i(""),S=i(!1),q=i(""),B=i("primary"),h=(r,a="primary")=>{q.value=r,B.value=a,S.value=!0,setTimeout(()=>{S.value=!1},1e4)},c=i(10),V=i(1),T=i(""),P=i(""),y=i([]),W=r=>{var a;V.value=r.page,c.value=r.itemsPerPage,k.value=r.search||"",g.value=r.status||"",C.value=r.city||"",A.value=r.year||"",(a=r.sortBy)!=null&&a.length?(T.value=r.sortBy[0].key,P.value=r.sortBy[0].order):(T.value=null,P.value=null),x()},I=[{title:"Name",key:"name"},{title:"Year",key:"registered"},{title:"City",key:"city"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],x=async()=>{const r={q:k.value||"",status:g.value||"",city:C.value||"",year:A.value||"",itemsPerPage:c.value,page:V.value,sortBy:T.value||"",orderBy:P.value||""};try{const a=await ye(r);console.log("ðŸ“¦ FETCHING with:",r,a),y.value=a}catch(a){console.error("Error fetching Teachers:",a.message)}},H=Y(()=>{var r;return((r=y.value)==null?void 0:r.users)||[]}),s=Y(()=>{var r;return((r=y.value)==null?void 0:r.totalUsers)||0}),o=Y(()=>{var m,b;const r=((b=(m=y.value)==null?void 0:m.users)==null?void 0:b.map(v=>v.registered))||[];return[...new Set(r.filter(v=>typeof v=="number"))].map(v=>({title:String(v),value:String(v)}))}),D=Y(()=>{var m,b;const r=((b=(m=y.value)==null?void 0:m.users)==null?void 0:b.map(v=>v.city))||[];return[...new Set(r.filter(Boolean))].map(v=>({title:v,value:v}))}),F=[{title:"Active",value:"active"},{title:"On Duty",value:"on_duty"},{title:"Passive",value:"passive"},{title:"Suspend",value:"suspend"}],u=r=>L.value.filter(a=>(a.gender||"").toLowerCase()===r.toLowerCase()&&a.status==="Active").length,ee=r=>L.value.length===0?0:(u(r)/L.value.length*100).toFixed(0),ae=Y(()=>L.value.filter(r=>r.status==="Suspend").length),de=r=>L.value.length===0?0:(r/L.value.length*100).toFixed(0),me=r=>{if(!r)return"primary";const a=r.toLowerCase();return a==="active"?"primary":a==="passive"?"warning":a==="on duty"?"success":a==="suspend"?"error":"primary"},J=i(!1),ce=async r=>{var a;console.log("Sending userData:",r);try{const{data:m,response:b}=await ne("/teachers",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Accept:"application/json"}});b.value.ok?(h("Data berhasil ditambahkan","success"),console.log("Teacher created:",m),x()):h(b.value.statusText||"Gagal menambahkan data","error")}catch(m){console.error("Create Teacher error:",((a=m==null?void 0:m.data)==null?void 0:a.errors)||m),h(m.message||"Gagal menambahkan data","error")}},pe=async r=>{try{confirm("Apakah kamu yakin ingin menghapus data ini?")&&(console.log("Deleting teacher with ID:",r),await ne(`/teachers/${r}`,{method:"DELETE"}),h("Data berhasil dihapus","success"),x())}catch(a){h(a.message||"Gagal menghapus data","error"),console.error(a)}},ve=i([{title:"Male Active",value:u("Laki-laki").toLocaleString(),change:ee("Laki-laki"),desc:"Total Teachers",icon:"tabler-user",iconColor:"primary"},{title:"Female Active",value:u("Perempuan").toLocaleString(),change:ee("Perempuan"),desc:"Total Teachers",icon:"tabler-user",iconColor:"warning"},{title:"Suspended",value:ae.value,change:de(ae.value),desc:"Suspended Teachers",icon:"tabler-user-exclamation",iconColor:"error"}]);return(r,a)=>{const m=M,b=O,v=oe("RouterLink"),le=oe("IconBtn");return N(),Q("section",null,[d("div",ze,[e(X,null,{default:t(()=>[(N(!0),Q(we,null,ke(ve.value,(l,te)=>(N(),R(p,{key:te,cols:"12",md:"4",sm:"6"},{default:t(()=>[e(E,null,{default:t(()=>[e(j,null,{default:t(()=>[d("div",Ye,[d("div",Ge,[d("span",Ie,f(l.title),1),d("div",null,[d("h4",Me,[w(f(l.value)+" ",1),d("span",{class:Se(["text-base",l.change>0?"text-success":"text-error"])},"("+f(("prefixWithPlus"in r?r.prefixWithPlus:n(fe))(l.change))+"%)",3)])]),d("span",Re,f(l.desc),1)]),e(ie,{color:l.iconColor,variant:"tonal",rounded:"",size:"38"},{default:t(()=>[e(K,{icon:l.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),e(E,{title:"Filters",class:"mb-6"},{default:t(()=>[e(j,null,{default:t(()=>[e(X,null,{default:t(()=>[e(p,{cols:"12",sm:"4"},{default:t(()=>[e(m,{modelValue:A.value,"onUpdate:modelValue":[a[0]||(a[0]=l=>A.value=l),x],label:"Select Year",placeholder:"Select Year",items:o.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",sm:"4"},{default:t(()=>[e(m,{modelValue:C.value,"onUpdate:modelValue":[a[1]||(a[1]=l=>C.value=l),x],label:"Select City",placeholder:"Select City",items:D.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",sm:"4"},{default:t(()=>[e(m,{modelValue:g.value,"onUpdate:modelValue":[a[2]||(a[2]=l=>g.value=l),x],label:"Select Status",placeholder:"Select Status",items:F,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(qe,{modelValue:S.value,"onUpdate:modelValue":a[3]||(a[3]=l=>S.value=l),closable:"","close-label":"Close Alert",class:"mb-6",color:B.value},{default:t(()=>[w(f(q.value),1)]),_:1},8,["modelValue","color"]),e(E,null,{default:t(()=>[e(j,{class:"d-flex flex-wrap py-4 gap-4"},{default:t(()=>[d("div",Ee,[e(m,{"model-value":c.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":a[4]||(a[4]=l=>c.value=parseInt(l,10))},null,8,["model-value"])]),e(Be),d("div",je,[d("div",We,[e(b,{modelValue:k.value,"onUpdate:modelValue":a[5]||(a[5]=l=>k.value=l),placeholder:"Search",density:"compact",onInput:x},null,8,["modelValue"])]),e($,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:t(()=>a[11]||(a[11]=[w(" Export ")])),_:1}),n(z)(2,"Profile").value?(N(),R($,{key:0,"prepend-icon":"tabler-plus",onClick:a[6]||(a[6]=l=>J.value=!0)},{default:t(()=>a[12]||(a[12]=[w(" Add New Teacher ")])),_:1})):xe("",!0)])]),_:1}),e(ue),e(n(Ne),{"items-per-page":c.value,"onUpdate:itemsPerPage":a[8]||(a[8]=l=>c.value=l),page:V.value,"onUpdate:page":a[9]||(a[9]=l=>V.value=l),items:H.value,"items-length":s.value,headers:I,class:"text-no-wrap","onUpdate:options":W},{"item.name":t(({item:l})=>[d("div",He,[e(ie,{size:"34",variant:l.avatar?void 0:"tonal",class:"me-3 overflow-hidden"},{default:t(()=>[l!=null&&l.image?(N(),R(Fe,{key:0,cover:"",src:`/storage/${l.image}`},null,8,["src"])):(N(),Q("span",Je,f(("avatarText"in r?r.avatarText:n(Ve))(l.name)),1))]),_:2},1032,["variant"]),d("div",Qe,[d("h6",Ke,[e(v,{to:{name:"profile-teacher-id-tab",params:{id:l.id,tab:"account"}},class:"font-weight-medium text-link"},{default:t(()=>[w(f(l.name),1)]),_:2},1032,["to"])]),d("span",Xe,f(l.nig)+" - "+f(l.nickname),1)])])]),"item.registered":t(({item:l})=>[d("div",Ze,[d("span",ea,f(l.registered),1)])]),"item.city":t(({item:l})=>[d("span",aa,f(l.city),1)]),"item.status":t(({item:l})=>[e(Le,{color:me(l.status||""),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[w(f(l.status),1)]),_:2},1032,["color"])]),"item.actions":t(({item:l})=>[e(le,{disabled:!n(z)(4,"Profile").value,color:n(z)(4,"Profile").value?"error":"secondary",onClick:te=>pe(l.id)},{default:t(()=>[e(K,{icon:"tabler-trash"})]),_:2},1032,["disabled","color","onClick"]),e(le,{to:{name:"profile-teacher-id-tab",params:{id:l.id,tab:"account"}},color:n(G)(4,l.id).value?"primary":"secondary",disabled:!n(G)(4,l.id).value},{default:t(()=>[e(K,{icon:"tabler-edit"})]),_:2},1032,["to","color","disabled"])]),bottom:t(()=>[e(ue),d("div",la,[d("p",ta,f(n(Ae)({page:V.value,itemsPerPage:c.value},s.value)),1),e(Oe,{modelValue:V.value,"onUpdate:modelValue":a[7]||(a[7]=l=>V.value=l),length:Math.ceil(s.value/c.value),"total-visible":r.$vuetify.display.xs?1:Math.ceil(s.value/c.value)},{prev:t(l=>[e($,se({variant:"tonal",color:"default"},l,{icon:!1}),{default:t(()=>a[13]||(a[13]=[w(" Previous ")])),_:2},1040)]),next:t(l=>[e($,se({variant:"tonal",color:"default"},l,{icon:!1}),{default:t(()=>a[14]||(a[14]=[w(" Next ")])),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),e($e,{"is-drawer-open":J.value,"onUpdate:isDrawerOpen":a[10]||(a[10]=l=>J.value=l),onUserData:ce},null,8,["is-drawer-open"])])}}};export{Ka as default};
