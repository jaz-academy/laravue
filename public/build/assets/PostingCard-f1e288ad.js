import{c as B}from"./formatters-8cae111f.js";import{r as f,a6 as O,H,b6 as J,a as W,o as m,f as d,e as s,b as t,z as x,d as o,n,v as g,x as u,c as L,aV as b,a1 as N,a$ as F,aj as M}from"./main-4585feec.js";import{_ as G}from"./AppTextarea-a2a2d4ad.js";import{_ as Q}from"./AppSelect-f110362d.js";import{a as k}from"./no-profile-4221a4a6.js";import{_ as q}from"./GDriveEmbed-3a41abba.js";import{_ as K}from"./InstagramEmbed-3b9781ca.js";import{t as X,f as Z}from"./fetchTeacherData-404e675a.js";import{$ as ee}from"./api-6966f9b4.js";import{V as te}from"./VCardText-dd0c7bc9.js";import{V as T,a as y}from"./VRow-53fd1544.js";import{V as U}from"./VAvatar-fa9fec94.js";import{V as w}from"./VImg-02cfc59c.js";import{V as C}from"./VRating-5d9669bb.js";import{V as ae}from"./VAlert-83fb7352.js";import{V as se}from"./VForm-ee9cccf5.js";import{V as le}from"./VList-4b4f9347.js";import{V as oe}from"./VCard-a267c840.js";const ne={class:"d-flex align-center"},re={class:"d-flex flex-column"},ie={class:"text-base"},me={class:"text-sm text-medium-emphasis"},de={class:"text-body-1 text-primary"},ce={class:"text-body-2 d-inline"},ue={class:"d-flex align-center mt-4"},pe={class:"d-flex flex-column"},fe={class:"d-flex flex-column"},ve={class:"text-base text-primary ms-1"},_e={class:"text-sm text-medium-emphasis cursor-pointer"},ge={class:"text-body-2 mt-2"},be={class:"d-flex justify-space-between my-4 flex-wrap action-icons"},ye={class:""},he={key:0,class:"modal-overlay"},Ve={class:"modal-content"},xe={class:"flex-grow-1 overflow-auto d-none",style:{"max-block-size":"100%"}},ke=["innerHTML"],Ye={__name:"PostingCard",props:{taskId:Number,taskName:String,description:String,subject:String,theme:String,stars:String,media:String,postId:String,studentName:String,nickname:String,email:String,teacher:Object,studentImg:String,teacherImg:String,accepted:Number,review:String},setup(I){const a=I,$=localStorage.getItem("participant"),A=$?JSON.parse($):null,h=f(!1),c=f(""),v=f(a.teacher),V=f(a.accepted?"Yes":"No"),p=f(a.review),i=f(a.stars),S=f(!!a.accepted),j=O(()=>X.value.map(r=>({title:r.nickname,value:{id:r.id,name:r.nickname}}))),z=r=>{r==="Yes"?S.value=!0:S.value=!1},E=async()=>{if(v.value===""){c.value="Please select a mentor";return}else if(V.value===""){c.value="Please select accepted";return}else if(i.value===0){c.value="Please select a rating";return}else if(p.value===""){c.value="Please write a review";return}else{const r={admin_teacher_id:v.value.id,accepted:V.value=="Yes"?1:0,rate:i.value,review:p.value};console.log("Rating submitted:",r);try{const e=await ee(`/public/update-task-accepted/${a.taskId}`,{method:"POST",body:r,onResponseError({err:_}){c.value=_}});console.log("Rating response:",e),i.value=e.data.rate,p.value=e.data.review}catch(e){console.error("Error submitting rating:",e)}h.value=!1}},R=()=>{(window.scrollY||document.documentElement.scrollTop)>100&&(h.value=!1)};H(()=>{Z(),window.addEventListener("scroll",R)}),J(()=>{window.removeEventListener("scroll",R)});const D=[{prependAvatar:k,title:"Brunch this weekend?",subtitle:`<span class="text-primary">Ali Connors</span> &mdash; I'll be in your neighborhood doing errands this weekend. Do you want to hang out?`},{type:"divider",inset:!0},{prependAvatar:k,title:"Summer BBQ",subtitle:`<span class="text-primary">to Alex, Scott, Jennifer</span> &mdash; Wish I could come, but I'm out of town this weekend.`},{type:"divider",inset:!0}];return(r,e)=>{const _=W("RouterLink"),P=Q,Y=G;return m(),d(oe,{class:"posting-card mb-4"},{default:s(()=>[t(te,null,{default:s(()=>[t(T,null,{default:s(()=>[t(y,{cols:"12",md:"8"},{default:s(()=>[a.media=="Google Drive"?(m(),d(q,{key:0,"post-id":a.postId},null,8,["post-id"])):x("",!0),a.media=="Instagram"?(m(),d(K,{key:1,"post-id":a.postId},null,8,["post-id"])):x("",!0)]),_:1}),t(y,{cols:"12",md:"4"},{default:s(()=>[o("div",null,[o("div",ne,[t(U,{size:"34",variant:"tonal",color:"primary",class:"me-3"},{default:s(()=>[a.studentImg?(m(),d(w,{key:0,src:`/storage/${a.studentImg}`,cover:""},null,8,["src"])):(m(),d(w,{key:1,src:n(k)},null,8,["src"]))]),_:1}),o("div",re,[o("h6",ie,[t(_,{class:"font-weight-medium text-link",to:`/?search=${("abbreviateName"in r?r.abbreviateName:n(B))(a.studentName,10,1).toLowerCase()}`},{default:s(()=>[g(u(a.studentName),1)]),_:1},8,["to"])]),o("span",me,u(a.email||a.nickname),1)])]),e[11]||(e[11]=o("hr",{class:"my-custom-line"},null,-1)),t(_,{to:`/?search=${("abbreviateName"in r?r.abbreviateName:n(B))(a.theme,30,4).toLowerCase()}`,class:"d-flex flex-column"},{default:s(()=>[o("p",de,u(a.subject+": "+a.theme),1)]),_:1},8,["to"]),o("p",ce,[t(_,{to:`/?search=${I.taskId}`,class:"text-primary"},{default:s(()=>[g(u(a.taskName.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1)]),_:1},8,["to"]),g(" "+u(a.description),1)]),o("div",ue,[t(U,{size:"34",variant:"tonal",class:"me-3",color:a.accepted?"primary":"warning"},{default:s(()=>[a.teacherImg?(m(),d(w,{key:0,src:`/storage/${a.teacherImg}`,cover:""},null,8,["src"])):(m(),d(w,{key:1,src:n(k)},null,8,["src"]))]),_:1},8,["color"]),o("div",pe,[o("div",fe,[o("h6",ve,u(n(v).name),1)]),o("div",_e,[n(A)&&n(A).role>1?(m(),L("div",{key:0,class:"d-flex flex-column",onClick:e[1]||(e[1]=l=>h.value=!0)},[t(C,{modelValue:n(i),"onUpdate:modelValue":e[0]||(e[0]=l=>b(i)?i.value=l:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])])):(m(),d(_,{key:1,to:"/front/bookmark",class:"d-flex flex-column"},{default:s(()=>[t(C,{modelValue:n(i),"onUpdate:modelValue":e[2]||(e[2]=l=>b(i)?i.value=l:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])]),_:1}))])])]),o("p",ge,u(n(p)),1),e[12]||(e[12]=o("hr",{class:"my-custom-line"},null,-1)),o("div",be,[o("div",ye,[t(N,{icon:"tabler-message-2"}),t(N,{icon:"tabler-heart",class:"ms-2"})]),t(N,{icon:"tabler-bookmark-filled",class:"text-primary"})]),n(h)?(m(),L("div",he,[o("div",Ve,[n(c)?(m(),d(ae,{key:0,type:"error",class:"mb-5",dismissible:"",onClick:e[3]||(e[3]=l=>c.value="")},{default:s(()=>[g(u(n(c)),1)]),_:1})):x("",!0),t(se,{onSubmit:F(l=>({}),["prevent"])},{default:s(()=>[t(T,null,{default:s(()=>[t(y,{cols:"12"},{default:s(()=>[t(P,{modelValue:n(v),"onUpdate:modelValue":e[4]||(e[4]=l=>b(v)?v.value=l:null),label:"Mentor",placeholder:"Select Mentor",items:n(j),"item-title":"value.name","item-value":"value"},null,8,["modelValue","items"])]),_:1}),t(y,{cols:"12"},{default:s(()=>[t(P,{modelValue:n(V),"onUpdate:modelValue":[e[5]||(e[5]=l=>b(V)?V.value=l:null),z],label:"Accepted",placeholder:"Not Accepted",items:["Yes","No"]},null,8,["modelValue"])]),_:1}),n(S)?(m(),d(y,{key:0,cols:"12",class:"text-center"},{default:s(()=>[t(C,{modelValue:n(i),"onUpdate:modelValue":e[6]||(e[6]=l=>b(i)?i.value=l:null),"half-increments":"",hover:""},null,8,["modelValue"]),t(Y,{modelValue:n(p),"onUpdate:modelValue":e[7]||(e[7]=l=>b(p)?p.value=l:null),placeholder:"Write your review...",rows:3},null,8,["modelValue"])]),_:1})):x("",!0),t(y,{cols:"12",class:"mt-4"},{default:s(()=>[t(M,{type:"submit",class:"me-2",onClick:E},{default:s(()=>e[9]||(e[9]=[g(" Save ")])),_:1}),t(M,{color:"secondary",class:"me-2",onClick:e[8]||(e[8]=l=>h.value=!1)},{default:s(()=>e[10]||(e[10]=[g(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})])])):x("",!0),o("div",xe,[t(le,{lines:"three",items:D,"item-props":""},{subtitle:s(({subtitle:l})=>[o("div",{innerHTML:l},null,8,ke)]),_:1})])])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Ye as _};
