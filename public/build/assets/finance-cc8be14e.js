import{u as L}from"./useApi-d559f13e.js";import{_ as j}from"./MoreBtn-78fe9f54.js";import{a as W,V as E,b as ye}from"./VCard-521d2f55.js";import{V as xe}from"./VDivider-3f5c8926.js";import{V as de}from"./VTable-0b4411dc.js";import{V as K}from"./VAvatar-c43efe20.js";import{a5 as A,o as u,f as w,e as t,b as e,d as o,c as S,F as T,i as M,x as f,a0 as B,v as F,aZ as pe,z as P,r as C,w as me,ai as R,s as Ve,n as i,aU as J,J as fe,y as te,be as ae,a$ as ke,cE as we,cF as De,$ as _e,H as he}from"./main-dd895efc.js";import{V as se}from"./VChip-a60314c8.js";import{m as ve}from"./vue3-apexcharts-e7fed2ee.js";import{V as Ce}from"./VMenu-6c524ca6.js";import{V as ge,a as G,b as oe,c as $e}from"./VList-681543a0.js";import{V as U}from"./VCardText-8cb57704.js";import{h as q,s as Se}from"./helpers-dc843671.js";import{V as Ne,a as Ae}from"./VTabs-c2528729.js";import{V as Fe,a as Z}from"./VWindowItem-20571730.js";import{V as Q,a as ee}from"./VTimelineItem-cd9966fd.js";import{_ as ne}from"./_plugin-vue_export-helper-c27b6911.js";import{r as re}from"./validators-335ca61c.js";import{_ as Ie}from"./AppTextField-3c315d47.js";import{_ as ze}from"./DialogCloseBtn-305d90a4.js";import{_ as ie}from"./AppSelect-0bbe1a5c.js";import{V as Te}from"./VForm-e67d51c7.js";import{V as le}from"./VRow-401a9eed.js";import{V as N}from"./VCol-5badd7d4.js";import{V as Me}from"./VDialog-15b9a2b9.js";import{V as Pe}from"./VSnackbar-3a88c49f.js";import"./VImg-0d845f43.js";import"./VOverlay-e33c0891.js";import"./easing-9f15041e.js";import"./lazy-f6e07bc3.js";import"./scopeId-e894abda.js";import"./forwardRefs-8348545e.js";import"./dialog-transition-d429094b.js";import"./ssrBoot-fbb1ff66.js";import"./no-profile-4221a4a6.js";import"./VSlideGroup-7a872b07.js";import"./form-06ce0535.js";import"./VTextField-c7c6ba66.js";/* empty css                   */import"./VCounter-be0294ff.js";import"./VField-6a012775.js";import"./VInput-ec440a4f.js";import"./VSelect-7ffe1379.js";import"./VCheckboxBtn-7fc5a6c7.js";import"./VSelectionControl-583fb587.js";const Ee={class:"d-flex align-center"},Oe={class:"text-body-2 text-high-emphasis font-weight-medium"},Be={class:"d-flex align-center gap-x-4",style:{"min-inline-size":"200px"}},Ue={class:"w-100"},We={class:"text-body-1 bg-var-theme-background"},Le={class:"font-weight-medium"},Re={__name:"AllocationTable",props:{data:{type:Array,default:()=>[]}},setup($){const d=$,r=[{title:"ACCOUNT",key:"description"},{title:"PAYMENT",key:"payment"},{title:"EXPENSES",key:"amount"},{title:"BALANCE",key:"balance"},{title:"REMAIN",key:"percentage"}],p=a=>typeof a!="number"?a:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),b=a=>a>0?"success":a<0?"error":"warning",h=a=>a>100?"error":a>90?"warning":"primary",v=A(()=>d.data.reduce((a,n)=>a+n.balance,0));return(a,n)=>{const c=j;return d.data.length?(u(),w(E,{key:0},{default:t(()=>[e(W,{title:"Allocation"},{append:t(()=>[e(c)]),_:1}),e(xe),e(de,{class:"text-no-wrap"},{default:t(()=>[o("thead",null,[o("tr",null,[(u(),S(T,null,M(r,l=>o("th",{key:l.key,scope:"col",class:"text-uppercase"},f(l.title),1)),64))])]),o("tbody",null,[(u(!0),S(T,null,M(d.data,l=>(u(),S("tr",{key:l.allocation},[o("td",null,[o("div",Ee,[e(K,{color:l.allocation===""?"error":"primary",variant:"tonal",class:"me-2",size:"34"},{default:t(()=>[e(B,{icon:l.allocation===""?"tabler-wallet":"tabler-building-bank",size:"22"},null,8,["icon"])]),_:2},1032,["color"]),o("span",Oe,f(l.allocation||"No Allocated"),1)])]),o("td",null,f(p(Number(l.payment))),1),o("td",null,f(p(Number(l.amount))),1),o("td",null,[e(se,{color:b(l.balance),label:""},{default:t(()=>[F(f(p(l.balance)),1)]),_:2},1032,["color"])]),o("td",null,[o("div",Be,[o("div",Ue,[e(pe,{"model-value":l.remain,color:h(l.remain),height:10,rounded:""},null,8,["model-value","color"])]),n[0]||(n[0]=o("div",{class:"text-body-2"},null,-1))])])]))),128))]),o("tfoot",null,[o("tr",We,[n[1]||(n[1]=o("th",{colspan:"2",scope:"row"},null,-1)),n[2]||(n[2]=o("th",{class:"font-weight-medium text-high-emphasis"}," Total Balance ",-1)),o("td",Le,[e(se,{color:b(v.value),label:""},{default:t(()=>[F(f(p(v.value)),1)]),_:1},8,["color"])]),n[3]||(n[3]=o("td",null,null,-1))])])]),_:1})]),_:1})):P("",!0)}}};const je="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",ce="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",Ye="rgba(var(--v-border-color), var(--v-border-opacity))",He={__name:"ExpenseStatistics",props:{data:{type:Array,default:()=>[]}},emits:["year-selected"],setup($,{emit:d}){const r=$,p=d,b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],h=C("All");me(h,_=>{p("yearSelected",_==="All"?"":_)});const v=A(()=>{const x=new Date().getFullYear(),V=[];for(let m=x;m>=2023;m--)V.push(m);return V}),a=A(()=>{const _=[],x=[],V=[];return r.data.forEach(m=>{const[s,g]=m.month.split("-");_.push(`${b[parseInt(g)-1]}-${s}`),_.push(`${b[parseInt(g)-1]}`),x.push(Number(m.official)),V.push(Number(m.non_official))}),{bulan:_,official:x,non_official:V}}),n={line:{series1:"#FFB400",series2:"#9055FD",series3:"#7367f029"}},c=A(()=>[{name:"Kitchen",type:"column",data:a.value.official},{name:"Household",type:"line",data:a.value.non_official}]),l=A(()=>({chart:{type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},markers:{size:5,colors:"#fff",strokeColors:n.line.series2,hover:{size:6},borderRadius:4},stroke:{curve:"smooth",width:[0,3],lineCap:"round"},legend:{show:!0,position:"bottom",markers:{width:8,height:8,offsetX:-3},height:40,itemMargin:{horizontal:10,vertical:0},fontSize:"15px",fontFamily:"Open Sans",fontWeight:400,labels:{colors:je,useSeriesColors:!1},offsetY:10},grid:{strokeDashArray:8,borderColor:Ye},colors:[n.line.series1,n.line.series2],fill:{opacity:[1,1]},plotOptions:{bar:{columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4}},dataLabels:{enabled:!1},xaxis:{tickAmount:10,categories:a.value.bulan,labels:{style:{colors:ce,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{tickAmount:4,labels:{style:{colors:ce,fontSize:"13px",fontWeight:400},formatter(_){return _>=1e6?`${(_/1e6).toFixed(0)} jt`:(_==null?void 0:_.toLocaleString("id-ID"))||0}}},responsive:[{breakpoint:1400,options:{chart:{height:320},xaxis:{labels:{style:{fontSize:"10px"}}},legend:{itemMargin:{vertical:0,horizontal:10},fontSize:"13px",offsetY:12}}},{breakpoint:1025,options:{chart:{height:415},plotOptions:{bar:{columnWidth:"50%"}}}},{breakpoint:982,options:{plotOptions:{bar:{columnWidth:"30%"}}}},{breakpoint:480,options:{chart:{height:250},legend:{offsetY:7}}}]}));return(_,x)=>{const V=ve;return u(),w(E,null,{default:t(()=>[e(W,{title:"Expense statistics",subtitle:"Monthly expenses"},{append:t(()=>[e(Ce,{"offset-y":""},{activator:t(({props:m})=>[e(R,Ve(m,{variant:"tonal","append-icon":"tabler-chevron-down"}),{default:t(()=>[F(f(h.value),1)]),_:2},1040)]),default:t(()=>[e(ge,null,{default:t(()=>[e(G,{onClick:x[0]||(x[0]=m=>h.value="All")},{default:t(()=>[e(oe,null,{default:t(()=>x[1]||(x[1]=[F("All")])),_:1})]),_:1}),(u(!0),S(T,null,M(v.value,m=>(u(),w(G,{key:m,onClick:s=>h.value=m},{default:t(()=>[e(oe,null,{default:t(()=>[F(f(m),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(V,{id:"shipment-statistics",type:"line",height:"320",options:l.value,series:c.value},null,8,["options","series"])]),_:1})]),_:1})}}};const qe={class:"text-caption text-uppercase text-success"},Ke={class:"app-timeline-title"},Je={class:"app-timeline-text"},Ge={class:"text-caption text-uppercase text-warning"},Xe={class:"app-timeline-title"},Ze={class:"app-timeline-text"},Qe={class:"text-caption text-uppercase text-error"},et={class:"app-timeline-title"},tt={class:"app-timeline-text"},at={__name:"FinanceHistory",props:{data:{type:Object,default:()=>({expenses:[],outgoings:[],inputs:[]})}},setup($){const d=$,r=C("Input"),p=["Input","Outgoing","Expenses"];return(b,h)=>{const v=j;return u(),w(E,{class:"country-order-card"},{default:t(()=>[e(W,{title:"Payment History",subtitle:"Transactions"},{append:t(()=>[e(v)]),_:1}),e(Ne,{modelValue:i(r),"onUpdate:modelValue":h[0]||(h[0]=a=>J(r)?r.value=a:null),grow:"",class:"disable-tab-transition"},{default:t(()=>[(u(),S(T,null,M(p,(a,n)=>e(Ae,{key:n},{default:t(()=>[F(f(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(U,null,{default:t(()=>[e(Fe,{modelValue:i(r),"onUpdate:modelValue":h[1]||(h[1]=a=>J(r)?r.value=a:null)},{default:t(()=>[e(Z,null,{default:t(()=>[o("div",null,[d.data.inputs.length?(u(),w(Q,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(T,null,M(d.data.inputs,(a,n)=>(u(),w(ee,{key:n,icon:"tabler-circle-check","dot-color":"rgba(var(--v-theme-surface))","icon-color":"success","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[o("div",qe,f(a.remark),1),o("div",Ke,f(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),o("div",Je,f(i(q)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1}),e(Z,null,{default:t(()=>[o("div",null,[d.data.outgoings.length?(u(),w(Q,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(T,null,M(d.data.outgoings,(a,n)=>(u(),w(ee,{key:n,icon:"tabler-arrow-up-right","dot-color":"rgba(var(--v-theme-surface))","icon-color":"warning","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[o("div",Ge,f(a.remark),1),o("div",Xe,f(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),o("div",Ze,f(i(q)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1}),e(Z,null,{default:t(()=>[o("div",null,[d.data.expenses.length?(u(),w(Q,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(T,null,M(d.data.expenses,(a,n)=>(u(),w(ee,{key:n,icon:"tabler-arrow-up-right-circle","dot-color":"rgba(var(--v-theme-surface))","icon-color":"error","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[o("div",Qe,f(a.remark),1),o("div",et,f(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),o("div",tt,f(i(q)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}};const ot={key:0,class:"d-flex mb-8"},nt={class:"vehicle-progress-label position-relative mb-4 text-body-1 d-none d-sm-block text-truncate"},lt={class:"table-container"},st={width:"70%"},rt={class:"text-body-1 text-high-emphasis"},it={class:"text-end"},ct={class:"font-weight-medium text-body-1 text-high-emphasis"},ut={class:"text-end"},dt={class:"text-body-1"},pt={__name:"NonKitchenOverview",props:{data:{type:Array,required:!0}},setup($){const d=$,r=A(()=>{const a=Array.isArray(d.data)?d.data:[],n=a.reduce((c,l)=>c+Number(l.amount||0),0);return a.map(c=>{var l,_;return{icon:v((l=c.finance_account)==null?void 0:l.description),title:((_=c.finance_account)==null?void 0:_.description)||"Unknown",amount:Number(c.amount||0),time:Number(c.amount||0).toLocaleString("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}),percentage:n>0?Number(c.amount||0)/n*100:0}})}),p=A(()=>{const a=r.value.slice().sort((x,V)=>V.amount-x.amount);if(a.length===0)return[];if(a.length<=4){const V=100/a.reduce((m,s)=>m+s.percentage,0);return a.map(m=>({...m,percentage:parseFloat((m.percentage*V).toFixed(1))}))}const n=a.slice(0,3),l=a.slice(3).reduce((x,V)=>x+V.percentage,0),_={title:"Lain-lain",percentage:parseFloat(l.toFixed(1)),icon:"tabler-dots"};return[...n.map(x=>({...x,percentage:parseFloat(x.percentage.toFixed(1))})),_]}),b=["rgba(var(--v-theme-on-surface), var(--v-hover-opacity))","rgb(var(--v-theme-primary))","rgb(var(--v-theme-info))","#212121"],h=a=>b[a%b.length],v=a=>({"Sewa Gedung":"tabler-building","Internet & Tools":"tabler-wifi","Gaji Karyawan":"tabler-users","Gaji Guru":"tabler-school"})[a]||"tabler-receipt-2";return(a,n)=>{const c=j;return u(),w(E,null,{default:t(()=>[e(W,{title:"Non Kitchen overview"},{append:t(()=>[e(c)]),_:1}),e(U,null,{default:t(()=>[p.value.length?(u(),S("div",ot,[(u(!0),S(T,null,M(p.value,(l,_)=>(u(),S("div",{key:l.title,style:fe({"inline-size":`${l.percentage}%`})},[o("div",nt,f(l.title),1),e(i(pe),{color:h(_),"model-value":"100",height:"46",class:te({"rounded-s-0":_>0&&p.value.length>1,"rounded-e-0":_<p.value.length-1,"rounded-sm":p.value.length===1})},{default:t(()=>[o("strong",{class:te(["vehicle-progress-text",_>0?"text-white":""])},f(l.percentage)+"%",3)]),_:2},1032,["color","class"])],4))),128))])):P("",!0),o("div",lt,[e(de,{class:"text-no-wrap"},{default:t(()=>[o("tbody",null,[(u(!0),S(T,null,M(r.value,(l,_)=>(u(),S("tr",{key:_},[o("td",st,[e(B,{icon:l.icon,size:"24",class:"me-2"},null,8,["icon"]),o("span",rt,f(l.title),1)]),o("td",it,[o("div",ct,f(l.time),1)]),o("td",ut,[o("span",dt,f(l.percentage.toFixed(1))+"%",1)])]))),128))])]),_:1})])]),_:1})]),_:1})}}},mt=ne(pt,[["__scopeId","data-v-a8ff2595"]]),ue="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",ft="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",_t={__name:"PaymentDelivery",props:{data:{type:Object,default:()=>({text:[],value:[]})}},setup($){const d=$,r={donut:{series1:"#56ca00",series2:"#56ca00cc",series3:"#56ca0099",series4:"#56ca0066"}},p=A(()=>{const a=ae(d.data.value)||[];return a.length?a.reduce((n,c)=>n+Number(c),0)/a.length:0}),b=A(()=>{var a,n;return(n=(a=d.data)==null?void 0:a.value)!=null&&n.length?d.data.value.map(c=>Number(c)||0):[0]}),h={chart:{animations:{enabled:!1}},colors:[r.donut.series1,r.donut.series2,r.donut.series3,r.donut.series4],stroke:{width:0},dataLabels:{enabled:!1,formatter(a){return`${Number.parseInt(a)}%`}},legend:{show:!0,position:"bottom",offsetY:10,markers:{width:8,height:8,offsetX:-3},itemMargin:{horizontal:15,vertical:5},fontSize:"13px",fontWeight:400,labels:{colors:ue,useSeriesColors:!1}},tooltip:{theme:!1},grid:{padding:{top:15}},plotOptions:{pie:{donut:{size:"75%",labels:{show:!0,value:{fontSize:"26px",color:ue,fontWeight:500,offsetY:-15,formatter(a){return`${Number.parseInt(a)}%`}},name:{offsetY:30},total:{show:!0,fontSize:"0.75rem",fontWeight:400,label:"AVG. Total",color:ft,formatter:()=>`${Number.parseInt(p.value)}%`}}}}},responsive:[{breakpoint:420,options:{chart:{height:400}}}]},v=A(()=>{var a,n;return{...h,labels:(n=(a=d.data)==null?void 0:a.text)!=null&&n.length?d.data.text:["No Data"]}});return(a,n)=>{const c=j,l=ve;return u(),w(E,null,{default:t(()=>[e(W,{title:"Payment Delivery"},{append:t(()=>[e(c)]),_:1}),e(U,null,{default:t(()=>[e(l,{type:"donut",height:"400",options:v.value,series:b.value},null,8,["options","series"])]),_:1})]),_:1})}}};const ht={class:"table-container"},vt={class:"text-high-emphasis text-body-1 font-weight-medium"},gt={__name:"PaymentPerformance",props:{students:{type:Array,required:!0},payments:{type:Array,required:!0}},setup($){const d=$,r=A(()=>!d.students||d.students.length===0?[]:d.students.map(p=>{const b=d.payments.filter(v=>v.admin_student_id===p.id),h=b.length>0;return{title:p.name,length:b.length,date:h?q(b[0].date)||b[0].date:"-",billing:h?b[0].billing:"Waiting",icon:h?"tabler-circle-check":"tabler-circle-x",color:h?b.length>=3?"success":"primary":"warning"}}));return(p,b)=>{const h=j;return u(),w(E,null,{default:t(()=>[e(W,{title:"Monthly overview",subtitle:"Payment delivery"},{append:t(()=>[e(h)]),_:1}),e(U,null,{default:t(()=>[o("div",ht,[e(ge,{class:"card-list text-no-wrap"},{default:t(()=>[(u(!0),S(T,null,M(r.value,(v,a)=>(u(),w(G,{key:a},{prepend:t(()=>[e(K,{color:v.color,variant:"tonal",rounded:"",size:"38"},{default:t(()=>[e(B,{icon:v.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])]),append:t(()=>[o("span",vt,f(v.date),1)]),default:t(()=>[e(oe,null,{default:t(()=>[F(f(i(Se)(v.title)),1)]),_:2},1024),e($e,null,{default:t(()=>[o("div",{class:te([v.billing=="Waiting"?"text-secondary":v.length>=3?"text-success":"text-primary","d-flex align-center"])},[e(B,{icon:v.billing=="Waiting"?"tabler-chevron-down":v.length>=3?"tabler-chevrons-up":"tabler-chevron-up",class:"me-1"},null,8,["icon"]),o("span",null,f(v.billing),1)],2)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1})]),_:1})}}},bt=ne(gt,[["__scopeId","data-v-810f2bb2"]]),yt={__name:"AddDepositDialog",props:{mode:{type:String,required:!0},selectedData:{type:Object,required:!1,default:()=>({id:null,title:"",amount:0,icon:"",color:""})},isDialogVisible:{type:Boolean,required:!0}},emits:["submit","delete","update:isDialogVisible"],setup($,{emit:d}){const r=$,p=d,b=C(),h=A(()=>r.mode==="add"?"Add Deposit":"Edit Deposit"),v=A(()=>r.mode==="add"?"Submit":"Update"),a=[{label:"Bank",value:"tabler-building-bank"},{label:"Piggy Bank",value:"tabler-pig-money"},{label:"Wallet",value:"tabler-wallet"},{label:"Credit Card",value:"tabler-credit-card"},{label:"Cash",value:"tabler-cash"}],n=[{text:"Primary",value:"primary"},{text:"Warning",value:"warning"},{text:"Info",value:"info"},{text:"Success",value:"success"},{text:"Error",value:"error"},{text:"Secondary",value:"secondary"}],c=C(structuredClone(ae(r.selectedData)));me(()=>r.isDialogVisible,m=>{m&&(c.value=structuredClone(ae(r.selectedData)))});const l=()=>{var m;(m=b.value)==null||m.validate().then(({valid:s})=>{s&&(p("update:isDialogVisible",!1),p("submit",{mode:r.mode,data:c.value}))})},_=()=>{p("update:isDialogVisible",!1)},x=()=>{c.value.id&&p("delete",c.value.id)},V=m=>{p("update:isDialogVisible",m)};return(m,s)=>{const g=ze,y=Ie;return u(),w(Me,{width:m.$vuetify.display.smAndDown?"auto":420,"model-value":r.isDialogVisible,"onUpdate:modelValue":V},{default:t(()=>[e(g,{onClick:s[0]||(s[0]=k=>V(!1))}),e(E,{class:"pa-sm-8 pa-5"},{default:t(()=>[e(W,{class:"text-center"},{default:t(()=>[e(ye,{class:"text-h3"},{default:t(()=>[F(f(i(h)),1)]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(Te,{ref_key:"refForm",ref:b,class:"mt-4",onSubmit:ke(l,["prevent"])},{default:t(()=>[e(le,null,{default:t(()=>[e(N,{cols:"12"},{default:t(()=>[e(y,{modelValue:i(c).title,"onUpdate:modelValue":s[1]||(s[1]=k=>i(c).title=k),rules:["requiredValidator"in m?m.requiredValidator:i(re)],label:"Title",placeholder:"Deposit Account"},null,8,["modelValue","rules"])]),_:1}),e(N,{cols:"12"},{default:t(()=>[e(y,{modelValue:i(c).amount,"onUpdate:modelValue":s[2]||(s[2]=k=>i(c).amount=k),rules:["requiredValidator"in m?m.requiredValidator:i(re)],label:"amount",placeholder:"Deposit Amount",type:"number"},null,8,["modelValue","rules"])]),_:1}),e(N,{cols:"12"},{default:t(()=>[e(ie,{modelValue:i(c).icon,"onUpdate:modelValue":s[3]||(s[3]=k=>i(c).icon=k),label:"Deposit Icon",placeholder:"Deposit Icon",items:a,"item-title":"label","item-value":"value"},{item:t(({props:k,item:D})=>[e(G,we(De(k)),{default:t(()=>[e(B,{icon:D.raw.value,class:"me-2"},null,8,["icon"]),o("span",null,f(D.raw.label),1)]),_:2},1040)]),selection:t(({item:k})=>[e(B,{icon:k.raw.value,class:"me-2"},null,8,["icon"]),o("span",null,f(k.raw.label),1)]),_:1},8,["modelValue"])]),_:1}),e(N,{cols:"12"},{default:t(()=>[e(ie,{modelValue:i(c).color,"onUpdate:modelValue":s[4]||(s[4]=k=>i(c).color=k),label:"Deposit Color",placeholder:"Deposit Color",items:n,"item-title":"text","item-value":"value"},null,8,["modelValue"])]),_:1}),e(N,{cols:"12",class:"d-flex flex-wrap justify-center gap-2 mt-6"},{default:t(()=>[e(R,{type:"submit"},{default:t(()=>[F(f(i(v)),1)]),_:1}),e(R,{color:"secondary",variant:"tonal",onClick:_},{default:t(()=>s[5]||(s[5]=[F(" Cancel ")])),_:1}),r.mode==="edit"?(u(),w(R,{key:0,color:"error",variant:"tonal",onClick:x},{default:t(()=>s[6]||(s[6]=[F(" Delete ")])),_:1})):P("",!0)]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};const xt={class:"d-flex align-center gap-x-4 mb-2"},Vt={class:"text-h5 font-weight-medium"},kt={class:"text-body-1"},wt={class:"d-flex gap-x-2"},Dt={class:"text-h6 font-weight-medium"},Ct={class:"d-flex align-center gap-x-4 mb-2"},$t={__name:"SaldoCardStatistics",setup($){const d=_e("userData"),r=C([]),p=C(!1),b=C("add"),h=C({}),v=async()=>{var s;try{const{data:g}=await L("/deposits"),y=((s=g.value)==null?void 0:s.data)||[],k=y.reduce((D,I)=>D+I.amount,0);r.value=y.map(D=>({...D,value:new Intl.NumberFormat("id-ID").format(D.amount),change:k>0?parseFloat((D.amount/k*100).toFixed(0)):0,isHover:!1}))}catch(g){l("Failed to fetch deposits.","error"),console.error(g)}};he(v);const a=C(!1),n=C(""),c=C("primary"),l=(s,g="primary")=>{n.value=s,c.value=g,a.value=!0,setTimeout(()=>{a.value=!1},1e4)},_=()=>{b.value="add",h.value={title:"",amount:0,icon:"tabler-building-bank",color:"primary"},p.value=!0},x=s=>{b.value="edit",h.value=JSON.parse(JSON.stringify(s)),p.value=!0},V=async s=>{var k;const{mode:g,data:y}=s;try{let D;if(g==="add"?D=await L("/deposits",{method:"POST",body:JSON.stringify(y),headers:{"Content-Type":"application/json",Accept:"application/json"}}):D=await L(`/deposits/${y.id}`,{method:"PUT",body:JSON.stringify(y),headers:{"Content-Type":"application/json",Accept:"application/json"}}),(k=D.response.value)!=null&&k.ok)l(`Deposit ${g==="add"?"added":"updated"} successfully.`,"success"),v();else{const I=D.data.value,Y=I!=null&&I.errors?Object.values(I.errors).flat().join(`
`):(I==null?void 0:I.message)||`Failed to ${g} deposit.`;l(Y,"error")}}catch(D){l(`Failed to ${g} deposit.`,"error"),console.error(D)}},m=async s=>{try{await L(`/deposits/${s}`,{method:"DELETE"}),l("Deposit deleted successfully.","success"),v()}catch(g){l("Failed to delete deposit.","error"),console.error(g)}p.value=!1};return(s,g)=>(u(),w(le,null,{default:t(()=>[e(Pe,{modelValue:i(a),"onUpdate:modelValue":g[1]||(g[1]=y=>J(a)?a.value=y:null),location:"center",variant:"tonal",transition:"scale-transition",color:i(c),class:"text-center"},{actions:t(()=>[e(R,{color:i(c),onClick:g[0]||(g[0]=y=>a.value=!1)},{default:t(()=>g[3]||(g[3]=[F(" Close ")])),_:1},8,["color"])]),default:t(()=>[F(f(i(n))+" ",1)]),_:1},8,["modelValue","color"]),(u(!0),S(T,null,M(i(r),(y,k)=>(u(),w(N,{key:k,cols:"12",md:i(r).length<=2?6:i(r).length<=4?3:i(r).length<=6?2:6,sm:"6"},{default:t(()=>[o("div",null,[e(E,{class:"logistics-card-statistics cursor-pointer",style:fe(y.isHover?{"border-block-end":`2px solid rgba(var(--v-theme-${y.color}))`}:{"border-block-end":`2px solid rgba(var(--v-theme-${y.color}), var(--v-disabled-opacity))`}),onClick:D=>x(y),onMouseenter:D=>y.isHover=!0,onMouseleave:D=>y.isHover=!1},{default:t(()=>[e(U,null,{default:t(()=>[o("div",xt,[e(K,{variant:"tonal",class:"avatar-hover",color:y.color,rounded:""},{default:t(()=>[e(B,{icon:y.icon,size:"28"},null,8,["icon"])]),_:2},1032,["color"]),o("h5",Vt,f(y.value),1)]),o("div",kt,f(y.title),1),o("div",wt,[o("h6",Dt,f(y.change)+"% ",1),g[4]||(g[4]=o("span",{class:"text-disabled"},"from Total",-1))])]),_:2},1024)]),_:2},1032,["style","onClick","onMouseenter","onMouseleave"])])]),_:2},1032,["md"]))),128)),i(r).length==0||i(r).length%2!==0||i(d).admin_teacher_id?(u(),w(N,{key:0,md:i(r).length<=2?6:i(r).length<=4?3:i(r).length<=6?2:6,cols:"12",sm:"6",onClick:_},{default:t(()=>[o("div",null,[e(E,{class:"logistics-card-statistics cursor-pointer"},{default:t(()=>[e(U,null,{default:t(()=>[o("div",Ct,[e(K,{variant:"tonal",class:"avatar-hover",rounded:"",size:"85"},{default:t(()=>[e(B,{size:"42",icon:"tabler-plus"})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["md"])):P("",!0),i(d).admin_teacher_id?(u(),w(yt,{key:1,"is-dialog-visible":i(p),"onUpdate:isDialogVisible":g[2]||(g[2]=y=>J(p)?p.value=y:null),mode:i(b),"selected-data":i(h),onSubmit:V,onDelete:m},null,8,["is-dialog-visible","mode","selected-data"])):P("",!0)]),_:1}))}},St=ne($t,[["__scopeId","data-v-895108c5"]]),ya={__name:"finance",setup($){const d=_e("userData"),r=C([]),p=C([]),b=C([]),h=C([]),v=C([]),a=C([]),n=C([]),c=C({text:[],value:[]}),l=C([]);C("");async function _(V=""){var I,Y;const s=(await L(`/dashboard-finance?year=${V}`)).data.value;if(!s)return;r.value=s.nonKitchen||[],p.value=s.houseHold||[],b.value=s.students||[],h.value=s.expenses||[],v.value=s.outgoings||[],a.value=s.inputs||[],n.value=s.payCurrentMonth||[];const g=s.payDelivery||[];c.value={text:g.map(z=>z.billing),value:g.map(z=>z.amount>0?Math.round(Number(z.paidAmount)/z.amount*100):0)};const y=((I=s.allocation)==null?void 0:I.finances)||[],k=((Y=s.allocation)==null?void 0:Y.payments)||[],D=y.reduce((z,O)=>z+Number(O.amount),0);l.value=y.map(z=>{const O=k.find(be=>be.number===z.allocation),X=Number((O==null?void 0:O.amount)||0),H=Number(z.amount);return{...z,payment:X,allocation:(O==null?void 0:O.description)||"",balance:X-H,percentage:D>0?H/D*100:0,remain:100-Math.round((X-H)/H*100)}})}const x=V=>{_(V)};return he(()=>_()),(V,m)=>(u(),w(le,{class:"match-height"},{default:t(()=>[e(N,{cols:"12"},{default:t(()=>[e(St)]),_:1}),e(N,{cols:"12",md:"6"},{default:t(()=>[e(mt,{data:r.value},null,8,["data"])]),_:1}),e(N,{cols:"12",md:"6"},{default:t(()=>[e(He,{data:p.value,onYearSelected:x},null,8,["data"])]),_:1}),i(d).admin_teacher_id?(u(),w(N,{key:0,cols:"12",md:"4"},{default:t(()=>[e(bt,{payments:n.value,students:b.value},null,8,["payments","students"])]),_:1})):P("",!0),e(N,{cols:"12",md:i(d).admin_teacher_id?4:6},{default:t(()=>[e(_t,{data:c.value},null,8,["data"])]),_:1},8,["md"]),e(N,{cols:"12",md:i(d).admin_teacher_id?4:6},{default:t(()=>[e(at,{data:{expenses:h.value,outgoings:v.value,inputs:a.value}},null,8,["data"])]),_:1},8,["md"]),e(N,{cols:"12"},{default:t(()=>[i(d).admin_teacher_id?(u(),w(Re,{key:0,data:l.value},null,8,["data"])):P("",!0)]),_:1})]),_:1}))}};export{ya as default};
