import{c as M,a as W}from"./formatters-5379081e.js";import{i as H,f as K,c as X}from"./fetchProjectData-a7149d61.js";import{N as Z,F as ee}from"./front-page-navbar-4a17fa7f.js";import{r as m,a5 as te,H as J,b6 as ae,a as q,o as n,f as p,e as o,b as a,z as N,d as l,n as r,x as c,v as V,c as v,F as L,aU as I,a0 as U,a$ as se,ai as Y,d7 as oe,w as le,f8 as ne,i as O,c1 as re}from"./main-2ca02b3b.js";import{_ as ie}from"./AppTextarea-681a8e90.js";import{_ as de}from"./AppSelect-3c67992b.js";import{t as me,f as ce}from"./fetchTeacherData-cbd3fe06.js";import{_ as ue}from"./InstagramEmbed-fb896e45.js";import{a as R}from"./no-profile-4221a4a6.js";import{$ as pe}from"./api-d97a1aea.js";import{V as ve}from"./VCardText-e7df9280.js";import{V as E,a as b}from"./VRow-e41a8b34.js";import{V as F}from"./VAvatar-a7deecfc.js";import{V as A}from"./VImg-250183fa.js";import{V as z}from"./VRating-063833f3.js";import{V as fe}from"./VAlert-97da2a17.js";import{V as _e}from"./VForm-7850ca66.js";import{V as Q,b as he,c as ge,a as ye}from"./VList-c776ab47.js";import{V as G}from"./VCard-211b1d9e.js";import{V as be}from"./VDivider-cc04d089.js";import"./helpers-e472473c.js";import"./useApi-93131946.js";import"./AppTextField-0858edf6.js";import"./form-333814a1.js";import"./VTextField-0a864af4.js";/* empty css                   */import"./VCounter-973a6cc1.js";import"./VField-b433e507.js";import"./easing-9f15041e.js";import"./VInput-9aa25b78.js";import"./forwardRefs-8348545e.js";import"./VNodeRenderer-dd0b3a4b.js";import"./useGenerateImageVariant-2a4a0d95.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VChip-c9cdb45a.js";import"./VContainer-5a630ac7.js";import"./NavbarThemeSwitcher-9d2d74ad.js";import"./VTooltip-179d248a.js";import"./VOverlay-160906ea.js";import"./lazy-cceeae2e.js";import"./scopeId-34d005c1.js";import"./VMenu-d28590c8.js";import"./dialog-transition-a25a31df.js";import"./ssrBoot-29b51df8.js";import"./VNavigationDrawer-505a53d7.js";import"./VToolbar-7d5f4b88.js";import"./VSpacer-a2f5af06.js";import"./VSelect-bc7d8ac3.js";import"./VCheckboxBtn-f6f4a00f.js";import"./VSelectionControl-c0f025b5.js";import"./index-4e4fc132.js";import"./index-9c720871.js";const Ve={class:"d-flex justify-space-between align-center mb-2"},we={class:"d-flex align-center"},xe={class:"text-base text-primary"},ke={class:"text-sm text-medium-emphasis"},Se={class:"d-flex flex-column text-end"},Ie={class:"text-sm text-primary"},Ne=["href"],$e={class:"text-body-1 text-primary"},Ce={class:"text-body-2 d-inline"},Te={class:"d-flex align-center mt-4"},Le={key:1},Ae={class:"d-flex flex-column"},je={class:"d-flex flex-column"},Pe={class:"text-base text-primary ms-1"},Re={class:"text-sm text-medium-emphasis cursor-pointer"},Be={class:"text-body-2 mt-2"},De={class:"d-flex justify-space-between my-4 flex-wrap action-icons"},Me={class:""},Ue={key:0,class:"modal-overlay"},ze={class:"modal-content"},Ee={class:"flex-grow-1 overflow-auto d-none",style:{"max-block-size":"100%"}},Fe=["innerHTML"],He={__name:"InstagramCard",props:{taskId:Number,taskName:String,description:String,subject:String,theme:String,stars:Number,media:String,postId:String,studentName:String,nickname:String,email:String,teacher:Object,studentImg:String,teacherImg:String,accepted:Number,review:String,date:String},setup(B){const s=B,$=localStorage.getItem("participant"),w=$?JSON.parse($):null,x=m(!1),f=m(""),_=m(s.teacher),k=m(s.accepted?"Yes":"No"),g=m(s.review),u=m(s.stars),C=m(!!s.accepted),D=te(()=>me.value.map(e=>({title:e.nickname,value:{id:e.id,name:e.nickname}}))),j=e=>{e==="Yes"?C.value=!0:C.value=!1},i=async()=>{if(_.value===""){f.value="Please select a mentor";return}else if(k.value===""){f.value="Please select accepted";return}else if(u.value===0){f.value="Please select a rating";return}else if(g.value===""){f.value="Please write a review";return}else{const e={admin_teacher_id:_.value.id,accepted:k.value=="Yes"?1:0,rate:u.value,review:g.value};console.log("Rating submitted:",e);try{const t=await pe(`/public/update-task-accepted/${s.taskId}`,{method:"POST",body:e,onResponseError({err:y}){f.value=y}});console.log("Rating response:",t),u.value=t.data.rate,g.value=t.data.review}catch(t){console.error("Error submitting rating:",t)}x.value=!1}},h=()=>{(window.scrollY||document.documentElement.scrollTop)>100&&(x.value=!1)};J(()=>{ce(),window.addEventListener("scroll",h)}),ae(()=>{window.removeEventListener("scroll",h)});const S=[{prependAvatar:R,title:"Brunch this weekend?",subtitle:`<span class="text-primary">Ali Connors</span> &mdash; I'll be in your neighborhood doing errands this weekend. Do you want to hang out?`},{type:"divider",inset:!0},{prependAvatar:R,title:"Summer BBQ",subtitle:`<span class="text-primary">to Alex, Scott, Jennifer</span> &mdash; Wish I could come, but I'm out of town this weekend.`},{type:"divider",inset:!0}];return(e,t)=>{const y=q("RouterLink"),T=de,P=ie;return n(),p(G,{class:"mb-4"},{default:o(()=>[a(ve,null,{default:o(()=>[a(E,null,{default:o(()=>[a(b,{cols:"12",md:"6",class:"border border-red"},{default:o(()=>[s.media=="Instagram"?(n(),p(ue,{key:0,"post-id":s.postId},null,8,["post-id"])):N("",!0)]),_:1}),a(b,{cols:"12",md:"6"},{default:o(()=>[l("div",null,[l("div",Ve,[l("div",we,[a(F,{size:"34",variant:"tonal",color:"primary",class:"me-3"},{default:o(()=>[s.studentImg?(n(),p(A,{key:0,src:`/storage/${s.studentImg}`,cover:""},null,8,["src"])):(n(),p(A,{key:1,src:r(R)},null,8,["src"]))]),_:1}),a(y,{to:`/?search=${("abbreviateName"in e?e.abbreviateName:r(M))(s.studentName,10,1).toLowerCase()}`,class:"d-flex flex-column"},{default:o(()=>[l("h6",xe,c(("abbreviateName"in e?e.abbreviateName:r(M))(s.studentName,30,3)),1),l("span",ke,c(s.email||s.nickname),1)]),_:1},8,["to"])]),l("div",Se,[l("small",Ie,c(new Date(s.date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})),1),l("a",{href:`/?search=${s.taskId}`,class:"text-sm text-medium-emphasis"},c(s.taskId),9,Ne)])]),t[11]||(t[11]=l("hr",{class:"my-custom-line"},null,-1)),a(y,{to:`/?search=${("abbreviateName"in e?e.abbreviateName:r(M))(s.theme,30,4).toLowerCase()}`,class:"d-flex flex-column"},{default:o(()=>[l("p",$e,c(s.subject+": "+s.theme),1)]),_:1},8,["to"]),l("p",Ce,[a(y,{to:`/?search=${B.taskId}`,class:"text-primary"},{default:o(()=>[V(c(s.taskName.split(" ").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" ")),1)]),_:1},8,["to"]),V(" "+c(s.description),1)]),l("div",Te,[a(F,{size:s.accepted?void 0:34,color:s.accepted?void 0:e.warning,variant:"tonal",class:"me-3"},{default:o(()=>[s.accepted?(n(),v(L,{key:0},[s.teacherImg?(n(),p(A,{key:0,src:`/storage/${s.teacherImg}`,cover:""},null,8,["src"])):(n(),p(A,{key:1,src:r(R)},null,8,["src"]))],64)):(n(),v("span",Le,c(("avatarText"in e?e.avatarText:r(W))(r(_).name)),1))]),_:1},8,["size","color"]),l("div",Ae,[l("div",je,[l("h6",Pe,c(r(_).name),1)]),l("div",Re,[r(w)&&r(w).role>1?(n(),v("div",{key:0,class:"d-flex flex-column",onClick:t[1]||(t[1]=d=>x.value=!0)},[a(z,{modelValue:r(u),"onUpdate:modelValue":t[0]||(t[0]=d=>I(u)?u.value=d:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])])):(n(),p(y,{key:1,to:"/front/bookmark",class:"d-flex flex-column"},{default:o(()=>[a(z,{modelValue:r(u),"onUpdate:modelValue":t[2]||(t[2]=d=>I(u)?u.value=d:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])]),_:1}))])])]),l("p",Be,c(r(g)),1),t[12]||(t[12]=l("hr",{class:"my-custom-line"},null,-1)),l("div",De,[l("div",Me,[a(U,{icon:"tabler-message-2"}),a(U,{icon:"tabler-heart",class:"ms-2"})]),a(U,{icon:"tabler-bookmark"})]),r(x)?(n(),v("div",Ue,[l("div",ze,[r(f)?(n(),p(fe,{key:0,type:"error",class:"mb-5",dismissible:"",onClick:t[3]||(t[3]=d=>f.value="")},{default:o(()=>[V(c(r(f)),1)]),_:1})):N("",!0),a(_e,{onSubmit:se(d=>({}),["prevent"])},{default:o(()=>[a(E,null,{default:o(()=>[a(b,{cols:"12"},{default:o(()=>[a(T,{modelValue:r(_),"onUpdate:modelValue":t[4]||(t[4]=d=>I(_)?_.value=d:null),label:"Mentor",placeholder:"Select Mentor",items:r(D),"item-title":"value.name","item-value":"value"},null,8,["modelValue","items"])]),_:1}),a(b,{cols:"12"},{default:o(()=>[a(T,{modelValue:r(k),"onUpdate:modelValue":[t[5]||(t[5]=d=>I(k)?k.value=d:null),j],label:"Accepted",placeholder:"Not Accepted",items:["Yes","No"]},null,8,["modelValue"])]),_:1}),r(C)?(n(),p(b,{key:0,cols:"12",class:"text-center"},{default:o(()=>[a(z,{modelValue:r(u),"onUpdate:modelValue":t[6]||(t[6]=d=>I(u)?u.value=d:null),"half-increments":"",hover:""},null,8,["modelValue"]),a(P,{modelValue:r(g),"onUpdate:modelValue":t[7]||(t[7]=d=>I(g)?g.value=d:null),placeholder:"Write your review...",rows:3},null,8,["modelValue"])]),_:1})):N("",!0),a(b,{cols:"12",class:"mt-4"},{default:o(()=>[a(Y,{type:"submit",class:"me-2",onClick:i},{default:o(()=>t[9]||(t[9]=[V(" Save ")])),_:1}),a(Y,{color:"secondary",class:"me-2",onClick:t[8]||(t[8]=d=>x.value=!1)},{default:o(()=>t[10]||(t[10]=[V(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})])])):N("",!0),l("div",Ee,[a(Q,{lines:"three",items:S,"item-props":""},{subtitle:o(({subtitle:d})=>[l("div",{innerHTML:d},null,8,Fe)]),_:1})])])]),_:1})]),_:1})]),_:1})]),_:1})}}};const Ye={class:"landing-page-wrapper"},Oe={class:"instagram-card"},We={key:1},Je={class:"py-4 text-center text-gray-400"},qe={key:0,class:"flex justify-center items-center my-4 mt-6"},Jt={__name:"instagram",setup(B){const s=m(null),$=m([]),w=m(!1),x=m(2);console.log("instagramTasks:",H.value),J(async()=>{var i;await K(),s.value=(i=H.value)==null?void 0:i.data,s.value&&j(),window.addEventListener("scroll",f)});const f=async()=>{var S;const i=window.scrollY+window.innerHeight,h=document.documentElement.scrollHeight-10;if(i>=h&&!w.value){w.value=!0;const e=await X(x.value++);(S=e.data)!=null&&S.length&&(s.value.push(...e.data),j()),w.value=!1}},_=m(),k=m(),g=m(),u=m(),C=m(),D=m();function j(){$.value=[{type:"subheader",title:"Best of the Week"},...s.value.filter(i=>i.rate>=4).flatMap(i=>{var h;return[{prependAvatar:oe,title:((h=i.admin_student)==null?void 0:h.name)||"Unknown Student",subtitle:i.name||"No Task Name"},{type:"divider",inset:!0}]})]}return le(s,i=>{console.log("Task data updated:",i)}),ne([k,g,u,C,D],([{isIntersecting:i,target:h}])=>{i&&(_.value=h.id)},{threshold:.25}),(i,h)=>{const S=q("VSubheader");return n(),v(L,null,[l("div",Ye,[a(Z,{"active-id":_.value},null,8,["active-id"]),l("div",Oe,[a(E,{class:"m-0 p-0"},{default:o(()=>[a(b,{class:"d-none d-lg-block",cols:"12",lg:"3"},{default:o(()=>[a(G,{style:{position:"sticky","inset-block-start":"6rem"}},{default:o(()=>[a(Q,{lines:"three"},{default:o(()=>[(n(!0),v(L,null,O($.value,(e,t)=>(n(),v(L,{key:t},[e.prependAvatar?(n(),p(ye,{key:0,class:"custom-list-item"},{prepend:o(()=>[a(F,{size:"34",variant:"tonal",color:"primary",class:"me-3"},{default:o(()=>[i.avatar?(n(),p(A,{key:0,src:i.avatar},null,8,["src"])):(n(),v("span",We,c(("avatarText"in i?i.avatarText:r(W))(e.title)),1))]),_:2},1024)]),default:o(()=>[a(he,null,{default:o(()=>[V(c(e.title),1)]),_:2},1024),a(ge,null,{default:o(()=>[V(c(e.subtitle),1)]),_:2},1024)]),_:2},1024)):e.type==="divider"?(n(),p(be,{key:`divider-${t}`,inset:""})):e.type==="subheader"?(n(),p(S,{key:2,class:"ps-3 mb-2 font-weight-medium text-primary"},{default:o(()=>[V(c(e.title),1)]),_:2},1024)):N("",!0)],64))),128))]),_:1})]),_:1})]),_:1}),a(b,{cols:"12",lg:"9"},{default:o(()=>[l("div",null,[(n(!0),v(L,null,O(s.value,e=>{var t,y,T,P;return n(),v("div",{key:e.id},[a(He,{"task-id":e.id,"task-name":e.name,"task-date":e.date,description:e.description,subject:e.project_plan.subject,theme:e.project_plan.theme,stars:e.rate,media:e.media,"post-id":((y=(t=e.link)==null?void 0:t.match(/\/(?:p|reel)\/([\w-]+)/))==null?void 0:y[1])||"N/A","student-name":e.admin_student.name,nickname:e.admin_student.nickname,email:e.admin_student.email,teacher:e.admin_teacher?{id:e.admin_teacher.id,name:e.admin_teacher.nickname}:"Not Accepted","student-img":(T=e.admin_student)==null?void 0:T.image,"teacher-img":(P=e.admin_teacher)==null?void 0:P.image,accepted:e.accepted,review:(e==null?void 0:e.review)||null,date:e.date},null,8,["task-id","task-name","task-date","description","subject","theme","stars","media","post-id","student-name","nickname","email","teacher","student-img","teacher-img","accepted","review","date"])])}),128))])]),_:1})]),_:1}),l("div",Je,[!s.value||w.value?(n(),v("div",qe,[a(re,{size:50,color:"primary",indeterminate:""})])):N("",!0)])])]),a(ee)],64)}}};export{Jt as default};
