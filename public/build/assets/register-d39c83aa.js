import{_ as E}from"./AppTextField-862a83a4.js";import{_ as O}from"./AppSelect-3e238d9d.js";import{r as m,j as z,k as J,H as G,a as H,o as y,f as g,e as l,b as a,d as i,n as u,I as Y,a$ as K,ai as Q,v as k,$ as b,aY as W}from"./main-ee7c17de.js";import{f as X,s as Z}from"./fetchStudentData-923239c4.js";import{f as ee,t as ae}from"./fetchTeacherData-73b473f8.js";import{u as te}from"./useAbility-112c1c58.js";import{a as le,b as oe,c as se,d as re}from"./auth-v2-register-illustration-light-25193346.js";import{a as ie,b as ne}from"./misc-mask-light-a3cab517.js";import{V as ue}from"./VNodeRenderer-75612b94.js";import{u as I}from"./useGenerateImageVariant-be191089.js";import{$ as de}from"./api-693dfc91.js";import{V as x}from"./VImg-d487f910.js";import{V as r}from"./VCol-cfb71e73.js";import{V as me}from"./VCard-cba44afa.js";import{V as T}from"./VCardText-6be2f581.js";import{V as pe}from"./VForm-e8199224.js";import{V as R}from"./VRow-271260dd.js";import{V as ce}from"./VSwitch-87132e29.js";import{V as fe}from"./VCheckbox-ee5064b1.js";import{V as ve}from"./form-baa91886.js";import"./VTextField-65dae01b.js";/* empty css                   */import"./VCounter-97a26890.js";import"./VField-2b6b59c0.js";import"./easing-9f15041e.js";import"./VInput-29651115.js";import"./forwardRefs-8348545e.js";import"./VSelect-cea4b28e.js";import"./VList-dd2cb195.js";import"./ssrBoot-c8beb59b.js";import"./VAvatar-4667946e.js";import"./VDivider-5a8f189b.js";import"./dialog-transition-9860be03.js";import"./VMenu-6af39dc3.js";import"./VOverlay-9c9ed528.js";import"./lazy-ad9bbcd3.js";import"./scopeId-f06193c4.js";import"./VCheckboxBtn-0cef0367.js";import"./VSelectionControl-fc422a63.js";import"./VChip-7b4a1ec4.js";import"./useApi-ee5b865a.js";import"./index-a2f3e4b4.js";import"./index-9c720871.js";const Ve={class:"position-relative bg-background rounded-lg w-100 ma-8 me-0"},ye={class:"d-flex align-center justify-center w-100 h-100"},ge={class:"demo-space-x"},be={class:"d-flex align-center mt-2 mb-4"},da={__name:"register",setup(he){const C=I(re,se,oe,le,!0),j=I(ne,ie),h=m(),c=m(!0),o=m({adminStudentId:"Select",adminTeacherId:"Select",email:"lubna@jazacademy.id",password:"",passwordConfirmation:"",privacyPolicies:!1}),w=z(),D=J(),M=te(),n=m(!1),N=m({}),P=m(""),v=s=>!!s||"This field is required",$=s=>/.+@.+\..+/.test(s)||"E-mail must be valid",A=s=>e=>e===s||"Password does not match";G(async()=>{await X(),await ee()});const U=async()=>{var e,p,d,f;const s={...o.value,adminStudentId:((e=o.value.adminStudentId)==null?void 0:e.id)||null,adminTeacherId:((p=o.value.adminTeacherId)==null?void 0:p.id)||null,name:((d=o.value.adminStudentId)==null?void 0:d.name)||((f=o.value.adminTeacherId)==null?void 0:f.name)};try{const t=await de("/auth/register",{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"},onResponseError({response:V}){N.value=V._data.errors,P.value=V._data.message||"Register failed"}}),{accessToken:L,userData:q,userAbilityRules:S,participant:_}=t;if(b("userAbilityRules").value=S,M.update(S),b("userData").value=q,b("accessToken").value=L,_){const{password:V,...F}=_;localStorage.setItem("participant",JSON.stringify(F))}await W(()=>{D.replace(w.query.to?String(w.query.to):"/login")})}catch(t){console.error(t)}},B=()=>{var s;(s=h.value)==null||s.validate().then(({valid:e})=>{e&&U()})};return(s,e)=>{const p=O,d=E,f=H("RouterLink");return y(),g(R,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:l(()=>[a(r,{md:"8",class:"d-none d-md-flex"},{default:l(()=>[i("div",Ve,[i("div",ye,[a(x,{"max-width":"441",src:u(C),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),a(x,{class:"auth-footer-mask",src:u(j)},null,8,["src"])])]),_:1}),a(r,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:l(()=>[a(me,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:l(()=>[a(T,null,{default:l(()=>[a(u(ue),{nodes:u(Y).app.logo,class:"mb-6"},null,8,["nodes"]),e[9]||(e[9]=i("h5",{class:"text-h5 mb-1"}," Adventure starts here 🚀 ",-1)),e[10]||(e[10]=i("p",{class:"mb-0"}," Make your app management easy and fun! ",-1))]),_:1}),a(T,null,{default:l(()=>[a(u(pe),{ref_key:"refVForm",ref:h,onSubmit:K(B,["prevent"])},{default:l(()=>[a(R,null,{default:l(()=>[a(r,{cols:"12"},{default:l(()=>[i("div",ge,[a(ce,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),label:c.value?"I'm Student":"I'm Teacher"},null,8,["modelValue","label"])])]),_:1}),c.value?(y(),g(r,{key:0,cols:"12"},{default:l(()=>[a(p,{modelValue:o.value.adminStudentId,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.adminStudentId=t),hint:"Select Student Name",items:u(Z),"item-title":"name","item-value":"id","persistent-hint":"","return-object":"","single-line":"",placeholder:"Select Student"},null,8,["modelValue","items"])]),_:1})):(y(),g(r,{key:1,cols:"12"},{default:l(()=>[a(p,{modelValue:o.value.adminTeacherId,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.adminTeacherId=t),hint:"Select Teacher Name",items:u(ae),"item-title":"name","item-value":"id","persistent-hint":"","return-object":"","single-line":"",placeholder:"Select Teacher"},null,8,["modelValue","items"])]),_:1})),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.email,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.email=t),rules:[v,$],label:"Email",type:"email",placeholder:"lubna@jazacademy.id"},null,8,["modelValue","rules"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.password,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.password=t),rules:[v],label:"Password",placeholder:"············",type:n.value?"text":"password","append-inner-icon":n.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[5]||(e[5]=t=>n.value=!n.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.passwordConfirmation,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.passwordConfirmation=t),rules:[v,A(o.value.password)],label:"Re-Type Password",placeholder:"············",type:n.value?"text":"password","append-inner-icon":n.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[7]||(e[7]=t=>n.value=!n.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[i("div",be,[a(fe,{id:"privacy-policy",modelValue:o.value.privacyPolicies,"onUpdate:modelValue":e[8]||(e[8]=t=>o.value.privacyPolicies=t),inline:""},null,8,["modelValue"]),a(ve,{for:"privacy-policy",style:{opacity:"1"}},{default:l(()=>e[11]||(e[11]=[i("span",{class:"me-1"},"I agree to",-1),i("a",{href:"javascript:void(0)",class:"text-primary"},"privacy policy & terms",-1)])),_:1})]),a(Q,{block:"",type:"submit"},{default:l(()=>e[12]||(e[12]=[k(" Sign up ")])),_:1})]),_:1}),a(r,{cols:"12",class:"text-center text-base"},{default:l(()=>[e[14]||(e[14]=i("span",null,"Already have an account?",-1)),a(f,{class:"text-primary ms-2",to:{name:"login"}},{default:l(()=>e[13]||(e[13]=[k(" Sign in instead ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})}}};export{da as default};
