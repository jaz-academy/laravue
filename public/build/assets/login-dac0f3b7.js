import{r as k,e as N}from"./validators-0f663a71.js";import{r as u,j as S,k as F,a as P,o as x,f as _,e as o,b as a,d as l,n as t,I as h,v as i,x as C,z as U,a$ as z,aU as E,ai as L,$ as b,aY as G}from"./main-67b8cec6.js";import{_ as J}from"./AppTextField-6f67a54a.js";import{u as R}from"./useGenerateImageVariant-378af967.js";import{a as O,b as W,c as Y,d as H}from"./auth-v2-login-illustration-light-8e098e97.js";import{a as K,b as Q}from"./misc-mask-light-a3cab517.js";import{V as X}from"./VNodeRenderer-8e7a69af.js";import{u as Z}from"./useAbility-800a8751.js";import{$ as ee}from"./api-ccb75bb2.js";import{V as I}from"./VImg-3c3e7f31.js";import{a as n,V as T}from"./VRow-0e61bfb6.js";import{V as ae}from"./VCard-70db4173.js";import{V as y}from"./VCardText-61e3901b.js";import{V as te}from"./VAlert-d324d98b.js";import{V as oe}from"./VForm-c2ca4555.js";import{V as se}from"./VCheckbox-7209ab22.js";import{V as D}from"./VDivider-e0fd92b0.js";import"./helpers-00da9b75.js";import"./no-profile-4221a4a6.js";import"./form-e6998416.js";import"./VTextField-e3decb3d.js";/* empty css                   */import"./VCounter-6dd2f7e9.js";import"./VField-ddf3fe8e.js";import"./easing-9f15041e.js";import"./VInput-1124ae67.js";import"./forwardRefs-8348545e.js";import"./index-0245bbcf.js";import"./index-9c720871.js";import"./VAvatar-42bec599.js";import"./VCheckboxBtn-4186776c.js";import"./VSelectionControl-3490ebc3.js";const re={class:"position-relative bg-background rounded-lg w-100 ma-8 me-0"},le={class:"d-flex align-center justify-center w-100 h-100"},ie={class:"text-h4 mb-1"},ne={class:"text-capitalize"},me={class:"d-flex align-center flex-wrap justify-space-between mt-1 mb-4"},Ee={__name:"login",setup(ue){const q=R(H,Y,W,O,!0),B=R(Q,K),p=u(!1),v=S(),M=F(),$=Z(),c=u({email:void 0,password:void 0}),f=u(""),w=u(),m=u({email:"",password:""}),g=u(!1),j=async()=>{try{const s=await ee("/auth/login",{method:"POST",body:{email:m.value.email,password:m.value.password},onResponseError({response:r}){c.value=r._data.errors,f.value=r._data.message||"Login failed"}}),{accessToken:e,userData:V,userAbilityRules:d}=s;b("userAbilityRules").value=d,$.update(d),b("userData").value=V,b("accessToken").value=e,await G(()=>{M.replace(v.query.to?String(v.query.to):"/login")})}catch(s){console.error(s)}},A=()=>{var s;(s=w.value)==null||s.validate().then(({valid:e})=>{e&&j()})};return(s,e)=>{const V=J,d=P("RouterLink");return x(),_(T,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:o(()=>[a(n,{lg:"8",class:"d-none d-lg-flex"},{default:o(()=>[l("div",re,[l("div",le,[a(I,{"max-width":"505",src:t(q),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),a(I,{src:t(B),class:"auth-footer-mask"},null,8,["src"])])]),_:1}),a(n,{cols:"12",lg:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:o(()=>[a(ae,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:o(()=>[a(y,null,{default:o(()=>[a(t(X),{nodes:t(h).app.logo,class:"mb-6"},null,8,["nodes"]),l("h4",ie,[e[5]||(e[5]=i(" Welcome to ")),l("span",ne,C(t(h).app.title),1),e[6]||(e[6]=i("!  "))]),e[7]||(e[7]=l("p",{class:"mb-0"}," Jaz Academy Project Management System ",-1))]),_:1}),a(y,null,{default:o(()=>[t(f)?(x(),_(te,{key:0,type:"error",dismissible:"","onClick:close":e[0]||(e[0]=r=>f.value="")},{default:o(()=>[i(C(t(f)),1)]),_:1})):U("",!0)]),_:1}),a(y,null,{default:o(()=>[a(t(oe),{ref_key:"refVForm",ref:w,onSubmit:z(A,["prevent"])},{default:o(()=>[a(T,null,{default:o(()=>[a(n,{cols:"12"},{default:o(()=>[a(V,{modelValue:t(m).email,"onUpdate:modelValue":e[1]||(e[1]=r=>t(m).email=r),label:"Email",placeholder:"johndoe@email.com",type:"email",autofocus:"",rules:["requiredValidator"in s?s.requiredValidator:t(k),"emailValidator"in s?s.emailValidator:t(N)],"error-messages":t(c).email},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12"},{default:o(()=>[a(V,{modelValue:t(m).password,"onUpdate:modelValue":e[2]||(e[2]=r=>t(m).password=r),label:"Password",placeholder:"路路路路路路路路路路路路",rules:["requiredValidator"in s?s.requiredValidator:t(k)],type:t(p)?"text":"password","error-messages":t(c).password,"append-inner-icon":t(p)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[3]||(e[3]=r=>p.value=!t(p))},null,8,["modelValue","rules","type","error-messages","append-inner-icon"]),l("div",me,[a(se,{modelValue:t(g),"onUpdate:modelValue":e[4]||(e[4]=r=>E(g)?g.value=r:null),label:"Remember me"},null,8,["modelValue"]),a(d,{class:"text-primary ms-2 mb-1 d-none",to:{name:"forgot-password"}},{default:o(()=>e[8]||(e[8]=[i(" Forgot Password? ")])),_:1})]),a(L,{block:"",type:"submit"},{default:o(()=>e[9]||(e[9]=[i(" Login ")])),_:1})]),_:1}),a(n,{cols:"12",class:"text-center"},{default:o(()=>[e[11]||(e[11]=l("span",null,"New member?",-1)),a(d,{class:"text-primary ms-2",to:{name:"register"}},{default:o(()=>e[10]||(e[10]=[i(" Create an account ")])),_:1})]),_:1}),a(n,{cols:"12",class:"d-flex align-center"},{default:o(()=>[a(D),e[12]||(e[12]=l("span",{class:"mx-4"},"or",-1)),a(D)]),_:1}),a(n,{cols:"12",class:"text-center"},{default:o(()=>[a(L,{color:"secondary",to:"/"},{default:o(()=>e[13]||(e[13]=[i(" Back to Dashboard ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Ee as default};
