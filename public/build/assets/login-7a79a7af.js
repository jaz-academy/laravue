import{r as x,e as F}from"./validators-3848b933.js";import{r as u,j as P,k as U,a as z,o as _,f as h,e as o,b as a,d as l,n as t,I as C,v as i,x as L,z as E,a$ as J,aU as O,ai as R,$ as y,aY as G}from"./main-7a04a4cc.js";import{_ as W}from"./AppTextField-07b9446e.js";import{u as I}from"./useGenerateImageVariant-37117b74.js";import{a as Y,b as H,c as K,d as Q}from"./auth-v2-login-illustration-light-8e098e97.js";import{a as X,b as Z}from"./misc-mask-light-a3cab517.js";import{V as ee}from"./VNodeRenderer-d7a79f84.js";import{u as ae}from"./useAbility-ed95285c.js";import{$ as te}from"./api-272becb3.js";import{V as D}from"./VImg-785fe2da.js";import{V as n}from"./VCol-3541d7c7.js";import{V as oe}from"./VCard-c1d86edf.js";import{V as v}from"./VCardText-89ccd074.js";import{V as se}from"./VAlert-5ede27f5.js";import{V as re}from"./VForm-eac8e6b7.js";import{V as T}from"./VRow-9ddfb65a.js";import{V as le}from"./VCheckbox-cc1ce884.js";import{V as S}from"./VDivider-cd55d271.js";import"./helpers-929cea30.js";import"./no-profile-4221a4a6.js";import"./form-41eb478e.js";import"./VTextField-8b5d0ff7.js";/* empty css                   */import"./VCounter-9d080591.js";import"./VField-eef30866.js";import"./easing-9f15041e.js";import"./VInput-5d1e9d15.js";import"./forwardRefs-8348545e.js";import"./index-d1c1b48d.js";import"./index-9c720871.js";import"./VAvatar-a8f8d7de.js";import"./VCheckboxBtn-e67cbaff.js";import"./VSelectionControl-ff913cdc.js";const ie={class:"position-relative bg-background rounded-lg w-100 ma-8 me-0"},ne={class:"d-flex align-center justify-center w-100 h-100"},me={class:"text-h4 mb-1"},ue={class:"text-capitalize"},de={class:"d-flex align-center flex-wrap justify-space-between mt-1 mb-4"},Ge={__name:"login",setup(pe){const q=I(Q,K,H,Y,!0),B=I(Z,X),p=u(!1),w=P(),M=U(),N=ae(),V=u({email:void 0,password:void 0}),f=u(""),k=u(),m=u({email:"",password:""}),g=u(!1),$=async()=>{try{const s=await te("/auth/login",{method:"POST",body:{email:m.value.email,password:m.value.password},onResponseError({response:b}){V.value=b._data.errors,f.value=b._data.message||"Login failed"}}),{accessToken:e,userData:c,userAbilityRules:d,participant:r}=s;if(y("userAbilityRules").value=d,N.update(d),y("userData").value=c,y("accessToken").value=e,r){const{password:b,...A}=r;localStorage.setItem("participant",JSON.stringify(A))}await G(()=>{M.replace(w.query.to?String(w.query.to):"/login")})}catch(s){console.error(s)}},j=()=>{var s;(s=k.value)==null||s.validate().then(({valid:e})=>{e&&$()})};return(s,e)=>{const c=W,d=z("RouterLink");return _(),h(T,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:o(()=>[a(n,{lg:"8",class:"d-none d-lg-flex"},{default:o(()=>[l("div",ie,[l("div",ne,[a(D,{"max-width":"505",src:t(q),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),a(D,{src:t(B),class:"auth-footer-mask"},null,8,["src"])])]),_:1}),a(n,{cols:"12",lg:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:o(()=>[a(oe,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:o(()=>[a(v,null,{default:o(()=>[a(t(ee),{nodes:t(C).app.logo,class:"mb-6"},null,8,["nodes"]),l("h4",me,[e[5]||(e[5]=i(" Welcome to ")),l("span",ue,L(t(C).app.title),1),e[6]||(e[6]=i("! 👋🏻 "))]),e[7]||(e[7]=l("p",{class:"mb-0"}," Jaz Academy Project Management System ",-1))]),_:1}),a(v,null,{default:o(()=>[t(f)?(_(),h(se,{key:0,type:"error",dismissible:"","onClick:close":e[0]||(e[0]=r=>f.value="")},{default:o(()=>[i(L(t(f)),1)]),_:1})):E("",!0)]),_:1}),a(v,null,{default:o(()=>[a(t(re),{ref_key:"refVForm",ref:k,onSubmit:J(j,["prevent"])},{default:o(()=>[a(T,null,{default:o(()=>[a(n,{cols:"12"},{default:o(()=>[a(c,{modelValue:t(m).email,"onUpdate:modelValue":e[1]||(e[1]=r=>t(m).email=r),label:"Email",placeholder:"johndoe@email.com",type:"email",autofocus:"",rules:["requiredValidator"in s?s.requiredValidator:t(x),"emailValidator"in s?s.emailValidator:t(F)],"error-messages":t(V).email},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"12"},{default:o(()=>[a(c,{modelValue:t(m).password,"onUpdate:modelValue":e[2]||(e[2]=r=>t(m).password=r),label:"Password",placeholder:"············",rules:["requiredValidator"in s?s.requiredValidator:t(x)],type:t(p)?"text":"password","error-messages":t(V).password,"append-inner-icon":t(p)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[3]||(e[3]=r=>p.value=!t(p))},null,8,["modelValue","rules","type","error-messages","append-inner-icon"]),l("div",de,[a(le,{modelValue:t(g),"onUpdate:modelValue":e[4]||(e[4]=r=>O(g)?g.value=r:null),label:"Remember me"},null,8,["modelValue"]),a(d,{class:"text-primary ms-2 mb-1 d-none",to:{name:"forgot-password"}},{default:o(()=>e[8]||(e[8]=[i(" Forgot Password? ")])),_:1})]),a(R,{block:"",type:"submit"},{default:o(()=>e[9]||(e[9]=[i(" Login ")])),_:1})]),_:1}),a(n,{cols:"12",class:"text-center"},{default:o(()=>[e[11]||(e[11]=l("span",null,"New member?",-1)),a(d,{class:"text-primary ms-2",to:{name:"register"}},{default:o(()=>e[10]||(e[10]=[i(" Create an account ")])),_:1})]),_:1}),a(n,{cols:"12",class:"d-flex align-center"},{default:o(()=>[a(S),e[12]||(e[12]=l("span",{class:"mx-4"},"or",-1)),a(S)]),_:1}),a(n,{cols:"12",class:"text-center"},{default:o(()=>[a(R,{color:"secondary",to:"/"},{default:o(()=>e[13]||(e[13]=[i(" Back to Dashboard ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Ge as default};
