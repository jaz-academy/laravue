import{r as d,a5 as Q,H as J,b6 as W,a as G,o as i,f as v,e as l,b as o,z as V,d as s,n,x as _,c as g,aU as S,a0 as N,v as M,a$ as X,ai as H,j as Z,k as ee,w as te,aY as ae,b7 as se,K as oe,b8 as re,b9 as le,F as ne,i as ie}from"./main-67b8cec6.js";import{u as ce}from"./useApi-651d1cd8.js";import{N as me,F as de}from"./front-page-navbar-b18dfa77.js";import{H as ue}from"./hero-section-bb9499d8.js";import{_ as pe}from"./AppTextarea-1d0affaf.js";import{_ as ve}from"./AppSelect-90885faf.js";import{c as B}from"./formatters-fcc80aa5.js";import{a as T}from"./no-profile-4221a4a6.js";import{_ as fe}from"./GDriveEmbed-200515ab.js";import{_ as _e}from"./InstagramEmbed-c19d31cb.js";import{t as he,f as ge}from"./fetchTeacherData-125d1411.js";import{$ as ye}from"./api-ccb75bb2.js";import{V as xe}from"./VCardText-61e3901b.js";import{V as F,a as $}from"./VRow-0e61bfb6.js";import{V as K}from"./VAvatar-42bec599.js";import{V as R}from"./VImg-3c3e7f31.js";import{V as D}from"./VRating-915c4df7.js";import{V as be}from"./VAlert-d324d98b.js";import{V as ke}from"./VForm-c2ca4555.js";import{V as we}from"./VList-20a5129c.js";import{V as Ve}from"./VCard-70db4173.js";import"./AppTextField-6f67a54a.js";import"./form-e6998416.js";import"./VTextField-e3decb3d.js";/* empty css                   */import"./VCounter-6dd2f7e9.js";import"./VField-ddf3fe8e.js";import"./easing-9f15041e.js";import"./VInput-1124ae67.js";import"./forwardRefs-8348545e.js";import"./VNodeRenderer-8e7a69af.js";import"./useGenerateImageVariant-378af967.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VChip-177f961c.js";import"./VContainer-3bd8077a.js";import"./NavbarThemeSwitcher-d42493a7.js";import"./VTooltip-11975216.js";import"./VOverlay-1200b457.js";import"./lazy-0c0b49da.js";import"./scopeId-dd1b16f6.js";import"./VMenu-3a17e05d.js";import"./dialog-transition-df011ef4.js";import"./VNavigationDrawer-da07dc00.js";import"./ssrBoot-74d8f6b8.js";import"./VToolbar-5d87cecf.js";import"./VSpacer-cb7c7677.js";import"./hero-elements-light-b61b0468.js";/* empty css                 */import"./VSelect-2e4a8d4f.js";import"./VCheckboxBtn-4186776c.js";import"./VSelectionControl-3490ebc3.js";import"./helpers-00da9b75.js";import"./index-0245bbcf.js";import"./index-9c720871.js";import"./VDivider-e0fd92b0.js";const Se={class:"d-flex justify-space-between align-center mb-2"},$e={class:"d-flex align-center"},Ie={class:"text-base text-primary"},Ne={class:"text-sm text-medium-emphasis"},Ce={class:"d-flex flex-column text-end"},je={class:"text-sm text-primary"},Ae=["href"],Te={class:"text-body-1 text-primary"},Re={class:"text-body-2 d-inline"},Me=["href"],Le=["href"],Ue={class:"d-flex align-center mt-4"},Pe={class:"d-flex flex-column"},Be={class:"font-weight-medium text-link ps-1"},De={class:"text-base text-primary ms-1"},He={class:"text-sm text-medium-emphasis cursor-pointer"},qe={class:"text-body-2 mt-2"},ze={class:"d-flex justify-space-between my-4 flex-wrap action-icons"},Ee={class:""},Oe={key:0,class:"modal-overlay"},Ye={class:"modal-content"},Fe={class:"flex-grow-1 overflow-auto d-none",style:{"max-block-size":"100%"}},Ke=["innerHTML"],Qe={__name:"HomeCard",props:{taskId:Number,taskName:String,description:String,subject:String,theme:String,stars:String,media:String,postId:String,studentName:String,nickname:String,email:String,teacher:Object,review:String,studentImg:String,teacherImg:String,accepted:Number,link:String,date:String},setup(L){const t=L,C=localStorage.getItem("participant"),y=C?JSON.parse(C):null,x=d(!1),p=d(""),f=d(t.teacher),k=d(t.accepted?"Yes":"No"),h=d(t.review),c=d(t.stars),b=d(!!t.accepted),U=Q(()=>he.value.map(u=>({title:u.nickname,value:{id:u.id,name:u.nickname}}))),P=u=>{u==="Yes"?b.value=!0:b.value=!1},w=async()=>{if(f.value===""){p.value="Please select a mentor";return}else if(k.value===""){p.value="Please select accepted";return}else if(c.value===0){p.value="Please select a rating";return}else if(h.value===""){p.value="Please write a review";return}else{const u={admin_teacher_id:f.value.id,accepted:k.value=="Yes"?1:0,rate:c.value,review:h.value};console.log("Rating submitted:",u);try{const e=await ye(`/public/update-task-accepted/${t.taskId}`,{method:"POST",body:u,onResponseError({err:m}){p.value=m}});console.log("Rating response:",e),c.value=e.data.rate,h.value=e.data.review}catch(e){console.error("Error submitting rating:",e)}x.value=!1}},j=()=>{(window.scrollY||document.documentElement.scrollTop)>100&&(x.value=!1)};J(()=>{ge(),window.addEventListener("scroll",j)}),W(()=>{window.removeEventListener("scroll",j)});const I=[{prependAvatar:T,title:"Brunch this weekend?",subtitle:`<span class="text-primary">Ali Connors</span> &mdash; I'll be in your neighborhood doing errands this weekend. Do you want to hang out?`},{type:"divider",inset:!0},{prependAvatar:T,title:"Summer BBQ",subtitle:`<span class="text-primary">to Alex, Scott, Jennifer</span> &mdash; Wish I could come, but I'm out of town this weekend.`},{type:"divider",inset:!0}];return(u,e)=>{const m=G("RouterLink"),a=ve,A=pe;return i(),v(Ve,{class:"posting-card"},{default:l(()=>[o(xe,null,{default:l(()=>[o(F,null,{default:l(()=>[o($,{cols:"12",md:"7"},{default:l(()=>[t.media=="Google Drive"?(i(),v(fe,{key:0,"post-id":t.postId},null,8,["post-id"])):V("",!0),t.media=="Instagram"?(i(),v(_e,{key:1,"post-id":t.postId},null,8,["post-id"])):V("",!0)]),_:1}),o($,{cols:"12",md:"5"},{default:l(()=>[s("div",null,[s("div",Se,[s("div",$e,[o(K,{size:"34",variant:"tonal",color:"primary",class:"me-3"},{default:l(()=>[t.studentImg?(i(),v(R,{key:0,src:`/storage/${t.studentImg}`,cover:""},null,8,["src"])):(i(),v(R,{key:1,src:n(T)},null,8,["src"]))]),_:1}),o(m,{to:`/?search=${n(B)(t.studentName,10,1).toLowerCase()}`,class:"d-flex flex-column"},{default:l(()=>[s("h6",Ie,_(n(B)(t.studentName,30,3)),1),s("span",Ne,_(t.email||t.nickname),1)]),_:1},8,["to"])]),s("div",Ce,[s("small",je,_(new Date(t.date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})),1),s("a",{href:`/?search=${t.taskId}`,class:"text-sm text-medium-emphasis"},_(t.taskId),9,Ae)])]),e[11]||(e[11]=s("hr",{class:"my-custom-line"},null,-1)),o(m,{to:`/?search=${n(B)(t.theme,30,4).toLowerCase()}`,class:"d-flex flex-column"},{default:l(()=>[s("p",Te,_(t.subject+": "+t.theme),1)]),_:1},8,["to"]),s("p",Re,[s("a",{href:t.link?t.link:`/?search=${t.taskId}`,class:"text-primary",target:"_blank",rel:"noopener noreferrer"},_(t.taskName.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")),9,Me),s("a",{href:L.link,target:"_blank",rel:"noopener noreferrer",class:"text-secondary"},_(" "+t.description),9,Le)]),s("div",Ue,[o(K,{size:"34",variant:"tonal",class:"me-3",color:t.accepted?"primary":"warning"},{default:l(()=>[t.teacherImg?(i(),v(R,{key:0,src:`/storage/${t.teacherImg}`,cover:""},null,8,["src"])):(i(),v(R,{key:1,src:n(T)},null,8,["src"]))]),_:1},8,["color"]),s("div",Pe,[s("div",Be,[s("h6",De,_(n(f).name),1)]),s("div",He,[n(y)&&n(y).role>1?(i(),g("div",{key:0,class:"d-flex flex-column",onClick:e[1]||(e[1]=r=>x.value=!0)},[o(D,{modelValue:n(c),"onUpdate:modelValue":e[0]||(e[0]=r=>S(c)?c.value=r:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])])):(i(),v(m,{key:1,to:"/front/bookmark",class:"d-flex flex-column"},{default:l(()=>[o(D,{modelValue:n(c),"onUpdate:modelValue":e[2]||(e[2]=r=>S(c)?c.value=r:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])]),_:1}))])])]),s("p",qe,_(n(h)),1),e[12]||(e[12]=s("hr",{class:"my-custom-line"},null,-1)),s("div",ze,[s("div",Ee,[o(N,{icon:"tabler-heart"}),o(N,{icon:"tabler-message-2",class:"ms-2"})]),o(N,{icon:"tabler-bookmark"})]),n(x)?(i(),g("div",Oe,[s("div",Ye,[n(p)?(i(),v(be,{key:0,type:"error",class:"mb-5",dismissible:"",onClick:e[3]||(e[3]=r=>p.value="")},{default:l(()=>[M(_(n(p)),1)]),_:1})):V("",!0),o(ke,{onSubmit:X(r=>({}),["prevent"])},{default:l(()=>[o(F,null,{default:l(()=>[o($,{cols:"12"},{default:l(()=>[o(a,{modelValue:n(f),"onUpdate:modelValue":e[4]||(e[4]=r=>S(f)?f.value=r:null),label:"Mentor",placeholder:"Select Mentor",items:n(U),"item-title":"value.name","item-value":"value"},null,8,["modelValue","items"])]),_:1}),o($,{cols:"12"},{default:l(()=>[o(a,{modelValue:n(k),"onUpdate:modelValue":[e[5]||(e[5]=r=>S(k)?k.value=r:null),P],label:"Accepted",placeholder:"Not Accepted",items:["Yes","No"]},null,8,["modelValue"])]),_:1}),n(b)?(i(),v($,{key:0,cols:"12",class:"text-center"},{default:l(()=>[o(D,{modelValue:n(c),"onUpdate:modelValue":e[6]||(e[6]=r=>S(c)?c.value=r:null),"half-increments":"",hover:""},null,8,["modelValue"]),o(A,{modelValue:n(h),"onUpdate:modelValue":e[7]||(e[7]=r=>S(h)?h.value=r:null),placeholder:"Write your review...",rows:3},null,8,["modelValue"])]),_:1})):V("",!0),o($,{cols:"12",class:"mt-4"},{default:l(()=>[o(H,{type:"submit",class:"me-2",onClick:w},{default:l(()=>e[9]||(e[9]=[M(" Save ")])),_:1}),o(H,{color:"secondary",class:"me-2",onClick:e[8]||(e[8]=r=>x.value=!1)},{default:l(()=>e[10]||(e[10]=[M(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})])])):V("",!0),s("div",Fe,[o(we,{lines:"three",items:I,"item-props":""},{subtitle:l(({subtitle:r})=>[s("div",{innerHTML:r},null,8,Ke)]),_:1})])])]),_:1})]),_:1})]),_:1})]),_:1})}}};const Je={class:"landing-page-wrapper"},We={key:1,class:"text-center sticky-header bg-background pb-8"},Ge={class:"input-group mt-16 justify-center",style:{display:"flex","align-items":"center",gap:"0.5rem"}},Xe=["href"],Ze={key:2,class:"text-center my-16 py-2"},et={key:0,class:"flex justify-center items-center"},tt={key:1,class:"text-gray-400"},sa={__name:"index",setup(L){const t=Z(),C=ee(),y=d(t.query.search||""),x=Q(()=>Object.keys(t.query).length>0),p=d([]),f=d(1),k=d(3),h=d(t.query.search||""),c=d(!1),b=d(!0),U=d(null),P=d(null),w=d(null),j=()=>{C.push({query:{...t.query,search:y.value}})},I=async()=>{var a;if(c.value||!b.value)return;c.value=!0;const{data:e}=await ce(`/public/tasks?page=${f.value}&perPage=${k.value}&search=${h.value}&rates=5`),m=((a=e.value)==null?void 0:a.data)||[];m.length?(p.value.push(...m),f.value++):b.value=!1,c.value=!1};te(()=>t.query.search,async e=>{y.value=e||"",f.value=1,p.value=[],b.value=!0,await I(),console.log(p.value)});let u;return J(async()=>{await I(),await ae(),w.value&&(u=new IntersectionObserver(e=>{e[0].isIntersecting&&I()}),u.observe(w.value))}),se(()=>{u&&w.value&&u.unobserve(w.value)}),(e,m)=>(i(),g("div",Je,[o(me,{"active-id":U.value},null,8,["active-id"]),x.value?V("",!0):(i(),v(ue,{key:0,ref:"refHome",class:"mb-16"},null,512)),x.value?(i(),g("div",We,[m[1]||(m[1]=s("br",null,null,-1)),m[2]||(m[2]=s("br",null,null,-1)),s("div",Ge,[oe(s("input",{"onUpdate:modelValue":m[0]||(m[0]=a=>y.value=a),type:"text",placeholder:"Search by Id, Name, Mentor, Theme...",class:"border w-50 px-3 py-2 rounded",onKeyup:le(j,["enter"])},null,544),[[re,y.value]]),s("a",{href:`?search=${encodeURIComponent(y.value)}`,class:"btn btn-primary"},[o(H,null,{default:l(()=>[o(N,{icon:"tabler-search"})]),_:1})],8,Xe)])])):(i(),g("div",Ze," . ")),s("div",{id:"content-post",ref_key:"scrollContainer",ref:P},[(i(!0),g(ne,null,ie(p.value,a=>{var A,r,q,z,E,O,Y;return i(),g("div",{key:a.id},[o(Qe,{class:"card-post","task-id":a.id,"task-name":a.name,description:a.description,subject:a.project_plan.subject,theme:a.project_plan.theme,stars:a.rate,media:a.media,"post-id":a.media=="Instagram"?(r=(A=a.link)==null?void 0:A.match(/\/(?:p|reel)\/([\w-]+)/))==null?void 0:r[1]:((z=(q=a.link)==null?void 0:q.match(/\/d\/(.*?)\//))==null?void 0:z[1])||"N/A","student-name":a.admin_student.name,nickname:a.admin_student.nickname,email:a.admin_student.email,mentor:((E=a.admin_teacher)==null?void 0:E.nickname)||"Not Accepted",review:(a==null?void 0:a.review)||null,teacher:a.admin_teacher?{id:a.admin_teacher.id,name:a.admin_teacher.nickname}:"Not Accepted","student-img":(O=a.admin_student)==null?void 0:O.image,"teacher-img":(Y=a.admin_teacher)==null?void 0:Y.image,accepted:a.accepted,link:a.link,date:a.date},null,8,["task-id","task-name","description","subject","theme","stars","media","post-id","student-name","nickname","email","mentor","review","teacher","student-img","teacher-img","accepted","link","date"])])}),128)),s("div",{ref_key:"loadMoreTrigger",ref:w,class:"py-4 text-center text-gray-400"},[c.value?(i(),g("div",et,[o(N,{icon:"mdi-loading",spin:"",class:"mr-2"}),m[3]||(m[3]=M(" Loading... "))])):b.value?V("",!0):(i(),g("div",tt," No more tasks. "))],512)],512),o(de)]))}};export{sa as default};
