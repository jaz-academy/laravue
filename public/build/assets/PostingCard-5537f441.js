import{t as O}from"./helpers-0ad46068.js";import{c as w}from"./formatters-b77a216c.js";import{r as f,a5 as F,H,b6 as J,a as W,o as i,f as m,e as l,b as a,z as g,d as o,c as S,F as G,i as Q,n,v as b,x as c,aU as h,a0 as C,a$ as q,ai as U}from"./main-37de545e.js";import{_ as K}from"./AppTextarea-358e4645.js";import{_ as X}from"./AppSelect-c31ef19a.js";import{a as N}from"./no-profile-4221a4a6.js";import{_ as Z}from"./GDriveEmbed-2e7b34ca.js";import{_ as ee}from"./InstagramEmbed-9d0477c8.js";import{t as te,f as ae}from"./fetchTeacherData-f454908a.js";import{$ as se}from"./api-b41d5acf.js";import{V as le}from"./VCardText-87a2555b.js";import{V as M,a as y}from"./VRow-fac58b63.js";import{V as $}from"./VAvatar-93aa4262.js";import{V as I}from"./VImg-ab0ba356.js";import{V as oe}from"./VTooltip-6c0a2c32.js";import{V as A}from"./VRating-d5ff9f67.js";import{V as ne}from"./VAlert-df2ee2c3.js";import{V as re}from"./VForm-8be29ffd.js";import{V as ie}from"./VList-002b35c7.js";import{V as de}from"./VCard-c1035577.js";const me={class:"d-flex align-center"},ce={class:"v-avatar-group me-2"},ue={class:"text-xs"},pe={class:"text-base text-primary"},fe={class:"text-sm text-medium-emphasis"},ve={class:"text-body-1 text-primary"},_e={class:"text-body-2 d-inline"},ge={class:"d-flex align-center mt-4"},be={class:"d-flex flex-column"},he={class:"d-flex flex-column"},ye={class:"text-base text-primary ms-1"},Ve={class:"text-sm text-medium-emphasis cursor-pointer"},ke={class:"text-body-2 mt-2"},xe={class:"d-flex justify-space-between my-4 flex-wrap action-icons"},we={class:""},Se={key:0,class:"modal-overlay"},Ce={class:"modal-content"},Ne={class:"flex-grow-1 overflow-auto d-none",style:{"max-block-size":"100%"}},$e=["innerHTML"],Qe={__name:"PostingCard",props:{taskId:Number,taskName:String,description:String,subject:String,theme:String,stars:String,media:String,postId:String,students:Array,teacher:Object,review:String,teacherImg:String,accepted:Number,link:String,date:String},setup(P){const t=P,R=localStorage.getItem("participant"),L=R?JSON.parse(R):null,V=f(!1),u=f(""),v=f(t.teacher),k=f(t.accepted?"Yes":"No"),p=f(t.review),d=f(t.stars),x=f(!!t.accepted),z=F(()=>te.value.map(r=>({title:r.nickname,value:{id:r.id,name:r.nickname}}))),E=r=>{r==="Yes"?x.value=!0:x.value=!1},j=async()=>{if(v.value===""){u.value="Please select a mentor";return}else if(k.value===""){u.value="Please select accepted";return}else if(d.value===0){u.value="Please select a rating";return}else if(p.value===""){u.value="Please write a review";return}else{const r={admin_teacher_id:v.value.id,accepted:k.value=="Yes"?1:0,rate:d.value,review:p.value};console.log("Rating submitted:",r);try{const e=await se(`/public/update-task-accepted/${t.taskId}`,{method:"POST",body:r,onResponseError({err:_}){u.value=_}});console.log("Rating response:",e),d.value=e.data.rate,p.value=e.data.review}catch(e){console.error("Error submitting rating:",e)}V.value=!1}},B=()=>{(window.scrollY||document.documentElement.scrollTop)>100&&(V.value=!1)};H(()=>{ae(),window.addEventListener("scroll",B)}),J(()=>{window.removeEventListener("scroll",B)});const D=[{prependAvatar:N,title:"Brunch this weekend?",subtitle:`<span class="text-primary">Ali Connors</span> &mdash; I'll be in your neighborhood doing errands this weekend. Do you want to hang out?`},{type:"divider",inset:!0},{prependAvatar:N,title:"Summer BBQ",subtitle:`<span class="text-primary">to Alex, Scott, Jennifer</span> &mdash; Wish I could come, but I'm out of town this weekend.`},{type:"divider",inset:!0}];return(r,e)=>{const _=W("RouterLink"),T=X,Y=K;return i(),m(de,{class:"posting-card mb-4"},{default:l(()=>[a(le,null,{default:l(()=>[a(M,null,{default:l(()=>[a(y,{cols:"12",md:"8"},{default:l(()=>[t.media=="Google Drive"?(i(),m(Z,{key:0,"post-id":t.postId},null,8,["post-id"])):g("",!0),t.media=="Instagram"?(i(),m(ee,{key:1,"post-id":t.postId},null,8,["post-id"])):g("",!0)]),_:1}),a(y,{cols:"12",md:"4"},{default:l(()=>[o("div",null,[o("div",me,[o("div",ce,[(i(!0),S(G,null,Q(t.students.slice(0,3),s=>(i(),m($,{key:s.id,color:"info",size:"34"},{default:l(()=>[a(I,{src:("takePic"in r?r.takePic:n(O))(s.image),cover:""},null,8,["src"]),a(oe,{location:"top",activator:"parent"},{default:l(()=>[b(c(s.nickname),1)]),_:2},1024)]),_:2},1024))),128)),t.students.length>3?(i(),m($,{key:0,color:"secondary",size:"34"},{default:l(()=>[o("span",ue,"+"+c(t.students.length-3),1)]),_:1})):g("",!0)]),a(_,{to:`/?search=${("abbreviateName"in r?r.abbreviateName:n(w))(t.students[0].nickname,10,1).toLowerCase()}`,class:"d-flex flex-column"},{default:l(()=>[o("h6",pe,c(("abbreviateName"in r?r.abbreviateName:n(w))(t.students[0].name,30,3)),1),o("span",fe,c(t.students.length>1?`And ${t.students.length-1} others`:t.students[0].email||t.students[0].nickname),1)]),_:1},8,["to"])]),e[11]||(e[11]=o("hr",{class:"my-custom-line"},null,-1)),a(_,{to:`/?search=${("abbreviateName"in r?r.abbreviateName:n(w))(t.theme,30,4).toLowerCase()}`,class:"d-flex flex-column"},{default:l(()=>[o("p",ve,c(t.subject+": "+t.theme),1)]),_:1},8,["to"]),o("p",_e,[a(_,{to:`/?search=${P.taskId}`,class:"text-primary"},{default:l(()=>[b(c(t.taskName.split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")),1)]),_:1},8,["to"]),b(" "+c(t.description),1)]),o("div",ge,[a($,{size:"34",variant:"tonal",class:"me-3",color:t.accepted?"primary":"warning"},{default:l(()=>[t.teacherImg?(i(),m(I,{key:0,src:`/storage/${t.teacherImg}`,cover:""},null,8,["src"])):(i(),m(I,{key:1,src:n(N)},null,8,["src"]))]),_:1},8,["color"]),o("div",be,[o("div",he,[o("h6",ye,c(n(v).name),1)]),o("div",Ve,[n(L)&&n(L).role>1?(i(),S("div",{key:0,class:"d-flex flex-column",onClick:e[1]||(e[1]=s=>V.value=!0)},[a(A,{modelValue:n(d),"onUpdate:modelValue":e[0]||(e[0]=s=>h(d)?d.value=s:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])])):(i(),m(_,{key:1,to:"/front/bookmark",class:"d-flex flex-column"},{default:l(()=>[a(A,{modelValue:n(d),"onUpdate:modelValue":e[2]||(e[2]=s=>h(d)?d.value=s:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])]),_:1}))])])]),o("p",ke,c(n(p)),1),e[12]||(e[12]=o("hr",{class:"my-custom-line"},null,-1)),o("div",xe,[o("div",we,[a(C,{icon:"tabler-message-2"}),a(C,{icon:"tabler-heart",class:"ms-2"})]),a(C,{icon:"tabler-bookmark-filled",class:"text-primary"})]),n(V)?(i(),S("div",Se,[o("div",Ce,[n(u)?(i(),m(ne,{key:0,type:"error",class:"mb-5",dismissible:"",onClick:e[3]||(e[3]=s=>u.value="")},{default:l(()=>[b(c(n(u)),1)]),_:1})):g("",!0),a(re,{onSubmit:q(s=>({}),["prevent"])},{default:l(()=>[a(M,null,{default:l(()=>[a(y,{cols:"12"},{default:l(()=>[a(T,{modelValue:n(v),"onUpdate:modelValue":e[4]||(e[4]=s=>h(v)?v.value=s:null),label:"Mentor",placeholder:"Select Mentor",items:n(z),"item-title":"value.name","item-value":"value"},null,8,["modelValue","items"])]),_:1}),a(y,{cols:"12"},{default:l(()=>[a(T,{modelValue:n(k),"onUpdate:modelValue":[e[5]||(e[5]=s=>h(k)?k.value=s:null),E],label:"Accepted",placeholder:"Not Accepted",items:["Yes","No"]},null,8,["modelValue"])]),_:1}),n(x)?(i(),m(y,{key:0,cols:"12",class:"text-center"},{default:l(()=>[a(A,{modelValue:n(d),"onUpdate:modelValue":e[6]||(e[6]=s=>h(d)?d.value=s:null),"half-increments":"",hover:""},null,8,["modelValue"]),a(Y,{modelValue:n(p),"onUpdate:modelValue":e[7]||(e[7]=s=>h(p)?p.value=s:null),placeholder:"Write your review...",rows:3},null,8,["modelValue"])]),_:1})):g("",!0),a(y,{cols:"12",class:"mt-4"},{default:l(()=>[a(U,{type:"submit",class:"me-2",onClick:j},{default:l(()=>e[9]||(e[9]=[b(" Save ")])),_:1}),a(U,{color:"secondary",class:"me-2",onClick:e[8]||(e[8]=s=>V.value=!1)},{default:l(()=>e[10]||(e[10]=[b(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})])])):g("",!0),o("div",Ne,[a(ie,{lines:"three",items:D,"item-props":""},{subtitle:l(({subtitle:s})=>[o("div",{innerHTML:s},null,8,$e)]),_:1})])])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Qe as _};
