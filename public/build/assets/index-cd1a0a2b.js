import{_ as k}from"./AppTextField-b5461782.js";import{_ as le}from"./AppSelect-f110362d.js";import{u as re}from"./helpers-c88007fe.js";import{u as N}from"./useApi-c1588dfc.js";import{r as O}from"./validators-f974c252.js";import{b5 as se,a6 as P,r as p,bm as be,w as oe,o as q,f as M,e as a,b as o,n as e,aV as g,a$ as ge,d as v,aj as $,v as _,x,z as L,aZ as _e,_ as ye,a as De,c as Ce,a1 as Y,s as te}from"./main-4585feec.js";import{_ as we}from"./AppTextarea-a2a2d4ad.js";import{_ as xe}from"./AppDrawerHeaderSection-09cffbd4.js";import{P as he}from"./vue3-perfect-scrollbar.esm-f8245ed7.js";import{V as J}from"./VDivider-e2924383.js";import{V as ie}from"./VCard-a267c840.js";import{V as ne}from"./VCardText-dd0c7bc9.js";import{V as ke}from"./VForm-ee9cccf5.js";import{V as ue,a as c}from"./VRow-53fd1544.js";import{V as Ue}from"./VNavigationDrawer-6615bdb7.js";import{p as Ae}from"./paginationMeta-4ad053a4.js";import{c as Se}from"./createUrl-1a4f9f75.js";import{V as je}from"./VAlert-83fb7352.js";import{V as Oe}from"./VSpacer-52196579.js";import{V as Pe}from"./VDataTableServer-73173b80.js";import{V as qe}from"./VAvatar-fa9fec94.js";import{V as $e}from"./VMenu-dc1c4301.js";import{V as Te,a as ae}from"./VList-4b4f9347.js";import{V as Be}from"./VPagination-f3dedd03.js";import"./form-075a7c7b.js";import"./VTextField-d2aea9dd.js";/* empty css                   */import"./VCounter-2f9e53e6.js";import"./VImg-02cfc59c.js";import"./VField-3decac3d.js";import"./easing-9f15041e.js";import"./VInput-3fb3d6fe.js";import"./forwardRefs-8348545e.js";import"./VSelect-e95c30a5.js";import"./dialog-transition-a9ebe0dc.js";import"./VOverlay-27dbbcf8.js";import"./lazy-3e6a3ff5.js";import"./scopeId-326ce56f.js";import"./VCheckboxBtn-42d04193.js";import"./VSelectionControl-272cc15c.js";import"./VChip-aabda9ce.js";import"./no-profile-4221a4a6.js";import"./ssrBoot-7fdf6b89.js";import"./index-9c720871.js";import"./VDataTable-85865fe4.js";import"./VTable-7e1650ac.js";import"./filter-bef9984d.js";const Ne={class:"d-flex justify-start"},Me={__name:"AddCourses",props:{isDrawerOpen:{type:Boolean,required:!0},mode:{type:String,default:"add"},courseData:{type:Object,default:()=>({})}},emits:["update:isDrawerOpen","courseData"],async setup(Z,{emit:U}){let h,W;const i=Z,V=U,A=([h,W]=se(()=>N("/subjects")),h=await h,W(),h),T=P(()=>{var s;return[...new Set((s=A==null?void 0:A.data.value.data)==null?void 0:s.map(d=>d.group))].map(d=>({value:d,label:d}))});console.log("subjectsData",T);const{hasRoleAndAccess:w}=re(),C=p(),y=p(!1),n=be({name:"",subject:"",note:"",author:"",title:"",section:"",description:"",video_url:"",video_duration:""});oe(()=>[i.courseData,i.mode],()=>{(i.mode==="edit"||i.mode==="duplicate")&&i.courseData?Object.assign(n,{name:i.courseData.name||"",subject:i.courseData.subject||"",note:i.courseData.note||"",author:i.courseData.author||"",title:i.courseData.title||"",section:i.courseData.section||"",description:i.courseData.description||"",video_url:i.courseData.video_url||"",video_duration:i.courseData.video_duration||""}):Object.assign(n,{name:"",subject:"",note:"",author:"",title:"",section:"",description:"",video_url:"",video_duration:""})},{immediate:!0}),oe(()=>i.isDrawerOpen,u=>{var s,d;u||((s=C.value)==null||s.reset(),(d=C.value)==null||d.resetValidation())});const S=u=>{V("update:isDrawerOpen",u)},E=()=>{var u;V("update:isDrawerOpen",!1),(u=C.value)==null||u.reset()},H=()=>{var u;(u=C.value)==null||u.validate().then(({valid:s})=>{if(!s)return;const d={...n};i.mode==="edit"?(d.id=i.courseData.id,V("courseData",{action:"update",data:d})):V("courseData",{action:"create",data:d}),V("update:isDrawerOpen",!1),_e(E)})};return(u,s)=>{const d=xe,f=le,B=we;return q(),M(Ue,{"model-value":i.isDrawerOpen,temporary:"",location:"end",width:"370",class:"category-navigation-drawer scrollable-content","onUpdate:modelValue":S},{default:a(()=>[o(d,{title:i.mode==="edit"?"Edit Courses":i.mode==="duplicate"?"Duplicate Courses":"Add New Courses",onCancel:s[0]||(s[0]=m=>u.$emit("update:isDrawerOpen",!1))},null,8,["title"]),o(J),o(e(he),{options:{wheelPropagation:!1}},{default:a(()=>[o(ie,{flat:""},{default:a(()=>[o(ne,null,{default:a(()=>[o(e(ke),{ref_key:"refVForm",ref:C,modelValue:e(y),"onUpdate:modelValue":s[10]||(s[10]=m=>g(y)?y.value=m:null),onSubmit:ge(H,["prevent"])},{default:a(()=>[o(ue,null,{default:a(()=>[o(c,{cols:"12"},{default:a(()=>[o(k,{modelValue:e(n).name,"onUpdate:modelValue":s[1]||(s[1]=m=>e(n).name=m),label:"Name",placeholder:"Enter course name"},null,8,["modelValue"])]),_:1}),o(c,{cols:"12"},{default:a(()=>[o(f,{modelValue:e(n).subject,"onUpdate:modelValue":s[2]||(s[2]=m=>e(n).subject=m),label:"Subject",rules:["requiredValidator"in u?u.requiredValidator:e(O)],items:e(T),"item-title":"label","item-value":"value",placeholder:"Choose Project Subject"},null,8,["modelValue","rules","items"])]),_:1}),o(c,{cols:"12"},{default:a(()=>[o(k,{modelValue:e(n).note,"onUpdate:modelValue":s[3]||(s[3]=m=>e(n).note=m),label:"Write Note",rules:["requiredValidator"in u?u.requiredValidator:e(O)],placeholder:"Courses Note"},null,8,["modelValue","rules"])]),_:1}),o(c,{cols:"12"},{default:a(()=>[o(k,{modelValue:e(n).author,"onUpdate:modelValue":s[4]||(s[4]=m=>e(n).author=m),label:"Write Author",rules:["requiredValidator"in u?u.requiredValidator:e(O)],placeholder:"Courses Author"},null,8,["modelValue","rules"])]),_:1}),o(c,{cols:"12"},{default:a(()=>[o(k,{modelValue:e(n).section,"onUpdate:modelValue":s[5]||(s[5]=m=>e(n).section=m),label:"Write Section",rules:["requiredValidator"in u?u.requiredValidator:e(O)],placeholder:"Courses Section"},null,8,["modelValue","rules"])]),_:1}),o(c,{cols:"12"},{default:a(()=>[o(k,{modelValue:e(n).title,"onUpdate:modelValue":s[6]||(s[6]=m=>e(n).title=m),label:"Write Title",rules:["requiredValidator"in u?u.requiredValidator:e(O)],placeholder:"Courses Title"},null,8,["modelValue","rules"])]),_:1}),o(c,{cols:"12"},{default:a(()=>[o(B,{modelValue:e(n).description,"onUpdate:modelValue":s[7]||(s[7]=m=>e(n).description=m),label:"Description",placeholder:"Write Description","auto-grow":""},null,8,["modelValue"])]),_:1}),o(c,{cols:"12"},{default:a(()=>[o(B,{modelValue:e(n).video_url,"onUpdate:modelValue":s[8]||(s[8]=m=>e(n).video_url=m),label:"Video URL",placeholder:"Write Video URL","auto-grow":""},null,8,["modelValue"])]),_:1}),o(c,{cols:"12"},{default:a(()=>[o(k,{modelValue:e(n).video_duration,"onUpdate:modelValue":s[9]||(s[9]=m=>e(n).video_duration=m),label:"Write Video Duration",rules:["requiredValidator"in u?u.requiredValidator:e(O)],placeholder:"Courses Video Duration"},null,8,["modelValue","rules"])]),_:1}),e(w)(2,"Courses")?(q(),M(c,{key:0,cols:"12"},{default:a(()=>[v("div",Ne,[o($,{type:"submit",color:"primary",class:"me-4"},{default:a(()=>[_(x(i.mode==="edit"?"Update":"Add"),1)]),_:1}),o($,{color:"error",variant:"tonal",onClick:E},{default:a(()=>s[11]||(s[11]=[_(" Discard ")])),_:1})])]),_:1})):L("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const We={class:"d-flex flex-wrap gap-4 mx-5"},Ee={class:"d-flex align-center"},Fe={class:"d-flex gap-4 flex-wrap align-center"},Re={class:"d-flex align-center gap-x-2"},ze={class:"d-flex flex-column"},Ge={class:"text-body-1 font-weight-medium"},Ie={class:"text-sm text-disabled"},Le={class:"text-primary"},Je={class:"text-body-1 font-weight-medium"},He={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},Qe={class:"text-sm text-medium-emphasis mb-0"},Ye={__name:"index",async setup(Z){let U,h;const{hasRole:W,hasRoleAndAccess:i}=re(),V=p(!1),A=p(""),T=p("primary"),w=(r,t="primary")=>{A.value=r,T.value=t,V.value=!0,setTimeout(()=>{V.value=!1},1e4)},C=N("/courses"),y=p(""),n=p(""),S=p(""),E=P(()=>[...new Set(C.data.value.data.map(r=>r.subject))].sort()),H=P(()=>[...new Set(C.data.value.data.filter(r=>!y.value||r.subject===y.value).map(r=>r.name))].sort()),u=P(()=>[...new Set(C.data.value.data.filter(r=>!n.value||r.name===n.value).map(r=>r.section))].sort()),s=p(""),d=p(1),f=p(10),B=p(),m=p(),de=r=>{var t,D;d.value=r.page,B.value=(t=r.sortBy[0])==null?void 0:t.key,m.value=(D=r.sortBy[0])==null?void 0:D.order},{data:Q,execute:K}=([U,h]=se(()=>N(Se("/courses-custom",{query:{q:()=>s.value,page:()=>d.value,itemsPerPage:()=>f.value,subject:()=>y.value,name:()=>n.value,section:()=>S.value,sortBy:B.value||"",orderBy:m.value||""}}))),U=await U,h(),U);console.log("coursesData:",Q);const me=P(()=>Q.value.data),F=P(()=>Q.value.count),j=p(!1),R=p("add"),z=p({}),pe=r=>{z.value={...r},R.value="edit",j.value=!0},ce=r=>{z.value={...r},R.value="duplicate",j.value=!0},fe=[{title:"Course",key:"title"},{title:"Subject",key:"subject"},{title:"Author",key:"author"},{title:"Actions",key:"actions",sortable:!1}],X=r=>r==="Tahfidzh"?{color:"success",icon:"tabler-book-2"}:r==="Graphic Design"?{color:"primary",icon:"tabler-brand-adobe-illustrator"}:r==="Video Editing"?{color:"primary",icon:"tabler-brand-adobe-premier"}:r==="Python Programming"?{color:"info",icon:"tabler-brand-python"}:r==="JavaScript Programming"?{color:"info",icon:"tabler-brand-react"}:r==="Web Development"?{color:"info",icon:"tabler-device-imac"}:r==="Mobile Development"?{color:"info",icon:"tabler-device-mobile"}:r==="Google Workspace"?{color:"warning",icon:"tabler-brand-google"}:r==="Game Development"?{color:"info",icon:"tabler-device-gamepad-2"}:{color:"secondary",icon:"tabler-world"},ve=async({action:r,data:t})=>{var G;if(!i(2,"Courses").value){w("You do not have permission to modify plans","error");return}const D={...t};console.log("Sending CourseData:",D,"action:",r);try{let b="/courses",l="POST";r==="update"&&t.id&&(b=`/courses/${t.id}`,l="PUT");const{data:I,response:ee}=await N(b,{method:l,body:JSON.stringify(D),headers:{"Content-Type":"application/json",Accept:"application/json"}});ee.value.ok?(w(r==="create"?"Data berhasil ditambahkan":"Data berhasil diperbarui","success"),console.log("Course response:",I),K()):w(ee.value.statusText||"Gagal menyimpan data","error")}catch(b){console.error("Course save error:",((G=b==null?void 0:b.data)==null?void 0:G.errors)||b),w(b.message||"Gagal menyimpan data","error")}},Ve=async r=>{try{confirm("Apakah kamu yakin ingin menghapus data ini?")&&(console.log("Deleting Course with ID:",r),await N(`/courses/${r}`,{method:"DELETE"}),w("Data berhasil dihapus","success"),K())}catch(t){w(t.message||"Gagal menghapus data","error"),console.error(t)}};return(r,t)=>{const D=le,G=k,b=De("IconBtn");return q(),Ce("div",null,[o(je,{modelValue:e(V),"onUpdate:modelValue":t[0]||(t[0]=l=>g(V)?V.value=l:null),closable:"","close-label":"Close Alert",class:"mb-6",color:e(T)},{default:a(()=>[_(x(e(A)),1)]),_:1},8,["modelValue","color"]),o(ie,{title:"Filters",class:"mb-6"},{default:a(()=>[o(ne,null,{default:a(()=>[o(ue,null,{default:a(()=>[o(c,{cols:"12",sm:"4"},{default:a(()=>[o(D,{modelValue:e(y),"onUpdate:modelValue":t[1]||(t[1]=l=>g(y)?y.value=l:null),placeholder:"Subject",items:e(E),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),o(c,{cols:"12",sm:"4"},{default:a(()=>[o(D,{modelValue:e(n),"onUpdate:modelValue":t[2]||(t[2]=l=>g(n)?n.value=l:null),placeholder:"Name",items:e(H),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),o(c,{cols:"12",sm:"4"},{default:a(()=>[o(D,{modelValue:e(S),"onUpdate:modelValue":t[3]||(t[3]=l=>g(S)?S.value=l:null),placeholder:"Section",items:e(u),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),o(J,{class:"my-4"}),v("div",We,[v("div",Ee,[o(G,{modelValue:e(s),"onUpdate:modelValue":t[4]||(t[4]=l=>g(s)?s.value=l:null),placeholder:"Search Course",density:"compact",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),o(Oe),v("div",Fe,[o(D,{modelValue:e(f),"onUpdate:modelValue":t[5]||(t[5]=l=>g(f)?f.value=l:null),items:[5,10,20,25,50]},null,8,["modelValue"]),o($,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload"},{default:a(()=>t[11]||(t[11]=[_(" Export ")])),_:1}),e(i)(2,"Courses").value?(q(),M($,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:t[6]||(t[6]=()=>{R.value="add",z.value={},j.value=!0})},{default:a(()=>t[12]||(t[12]=[_(" Add Course ")])),_:1})):L("",!0)])]),o(J,{class:"mt-4"}),o(e(Pe),{"items-per-page":e(f),"onUpdate:itemsPerPage":t[8]||(t[8]=l=>g(f)?f.value=l:null),page:e(d),"onUpdate:page":t[9]||(t[9]=l=>g(d)?d.value=l:null),headers:fe,"show-select":"",items:e(me),"items-length":e(F),class:"text-no-wrap","onUpdate:options":de},{"item.title":a(({item:l})=>[v("div",Re,[v("div",ze,[v("span",Ge,x(l.title),1),v("span",Ie,[v("span",Le,x(l.name)+" : ",1),_(" "+x(l.section),1)])])])]),"item.subject":a(({item:l})=>[o(qe,{size:"30",variant:"tonal",color:X(l.subject).color,class:"me-2"},{default:a(()=>[o(Y,{icon:X(l.subject).icon,size:"18"},null,8,["icon"])]),_:2},1032,["color"]),v("span",Je,x(l.subject),1)]),"item.author":a(({item:l})=>[_(x(l.author),1)]),"item.actions":a(({item:l})=>[o(b,{disabled:!e(i)(3,"Courses").value,color:e(i)(3,"Courses").value?"primary":"secondary",onClick:I=>pe(l)},{default:a(()=>[o(Y,{icon:"tabler-edit"})]),_:2},1032,["disabled","color","onClick"]),o(b,{disabled:!e(i)(2,"Courses").value},{default:a(()=>[o(Y,{icon:"tabler-dots-vertical"}),o($e,{activator:"parent"},{default:a(()=>[o(Te,null,{default:a(()=>[e(W)(4).value?(q(),M(ae,{key:0,value:"delete","prepend-icon":"tabler-trash",onClick:I=>Ve(l.id)},{default:a(()=>t[13]||(t[13]=[_(" Delete ")])),_:2},1032,["onClick"])):L("",!0),e(i)(2,"Courses").value?(q(),M(ae,{key:1,value:"duplicate","prepend-icon":"tabler-copy",onClick:I=>ce(l)},{default:a(()=>t[14]||(t[14]=[_(" Duplicate ")])),_:2},1032,["onClick"])):L("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["disabled"])]),bottom:a(()=>[o(J),v("div",He,[v("p",Qe,x(e(Ae)({page:e(d),itemsPerPage:e(f)},e(F))),1),o(Be,{modelValue:e(d),"onUpdate:modelValue":t[7]||(t[7]=l=>g(d)?d.value=l:null),length:Math.min(Math.ceil(e(F)/e(f)),5),"total-visible":r.$vuetify.display.xs?1:Math.min(Math.ceil(e(F)/e(f)),5)},{prev:a(l=>[o($,te({variant:"tonal",color:"default"},l,{icon:!1}),{default:a(()=>t[15]||(t[15]=[_(" Previous ")])),_:2},1040)]),next:a(l=>[o($,te({variant:"tonal",color:"default"},l,{icon:!1}),{default:a(()=>t[16]||(t[16]=[_(" Next ")])),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),o(Me,{"is-drawer-open":e(j),"onUpdate:isDrawerOpen":t[10]||(t[10]=l=>g(j)?j.value=l:null),mode:e(R),"course-data":e(z),onCourseData:ve},null,8,["is-drawer-open","mode","course-data"])])}}},Lo=ye(Ye,[["__scopeId","data-v-7c8bf578"]]);export{Lo as default};
