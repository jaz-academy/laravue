import{r as m,a5 as K,H as Q,b6 as G,a as X,o as n,f,e as l,b as a,z as k,d as s,c as h,F as J,i as W,n as i,v as C,x as v,aU as $,a0 as N,a$ as Z,ai as z,j as ee,k as te,w as se,aY as ae,b7 as oe,K as re,b8 as le,b9 as ne}from"./main-d9f3424d.js";import{u as ie}from"./useApi-608e4ca2.js";import{N as ce,F as de}from"./front-page-navbar-c4df63d9.js";import{H as me}from"./hero-section-41d2e028.js";import{_ as ue}from"./AppTextarea-98ba9d94.js";import{_ as pe}from"./AppSelect-b4c02f4e.js";import{c as U}from"./formatters-5eff6250.js";import{t as ve}from"./helpers-ddaee727.js";import{a as P}from"./no-profile-4221a4a6.js";import{_ as fe}from"./GDriveEmbed-eea2fc08.js";import{_ as _e}from"./InstagramEmbed-8eee1297.js";import{t as he,f as ye}from"./fetchTeacherData-ecf8059e.js";import{$ as ge}from"./api-04218d05.js";import{V as xe}from"./VCardText-cf9fd2ab.js";import{V as F}from"./VRow-da5b93ce.js";import{V as S}from"./VCol-ac94f502.js";import{V as B}from"./VAvatar-277a8b10.js";import{V as D}from"./VImg-f55b59e7.js";import{V as be}from"./VTooltip-e707efd6.js";import{V as H}from"./VRating-453f5ab3.js";import{V as ke}from"./VAlert-96b18c99.js";import{V as we}from"./VForm-ce8bb408.js";import{V as Ve}from"./VList-c368e352.js";import{V as $e}from"./VCard-afaa5d27.js";import"./AppTextField-760889a8.js";import"./form-26233cc1.js";import"./VTextField-0356918e.js";/* empty css                   */import"./VCounter-17d4f7ca.js";import"./VField-9bf8b145.js";import"./easing-9f15041e.js";import"./VInput-ca1cb71d.js";import"./forwardRefs-8348545e.js";import"./VNodeRenderer-2847b45b.js";import"./useGenerateImageVariant-b9751093.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VChip-b6bedac6.js";import"./VContainer-e4484dd0.js";import"./NavbarThemeSwitcher-9a819698.js";import"./VMenu-b53d0f28.js";import"./VOverlay-6cf31c8f.js";import"./lazy-3da88233.js";import"./scopeId-c2687b41.js";import"./dialog-transition-93f1260e.js";import"./VNavigationDrawer-660379e0.js";import"./ssrBoot-51c609c5.js";import"./VToolbar-9e604112.js";import"./VSpacer-59f07017.js";import"./hero-elements-light-b61b0468.js";/* empty css                 */import"./VSelect-1d333a1c.js";import"./VCheckboxBtn-bb1e1fec.js";import"./VSelectionControl-28f4217c.js";import"./index-8d9cdf1e.js";import"./index-9c720871.js";import"./VDivider-f6620f51.js";const Se={class:"d-flex justify-space-between align-center mb-2"},Ie={class:"d-flex align-center"},Ce={class:"v-avatar-group me-2"},Ne={class:"text-xs"},Ae={class:"text-base text-primary"},Te={class:"text-sm text-medium-emphasis"},je={class:"d-flex flex-column text-end"},Re={class:"text-sm text-primary"},Me=["href"],Le={class:"text-body-1 text-primary"},Ue={class:"text-body-2 d-inline"},Pe=["href"],Be=["href"],De={class:"d-flex align-center mt-4"},He={class:"d-flex flex-column"},ze={class:"font-weight-medium text-link ps-1"},qe={class:"text-base text-primary ms-1"},Ee={class:"text-sm text-medium-emphasis cursor-pointer"},Oe={class:"text-body-2 mt-2"},Ye={class:"d-flex justify-space-between my-4 flex-wrap action-icons"},Fe={class:""},Ke={key:0,class:"modal-overlay"},Qe={class:"modal-content"},Je={class:"flex-grow-1 overflow-auto d-none",style:{"max-block-size":"100%"}},We=["innerHTML"],Ge={__name:"HomeCard",props:{taskId:Number,taskName:String,description:String,subject:String,theme:String,stars:String,media:String,postId:String,students:Array,teacher:Object,review:String,teacherImg:String,accepted:Number,link:String,date:String},setup(R){const e=R,A=localStorage.getItem("participant"),g=A?JSON.parse(A):null,x=m(!1),p=m(""),_=m(e.teacher),w=m(e.accepted?"Yes":"No"),y=m(e.review),c=m(e.stars),b=m(!!e.accepted),M=K(()=>he.value.map(u=>({title:u.nickname,value:{id:u.id,name:u.nickname}}))),L=u=>{u==="Yes"?b.value=!0:b.value=!1},V=async()=>{if(_.value===""){p.value="Please select a mentor";return}else if(w.value===""){p.value="Please select accepted";return}else if(c.value===0){p.value="Please select a rating";return}else if(y.value===""){p.value="Please write a review";return}else{const u={admin_teacher_id:_.value.id,accepted:w.value=="Yes"?1:0,rate:c.value,review:y.value};console.log("Rating submitted:",u);try{const t=await ge(`/public/update-task-accepted/${e.taskId}`,{method:"POST",body:u,onResponseError({err:d}){p.value=d}});console.log("Rating response:",t),c.value=t.data.rate,y.value=t.data.review}catch(t){console.error("Error submitting rating:",t)}x.value=!1}},T=()=>{(window.scrollY||document.documentElement.scrollTop)>100&&(x.value=!1)};Q(()=>{ye(),window.addEventListener("scroll",T)}),G(()=>{window.removeEventListener("scroll",T)});const I=[{prependAvatar:P,title:"Brunch this weekend?",subtitle:`<span class="text-primary">Ali Connors</span> &mdash; I'll be in your neighborhood doing errands this weekend. Do you want to hang out?`},{type:"divider",inset:!0},{prependAvatar:P,title:"Summer BBQ",subtitle:`<span class="text-primary">to Alex, Scott, Jennifer</span> &mdash; Wish I could come, but I'm out of town this weekend.`},{type:"divider",inset:!0}];return(u,t)=>{const d=X("RouterLink"),o=pe,j=ue;return n(),f($e,{class:"posting-card"},{default:l(()=>[a(xe,null,{default:l(()=>[a(F,null,{default:l(()=>[a(S,{cols:"12",md:"7"},{default:l(()=>[e.media=="Google Drive"?(n(),f(fe,{key:0,"post-id":e.postId},null,8,["post-id"])):k("",!0),e.media=="Instagram"?(n(),f(_e,{key:1,"post-id":e.postId},null,8,["post-id"])):k("",!0)]),_:1}),a(S,{cols:"12",md:"5"},{default:l(()=>[s("div",null,[s("div",Se,[s("div",Ie,[s("div",Ce,[(n(!0),h(J,null,W(e.students.slice(0,3),r=>(n(),f(B,{key:r.id,color:"info",size:"34"},{default:l(()=>[a(D,{src:i(ve)(r.image),cover:""},null,8,["src"]),a(be,{location:"top",activator:"parent"},{default:l(()=>[C(v(r.nickname),1)]),_:2},1024)]),_:2},1024))),128)),e.students.length>3?(n(),f(B,{key:0,color:"secondary",size:"34"},{default:l(()=>[s("span",Ne,"+"+v(e.students.length-3),1)]),_:1})):k("",!0)]),a(d,{to:`/?search=${i(U)(e.students[0].nickname,10,1).toLowerCase()}`,class:"d-flex flex-column"},{default:l(()=>[s("h6",Ae,v(i(U)(e.students[0].name,30,3)),1),s("span",Te,v(e.students.length>1?`And ${e.students.length-1} others`:e.students[0].email||e.students[0].nickname),1)]),_:1},8,["to"])]),s("div",je,[s("small",Re,v(new Date(e.date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})),1),s("a",{href:`/?search=${e.taskId}`,class:"text-sm text-medium-emphasis"},v(e.taskId),9,Me)])]),t[11]||(t[11]=s("hr",{class:"my-custom-line"},null,-1)),a(d,{to:`/?search=${i(U)(e.theme,30,4).toLowerCase()}`,class:"d-flex flex-column"},{default:l(()=>[s("p",Le,v(e.subject+": "+e.theme),1)]),_:1},8,["to"]),s("p",Ue,[s("a",{href:e.link?e.link:`/?search=${e.taskId}`,class:"text-primary",target:"_blank",rel:"noopener noreferrer"},v(e.taskName.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")),9,Pe),s("a",{href:R.link,target:"_blank",rel:"noopener noreferrer",class:"text-secondary"},v(" "+e.description),9,Be)]),s("div",De,[a(B,{size:"34",variant:"tonal",class:"me-3",color:e.accepted?"primary":"warning"},{default:l(()=>[e.teacherImg?(n(),f(D,{key:0,src:`/storage/${e.teacherImg}`,cover:""},null,8,["src"])):(n(),f(D,{key:1,src:i(P)},null,8,["src"]))]),_:1},8,["color"]),s("div",He,[s("div",ze,[s("h6",qe,v(i(_).name),1)]),s("div",Ee,[i(g)&&i(g).role>1?(n(),h("div",{key:0,class:"d-flex flex-column",onClick:t[1]||(t[1]=r=>x.value=!0)},[a(H,{modelValue:i(c),"onUpdate:modelValue":t[0]||(t[0]=r=>$(c)?c.value=r:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])])):(n(),f(d,{key:1,to:"/front/bookmark",class:"d-flex flex-column"},{default:l(()=>[a(H,{modelValue:i(c),"onUpdate:modelValue":t[2]||(t[2]=r=>$(c)?c.value=r:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])]),_:1}))])])]),s("p",Oe,v(i(y)),1),t[12]||(t[12]=s("hr",{class:"my-custom-line"},null,-1)),s("div",Ye,[s("div",Fe,[a(N,{icon:"tabler-heart"}),a(N,{icon:"tabler-message-2",class:"ms-2"})]),a(N,{icon:"tabler-bookmark"})]),i(x)?(n(),h("div",Ke,[s("div",Qe,[i(p)?(n(),f(ke,{key:0,type:"error",class:"mb-5",dismissible:"",onClick:t[3]||(t[3]=r=>p.value="")},{default:l(()=>[C(v(i(p)),1)]),_:1})):k("",!0),a(we,{onSubmit:Z(r=>({}),["prevent"])},{default:l(()=>[a(F,null,{default:l(()=>[a(S,{cols:"12"},{default:l(()=>[a(o,{modelValue:i(_),"onUpdate:modelValue":t[4]||(t[4]=r=>$(_)?_.value=r:null),label:"Mentor",placeholder:"Select Mentor",items:i(M),"item-title":"value.name","item-value":"value"},null,8,["modelValue","items"])]),_:1}),a(S,{cols:"12"},{default:l(()=>[a(o,{modelValue:i(w),"onUpdate:modelValue":[t[5]||(t[5]=r=>$(w)?w.value=r:null),L],label:"Accepted",placeholder:"Not Accepted",items:["Yes","No"]},null,8,["modelValue"])]),_:1}),i(b)?(n(),f(S,{key:0,cols:"12",class:"text-center"},{default:l(()=>[a(H,{modelValue:i(c),"onUpdate:modelValue":t[6]||(t[6]=r=>$(c)?c.value=r:null),"half-increments":"",hover:""},null,8,["modelValue"]),a(j,{modelValue:i(y),"onUpdate:modelValue":t[7]||(t[7]=r=>$(y)?y.value=r:null),placeholder:"Write your review...",rows:3},null,8,["modelValue"])]),_:1})):k("",!0),a(S,{cols:"12",class:"mt-4"},{default:l(()=>[a(z,{type:"submit",class:"me-2",onClick:V},{default:l(()=>t[9]||(t[9]=[C(" Save ")])),_:1}),a(z,{color:"secondary",class:"me-2",onClick:t[8]||(t[8]=r=>x.value=!1)},{default:l(()=>t[10]||(t[10]=[C(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})])])):k("",!0),s("div",Je,[a(Ve,{lines:"three",items:I,"item-props":""},{subtitle:l(({subtitle:r})=>[s("div",{innerHTML:r},null,8,We)]),_:1})])])]),_:1})]),_:1})]),_:1})]),_:1})}}};const Xe={class:"landing-page-wrapper"},Ze={key:1,class:"text-center sticky-header bg-background pb-8"},et={class:"input-group mt-16 justify-center",style:{display:"flex","align-items":"center",gap:"0.5rem"}},tt=["href"],st={key:2,class:"text-center my-16 py-2"},at={key:0,class:"flex justify-center items-center"},ot={key:1,class:"text-gray-400"},ns={__name:"index",setup(R){const e=ee(),A=te(),g=m(e.query.search||""),x=K(()=>Object.keys(e.query).length>0),p=m([]),_=m(1),w=m(3),y=m(e.query.search||""),c=m(!1),b=m(!0),M=m(null),L=m(null),V=m(null),T=()=>{A.push({query:{...e.query,search:g.value}})},I=async()=>{var o;if(c.value||!b.value)return;c.value=!0;const{data:t}=await ie(`/public/tasks?page=${_.value}&perPage=${w.value}&search=${y.value}&rates=5`),d=((o=t.value)==null?void 0:o.data)||[];d.length?(p.value.push(...d),_.value++):b.value=!1,c.value=!1};se(()=>e.query.search,async t=>{g.value=t||"",_.value=1,p.value=[],b.value=!0,await I(),console.log(p.value)});let u;return Q(async()=>{await I(),await ae(),V.value&&(u=new IntersectionObserver(t=>{t[0].isIntersecting&&I()}),u.observe(V.value))}),oe(()=>{u&&V.value&&u.unobserve(V.value)}),(t,d)=>(n(),h("div",Xe,[a(ce,{"active-id":M.value},null,8,["active-id"]),x.value?k("",!0):(n(),f(me,{key:0,ref:"refHome",class:"mb-16"},null,512)),x.value?(n(),h("div",Ze,[d[1]||(d[1]=s("br",null,null,-1)),d[2]||(d[2]=s("br",null,null,-1)),s("div",et,[re(s("input",{"onUpdate:modelValue":d[0]||(d[0]=o=>g.value=o),type:"text",placeholder:"Search by Id, Name, Mentor, Theme...",class:"border w-50 px-3 py-2 rounded",onKeyup:ne(T,["enter"])},null,544),[[le,g.value]]),s("a",{href:`?search=${encodeURIComponent(g.value)}`,class:"btn btn-primary"},[a(z,null,{default:l(()=>[a(N,{icon:"tabler-search"})]),_:1})],8,tt)])])):(n(),h("div",st," . ")),s("div",{id:"content-post",ref_key:"scrollContainer",ref:L},[(n(!0),h(J,null,W(p.value,o=>{var j,r,q,E,O,Y;return n(),h("div",{key:o.id},[a(Ge,{class:"card-post","task-id":o.id,"task-name":o.name,description:o.description,subject:o.project_plan.subject,theme:o.project_plan.theme,stars:o.rate,media:o.media,"post-id":o.media=="Instagram"?(r=(j=o.link)==null?void 0:j.match(/\/(?:p|reel)\/([\w-]+)/))==null?void 0:r[1]:((E=(q=o.link)==null?void 0:q.match(/\/d\/(.*?)\//))==null?void 0:E[1])||"N/A",students:o.students,mentor:((O=o.admin_teacher)==null?void 0:O.nickname)||"Not Accepted",review:(o==null?void 0:o.review)||null,teacher:o.admin_teacher?{id:o.admin_teacher.id,name:o.admin_teacher.nickname}:"Not Accepted","teacher-img":(Y=o.admin_teacher)==null?void 0:Y.image,accepted:o.accepted,link:o.link,date:o.date},null,8,["task-id","task-name","description","subject","theme","stars","media","post-id","students","mentor","review","teacher","teacher-img","accepted","link","date"])])}),128)),s("div",{ref_key:"loadMoreTrigger",ref:V,class:"py-4 text-center text-gray-400"},[c.value?(n(),h("div",at,[a(N,{icon:"mdi-loading",spin:"",class:"mr-2"}),d[3]||(d[3]=C(" Loading... "))])):b.value?k("",!0):(n(),h("div",ot," No more tasks. "))],512)],512),a(de)]))}};export{ns as default};
