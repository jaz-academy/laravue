import{u as j}from"./useApi-ee5b865a.js";import{_ as q}from"./MoreBtn-853b9164.js";import{a as L,V as O,b as Ve}from"./VCard-cba44afa.js";import{V as ke}from"./VDivider-5a8f189b.js";import{V as fe}from"./VTable-4dc70b45.js";import{V as G}from"./VAvatar-4667946e.js";import{a5 as F,o as u,f as w,e as t,b as e,d as o,c as S,F as T,i as M,x as f,a0 as B,y as H,v as I,aZ as _e,z as P,r as D,w as ve,ai as Y,s as we,n as i,aU as X,J as he,be as se,a$ as Ce,cE as De,cF as $e,$ as ge,H as be}from"./main-ee7c17de.js";import{V as ce}from"./VChip-7b4a1ec4.js";import{m as ye}from"./vue3-apexcharts-ff2b91bb.js";import{V as Se}from"./VMenu-6af39dc3.js";import{V as xe,a as Z,b as ne,c as Ne}from"./VList-dd2cb195.js";import{V as U}from"./VCardText-6be2f581.js";import{h as J,s as Ae}from"./helpers-10cbd28e.js";import{V as Fe,a as Ie}from"./VTabs-3fd85d13.js";import{V as ze,a as te}from"./VWindowItem-325a704a.js";import{V as ae,a as oe}from"./VTimelineItem-8032f9b2.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";import{r as ue}from"./validators-77ed87b6.js";import{_ as Te}from"./AppTextField-862a83a4.js";import{_ as Me}from"./DialogCloseBtn-7eb1753a.js";import{_ as de}from"./AppSelect-3e238d9d.js";import{V as Pe}from"./VForm-e8199224.js";import{V as re}from"./VRow-271260dd.js";import{V as A}from"./VCol-cfb71e73.js";import{V as Ee}from"./VDialog-d2710699.js";import{V as Oe}from"./VSnackbar-526ad49f.js";import"./VImg-d487f910.js";import"./VOverlay-9c9ed528.js";import"./easing-9f15041e.js";import"./lazy-ad9bbcd3.js";import"./scopeId-f06193c4.js";import"./forwardRefs-8348545e.js";import"./dialog-transition-9860be03.js";import"./ssrBoot-c8beb59b.js";import"./no-profile-4221a4a6.js";import"./VSlideGroup-3e509787.js";import"./form-baa91886.js";import"./VTextField-65dae01b.js";/* empty css                   */import"./VCounter-97a26890.js";import"./VField-2b6b59c0.js";import"./VInput-29651115.js";import"./VSelect-cea4b28e.js";import"./VCheckboxBtn-0cef0367.js";import"./VSelectionControl-fc422a63.js";const Be={class:"d-flex align-center"},Ue={class:"text-body-2 text-high-emphasis font-weight-medium"},We={class:"d-flex align-center gap-x-4",style:{"min-inline-size":"200px"}},Le={class:"w-100"},Re={class:"text-body-1 bg-var-theme-background"},je={class:"font-weight-medium"},Ye={__name:"AllocationTable",props:{data:{type:Array,default:()=>[]}},setup($){const d=$,r=[{title:"ACCOUNT",key:"description"},{title:"PAYMENT",key:"payment"},{title:"EXPENSES",key:"expense"},{title:"BALANCE",key:"balance"},{title:"REMAIN",key:"percentage"}],p=a=>typeof a!="number"?a:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),y=a=>a>0?"success":a<0?"error":"warning",v=a=>a>100?"error":a>90?"warning":"primary",h=F(()=>d.data.reduce((a,n)=>a+n.balance,0));return(a,n)=>{const c=q;return d.data.length?(u(),w(O,{key:0},{default:t(()=>[e(L,{title:"Allocation"},{append:t(()=>[e(c)]),_:1}),e(ke),e(fe,{class:"text-no-wrap"},{default:t(()=>[o("thead",null,[o("tr",null,[(u(),S(T,null,M(r,s=>o("th",{key:s.key,scope:"col",class:"text-uppercase"},f(s.title),1)),64))])]),o("tbody",null,[(u(!0),S(T,null,M(d.data,s=>(u(),S("tr",{key:s.allocation},[o("td",null,[o("div",Be,[e(G,{color:s.payment>0?"primary":"error",variant:"tonal",class:"me-2",size:"34"},{default:t(()=>[e(B,{icon:s.payment>0?"tabler-building-bank":"tabler-wallet",size:"22"},null,8,["icon"])]),_:2},1032,["color"]),o("span",Ue,f(s.allocation||"No Allocated"),1)])]),o("td",{class:H(Number(s.payment)<0?"text-error":"text-secondary")},f(p(Number(s.payment))),3),o("td",{class:H(Number(s.expense)<0?"text-success":"text-secondary")},f(p(Number(s.expense))),3),o("td",null,[e(ce,{color:y(s.balance),label:""},{default:t(()=>[I(f(p(s.balance)),1)]),_:2},1032,["color"])]),o("td",null,[o("div",We,[o("div",Le,[e(_e,{"model-value":s.remain,color:v(s.remain),height:10,rounded:""},null,8,["model-value","color"])]),n[0]||(n[0]=o("div",{class:"text-body-2"},null,-1))])])]))),128))]),o("tfoot",null,[o("tr",Re,[n[1]||(n[1]=o("th",{colspan:"2",scope:"row"},null,-1)),n[2]||(n[2]=o("th",{class:"font-weight-medium text-high-emphasis"}," Total Balance ",-1)),o("td",je,[e(ce,{color:y(h.value),label:""},{default:t(()=>[I(f(p(h.value)),1)]),_:1},8,["color"])]),n[3]||(n[3]=o("td",null,null,-1))])])]),_:1})]),_:1})):P("",!0)}}};const He="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",pe="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",qe="rgba(var(--v-border-color), var(--v-border-opacity))",Ke={__name:"ExpenseStatistics",props:{data:{type:Array,default:()=>[]}},emits:["year-selected"],setup($,{emit:d}){const r=$,p=d,y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],v=D("All");ve(v,_=>{p("yearSelected",_==="All"?"":_)});const h=F(()=>{const x=new Date().getFullYear(),k=[];for(let m=x;m>=2023;m--)k.push(m);return k}),a=F(()=>{const _=[],x=[],k=[];return r.data.forEach(m=>{const[l,g]=m.month.split("-");_.push(`${y[parseInt(g)-1]}-${l}`),_.push(`${y[parseInt(g)-1]}`),x.push(Number(m.official)),k.push(Number(m.non_official))}),{bulan:_,official:x,non_official:k}}),n={line:{series1:"#FFB400",series2:"#9055FD",series3:"#7367f029"}},c=F(()=>[{name:"Kitchen",type:"column",data:a.value.official},{name:"Household",type:"line",data:a.value.non_official}]),s=F(()=>({chart:{type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},markers:{size:5,colors:"#fff",strokeColors:n.line.series2,hover:{size:6},borderRadius:4},stroke:{curve:"smooth",width:[0,3],lineCap:"round"},legend:{show:!0,position:"bottom",markers:{width:8,height:8,offsetX:-3},height:40,itemMargin:{horizontal:10,vertical:0},fontSize:"15px",fontFamily:"Open Sans",fontWeight:400,labels:{colors:He,useSeriesColors:!1},offsetY:10},grid:{strokeDashArray:8,borderColor:qe},colors:[n.line.series1,n.line.series2],fill:{opacity:[1,1]},plotOptions:{bar:{columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4}},dataLabels:{enabled:!1},xaxis:{tickAmount:10,categories:a.value.bulan,labels:{style:{colors:pe,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{tickAmount:4,labels:{style:{colors:pe,fontSize:"13px",fontWeight:400},formatter(_){return _>=1e6?`${(_/1e6).toFixed(0)} jt`:(_==null?void 0:_.toLocaleString("id-ID"))||0}}},responsive:[{breakpoint:1400,options:{chart:{height:320},xaxis:{labels:{style:{fontSize:"10px"}}},legend:{itemMargin:{vertical:0,horizontal:10},fontSize:"13px",offsetY:12}}},{breakpoint:1025,options:{chart:{height:415},plotOptions:{bar:{columnWidth:"50%"}}}},{breakpoint:982,options:{plotOptions:{bar:{columnWidth:"30%"}}}},{breakpoint:480,options:{chart:{height:250},legend:{offsetY:7}}}]}));return(_,x)=>{const k=ye;return u(),w(O,null,{default:t(()=>[e(L,{title:"Expense statistics",subtitle:"Monthly expenses"},{append:t(()=>[e(Se,{"offset-y":""},{activator:t(({props:m})=>[e(Y,we(m,{variant:"tonal","append-icon":"tabler-chevron-down"}),{default:t(()=>[I(f(v.value),1)]),_:2},1040)]),default:t(()=>[e(xe,null,{default:t(()=>[e(Z,{onClick:x[0]||(x[0]=m=>v.value="All")},{default:t(()=>[e(ne,null,{default:t(()=>x[1]||(x[1]=[I("All")])),_:1})]),_:1}),(u(!0),S(T,null,M(h.value,m=>(u(),w(Z,{key:m,onClick:l=>v.value=m},{default:t(()=>[e(ne,null,{default:t(()=>[I(f(m),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(k,{id:"shipment-statistics",type:"line",height:"320",options:s.value,series:c.value},null,8,["options","series"])]),_:1})]),_:1})}}};const Je={class:"text-caption text-uppercase text-success"},Ge={class:"app-timeline-title"},Xe={class:"app-timeline-text"},Ze={class:"text-caption text-uppercase text-warning"},Qe={class:"app-timeline-title"},et={class:"app-timeline-text"},tt={class:"text-caption text-uppercase text-error"},at={class:"app-timeline-title"},ot={class:"app-timeline-text"},st={__name:"FinanceHistory",props:{data:{type:Object,default:()=>({expenses:[],outgoings:[],inputs:[]})}},setup($){const d=$,r=D("Input"),p=["Input","Outgoing","Expenses"];return(y,v)=>{const h=q;return u(),w(O,{class:"country-order-card"},{default:t(()=>[e(L,{title:"Payment History",subtitle:"Transactions"},{append:t(()=>[e(h)]),_:1}),e(Fe,{modelValue:i(r),"onUpdate:modelValue":v[0]||(v[0]=a=>X(r)?r.value=a:null),grow:"",class:"disable-tab-transition"},{default:t(()=>[(u(),S(T,null,M(p,(a,n)=>e(Ie,{key:n},{default:t(()=>[I(f(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(U,null,{default:t(()=>[e(ze,{modelValue:i(r),"onUpdate:modelValue":v[1]||(v[1]=a=>X(r)?r.value=a:null)},{default:t(()=>[e(te,null,{default:t(()=>[o("div",null,[d.data.inputs.length?(u(),w(ae,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(T,null,M(d.data.inputs,(a,n)=>(u(),w(oe,{key:n,icon:"tabler-circle-check","dot-color":"rgba(var(--v-theme-surface))","icon-color":"success","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[o("div",Je,f(a.remark),1),o("div",Ge,f(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),o("div",Xe,f(i(J)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1}),e(te,null,{default:t(()=>[o("div",null,[d.data.outgoings.length?(u(),w(ae,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(T,null,M(d.data.outgoings,(a,n)=>(u(),w(oe,{key:n,icon:"tabler-arrow-up-right","dot-color":"rgba(var(--v-theme-surface))","icon-color":"warning","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[o("div",Ze,f(a.remark),1),o("div",Qe,f(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),o("div",et,f(i(J)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1}),e(te,null,{default:t(()=>[o("div",null,[d.data.expenses.length?(u(),w(ae,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(T,null,M(d.data.expenses,(a,n)=>(u(),w(oe,{key:n,icon:"tabler-arrow-up-right-circle","dot-color":"rgba(var(--v-theme-surface))","icon-color":"error","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[o("div",tt,f(a.remark),1),o("div",at,f(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),o("div",ot,f(i(J)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}};const nt={key:0,class:"d-flex mb-8"},lt={class:"vehicle-progress-label position-relative mb-4 text-body-1 d-none d-sm-block text-truncate"},rt={class:"table-container"},it={width:"70%"},ct={class:"text-body-1 text-high-emphasis"},ut={class:"text-end"},dt={class:"font-weight-medium text-body-1 text-high-emphasis"},pt={class:"text-end"},mt={class:"text-body-1"},ft={__name:"NonKitchenOverview",props:{data:{type:Array,required:!0}},setup($){const d=$,r=F(()=>{const a=Array.isArray(d.data)?d.data:[],n=a.reduce((c,s)=>c+Number(s.amount||0),0);return a.map(c=>{var s,_;return{icon:h((s=c.finance_account)==null?void 0:s.description),title:((_=c.finance_account)==null?void 0:_.description)||"Unknown",amount:Number(c.amount||0),time:Number(c.amount||0).toLocaleString("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}),percentage:n>0?Number(c.amount||0)/n*100:0}})}),p=F(()=>{const a=r.value.slice().sort((x,k)=>k.amount-x.amount);if(a.length===0)return[];if(a.length<=4){const k=100/a.reduce((m,l)=>m+l.percentage,0);return a.map(m=>({...m,percentage:parseFloat((m.percentage*k).toFixed(1))}))}const n=a.slice(0,3),s=a.slice(3).reduce((x,k)=>x+k.percentage,0),_={title:"Lain-lain",percentage:parseFloat(s.toFixed(1)),icon:"tabler-dots"};return[...n.map(x=>({...x,percentage:parseFloat(x.percentage.toFixed(1))})),_]}),y=["rgba(var(--v-theme-on-surface), var(--v-hover-opacity))","rgb(var(--v-theme-primary))","rgb(var(--v-theme-info))","#212121"],v=a=>y[a%y.length],h=a=>({"Sewa Gedung":"tabler-building","Internet & Tools":"tabler-wifi","Gaji Karyawan":"tabler-users","Gaji Guru":"tabler-school"})[a]||"tabler-receipt-2";return(a,n)=>{const c=q;return u(),w(O,null,{default:t(()=>[e(L,{title:"Non Kitchen overview"},{append:t(()=>[e(c)]),_:1}),e(U,null,{default:t(()=>[p.value.length?(u(),S("div",nt,[(u(!0),S(T,null,M(p.value,(s,_)=>(u(),S("div",{key:s.title,style:he({"inline-size":`${s.percentage}%`})},[o("div",lt,f(s.title),1),e(i(_e),{color:v(_),"model-value":"100",height:"46",class:H({"rounded-s-0":_>0&&p.value.length>1,"rounded-e-0":_<p.value.length-1,"rounded-sm":p.value.length===1})},{default:t(()=>[o("strong",{class:H(["vehicle-progress-text",_>0?"text-white":""])},f(s.percentage)+"%",3)]),_:2},1032,["color","class"])],4))),128))])):P("",!0),o("div",rt,[e(fe,{class:"text-no-wrap"},{default:t(()=>[o("tbody",null,[(u(!0),S(T,null,M(r.value,(s,_)=>(u(),S("tr",{key:_},[o("td",it,[e(B,{icon:s.icon,size:"24",class:"me-2"},null,8,["icon"]),o("span",ct,f(s.title),1)]),o("td",ut,[o("div",dt,f(s.time),1)]),o("td",pt,[o("span",mt,f(s.percentage.toFixed(1))+"%",1)])]))),128))])]),_:1})])]),_:1})]),_:1})}}},_t=le(ft,[["__scopeId","data-v-a8ff2595"]]),me="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",vt="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",ht={__name:"PaymentDelivery",props:{data:{type:Object,default:()=>({text:[],value:[]})}},setup($){const d=$,r={donut:{series1:"#56ca00",series2:"#56ca00cc",series3:"#56ca0099",series4:"#56ca0066"}},p=F(()=>{const a=se(d.data.value)||[];return a.length?a.reduce((n,c)=>n+Number(c),0)/a.length:0}),y=F(()=>{var a,n;return(n=(a=d.data)==null?void 0:a.value)!=null&&n.length?d.data.value.map(c=>Number(c)||0):[0]}),v={chart:{animations:{enabled:!1}},colors:[r.donut.series1,r.donut.series2,r.donut.series3,r.donut.series4],stroke:{width:0},dataLabels:{enabled:!1,formatter(a){return`${Number.parseInt(a)}%`}},legend:{show:!0,position:"bottom",offsetY:10,markers:{width:8,height:8,offsetX:-3},itemMargin:{horizontal:15,vertical:5},fontSize:"13px",fontWeight:400,labels:{colors:me,useSeriesColors:!1}},tooltip:{theme:!1},grid:{padding:{top:15}},plotOptions:{pie:{donut:{size:"75%",labels:{show:!0,value:{fontSize:"26px",color:me,fontWeight:500,offsetY:-15,formatter(a){return`${Number.parseInt(a)}%`}},name:{offsetY:30},total:{show:!0,fontSize:"0.75rem",fontWeight:400,label:"AVG. Total",color:vt,formatter:()=>`${Number.parseInt(p.value)}%`}}}}},responsive:[{breakpoint:420,options:{chart:{height:400}}}]},h=F(()=>{var a,n;return{...v,labels:(n=(a=d.data)==null?void 0:a.text)!=null&&n.length?d.data.text:["No Data"]}});return(a,n)=>{const c=q,s=ye;return u(),w(O,null,{default:t(()=>[e(L,{title:"Payment Delivery"},{append:t(()=>[e(c)]),_:1}),e(U,null,{default:t(()=>[e(s,{type:"donut",height:"400",options:h.value,series:y.value},null,8,["options","series"])]),_:1})]),_:1})}}};const gt={class:"table-container"},bt={class:"text-high-emphasis text-body-1 font-weight-medium"},yt={__name:"PaymentPerformance",props:{students:{type:Array,required:!0},payments:{type:Array,required:!0}},setup($){const d=$,r=F(()=>!d.students||d.students.length===0?[]:d.students.map(p=>{const y=d.payments.filter(h=>h.admin_student_id===p.id),v=y.length>0;return{title:p.name,length:y.length,date:v?J(y[0].date)||y[0].date:"-",billing:v?y[0].billing:"Waiting",icon:v?"tabler-circle-check":"tabler-circle-x",color:v?y.length>=3?"success":"primary":"warning"}}));return console.log("deliveryData: ",r.value),(p,y)=>{const v=q;return u(),w(O,null,{default:t(()=>[e(L,{title:"Monthly overview",subtitle:"Payment delivery"},{append:t(()=>[e(v)]),_:1}),e(U,null,{default:t(()=>[o("div",gt,[e(xe,{class:"card-list text-no-wrap"},{default:t(()=>[(u(!0),S(T,null,M(r.value,(h,a)=>(u(),w(Z,{key:a},{prepend:t(()=>[e(G,{color:h.color,variant:"tonal",rounded:"",size:"38"},{default:t(()=>[e(B,{icon:h.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])]),append:t(()=>[o("span",bt,f(h.date),1)]),default:t(()=>[e(ne,null,{default:t(()=>[I(f(i(Ae)(h.title)),1)]),_:2},1024),e(Ne,null,{default:t(()=>[o("div",{class:H([h.billing=="Waiting"?"text-secondary":h.length>=3?"text-success":"text-primary","d-flex align-center"])},[e(B,{icon:h.billing=="Waiting"?"tabler-chevron-down":h.length>=3?"tabler-chevrons-up":"tabler-chevron-up",class:"me-1"},null,8,["icon"]),o("span",null,f(h.billing),1)],2)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1})]),_:1})}}},xt=le(yt,[["__scopeId","data-v-1202ef3b"]]),Vt={__name:"AddDepositDialog",props:{mode:{type:String,required:!0},selectedData:{type:Object,required:!1,default:()=>({id:null,title:"",amount:0,icon:"",color:""})},isDialogVisible:{type:Boolean,required:!0}},emits:["submit","delete","update:isDialogVisible"],setup($,{emit:d}){const r=$,p=d,y=D(),v=F(()=>r.mode==="add"?"Add Deposit":"Edit Deposit"),h=F(()=>r.mode==="add"?"Submit":"Update"),a=[{label:"Bank",value:"tabler-building-bank"},{label:"Piggy Bank",value:"tabler-pig-money"},{label:"Wallet",value:"tabler-wallet"},{label:"Credit Card",value:"tabler-credit-card"},{label:"Cash",value:"tabler-cash"}],n=[{text:"Primary",value:"primary"},{text:"Warning",value:"warning"},{text:"Info",value:"info"},{text:"Success",value:"success"},{text:"Error",value:"error"},{text:"Secondary",value:"secondary"}],c=D(structuredClone(se(r.selectedData)));ve(()=>r.isDialogVisible,m=>{m&&(c.value=structuredClone(se(r.selectedData)))});const s=()=>{var m;(m=y.value)==null||m.validate().then(({valid:l})=>{l&&(p("update:isDialogVisible",!1),p("submit",{mode:r.mode,data:c.value}))})},_=()=>{p("update:isDialogVisible",!1)},x=()=>{c.value.id&&p("delete",c.value.id)},k=m=>{p("update:isDialogVisible",m)};return(m,l)=>{const g=Me,b=Te;return u(),w(Ee,{width:m.$vuetify.display.smAndDown?"auto":420,"model-value":r.isDialogVisible,"onUpdate:modelValue":k},{default:t(()=>[e(g,{onClick:l[0]||(l[0]=V=>k(!1))}),e(O,{class:"pa-sm-8 pa-5"},{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(Ve,{class:"text-h3"},{default:t(()=>[I(f(i(v)),1)]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(Pe,{ref_key:"refForm",ref:y,class:"mt-4",onSubmit:Ce(s,["prevent"])},{default:t(()=>[e(re,null,{default:t(()=>[e(A,{cols:"12"},{default:t(()=>[e(b,{modelValue:i(c).title,"onUpdate:modelValue":l[1]||(l[1]=V=>i(c).title=V),rules:["requiredValidator"in m?m.requiredValidator:i(ue)],label:"Title",placeholder:"Deposit Account"},null,8,["modelValue","rules"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(b,{modelValue:i(c).amount,"onUpdate:modelValue":l[2]||(l[2]=V=>i(c).amount=V),rules:["requiredValidator"in m?m.requiredValidator:i(ue)],label:"amount",placeholder:"Deposit Amount",type:"number"},null,8,["modelValue","rules"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(de,{modelValue:i(c).icon,"onUpdate:modelValue":l[3]||(l[3]=V=>i(c).icon=V),label:"Deposit Icon",placeholder:"Deposit Icon",items:a,"item-title":"label","item-value":"value"},{item:t(({props:V,item:C})=>[e(Z,De($e(V)),{default:t(()=>[e(B,{icon:C.raw.value,class:"me-2"},null,8,["icon"]),o("span",null,f(C.raw.label),1)]),_:2},1040)]),selection:t(({item:V})=>[e(B,{icon:V.raw.value,class:"me-2"},null,8,["icon"]),o("span",null,f(V.raw.label),1)]),_:1},8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(de,{modelValue:i(c).color,"onUpdate:modelValue":l[4]||(l[4]=V=>i(c).color=V),label:"Deposit Color",placeholder:"Deposit Color",items:n,"item-title":"text","item-value":"value"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12",class:"d-flex flex-wrap justify-center gap-2 mt-6"},{default:t(()=>[e(Y,{type:"submit"},{default:t(()=>[I(f(i(h)),1)]),_:1}),e(Y,{color:"secondary",variant:"tonal",onClick:_},{default:t(()=>l[5]||(l[5]=[I(" Cancel ")])),_:1}),r.mode==="edit"?(u(),w(Y,{key:0,color:"error",variant:"tonal",onClick:x},{default:t(()=>l[6]||(l[6]=[I(" Delete ")])),_:1})):P("",!0)]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};const kt={class:"d-flex align-center gap-x-4 mb-2"},wt={class:"text-h5 font-weight-medium"},Ct={class:"text-body-1"},Dt={class:"d-flex gap-x-2"},$t={class:"text-h6 font-weight-medium"},St={class:"d-flex align-center gap-x-4 mb-2"},Nt={__name:"SaldoCardStatistics",setup($){const d=ge("userData"),r=D([]),p=D(!1),y=D("add"),v=D({}),h=async()=>{var l;try{const{data:g}=await j("/deposits"),b=((l=g.value)==null?void 0:l.data)||[],V=b.reduce((C,z)=>C+z.amount,0);r.value=b.map(C=>({...C,value:new Intl.NumberFormat("id-ID").format(C.amount),change:V>0?parseFloat((C.amount/V*100).toFixed(0)):0,isHover:!1}))}catch(g){s("Failed to fetch deposits.","error"),console.error(g)}};be(h);const a=D(!1),n=D(""),c=D("primary"),s=(l,g="primary")=>{n.value=l,c.value=g,a.value=!0,setTimeout(()=>{a.value=!1},1e4)},_=()=>{y.value="add",v.value={title:"",amount:0,icon:"tabler-building-bank",color:"primary"},p.value=!0},x=l=>{y.value="edit",v.value=JSON.parse(JSON.stringify(l)),p.value=!0},k=async l=>{var V;const{mode:g,data:b}=l;try{let C;if(g==="add"?C=await j("/deposits",{method:"POST",body:JSON.stringify(b),headers:{"Content-Type":"application/json",Accept:"application/json"}}):C=await j(`/deposits/${b.id}`,{method:"PUT",body:JSON.stringify(b),headers:{"Content-Type":"application/json",Accept:"application/json"}}),(V=C.response.value)!=null&&V.ok)s(`Deposit ${g==="add"?"added":"updated"} successfully.`,"success"),h();else{const z=C.data.value,K=z!=null&&z.errors?Object.values(z.errors).flat().join(`
`):(z==null?void 0:z.message)||`Failed to ${g} deposit.`;s(K,"error")}}catch(C){s(`Failed to ${g} deposit.`,"error"),console.error(C)}},m=async l=>{try{await j(`/deposits/${l}`,{method:"DELETE"}),s("Deposit deleted successfully.","success"),h()}catch(g){s("Failed to delete deposit.","error"),console.error(g)}p.value=!1};return(l,g)=>(u(),w(re,null,{default:t(()=>[e(Oe,{modelValue:i(a),"onUpdate:modelValue":g[1]||(g[1]=b=>X(a)?a.value=b:null),location:"center",variant:"tonal",transition:"scale-transition",color:i(c),class:"text-center"},{actions:t(()=>[e(Y,{color:i(c),onClick:g[0]||(g[0]=b=>a.value=!1)},{default:t(()=>g[3]||(g[3]=[I(" Close ")])),_:1},8,["color"])]),default:t(()=>[I(f(i(n))+" ",1)]),_:1},8,["modelValue","color"]),(u(!0),S(T,null,M(i(r),(b,V)=>(u(),w(A,{key:V,cols:"12",md:i(r).length<=2?6:i(r).length<=4?3:i(r).length<=6?2:6,sm:"6"},{default:t(()=>[o("div",null,[e(O,{class:"logistics-card-statistics cursor-pointer",style:he(b.isHover?{"border-block-end":`2px solid rgba(var(--v-theme-${b.color}))`}:{"border-block-end":`2px solid rgba(var(--v-theme-${b.color}), var(--v-disabled-opacity))`}),onClick:C=>x(b),onMouseenter:C=>b.isHover=!0,onMouseleave:C=>b.isHover=!1},{default:t(()=>[e(U,null,{default:t(()=>[o("div",kt,[e(G,{variant:"tonal",class:"avatar-hover",color:b.color,rounded:""},{default:t(()=>[e(B,{icon:b.icon,size:"28"},null,8,["icon"])]),_:2},1032,["color"]),o("h5",wt,f(b.value),1)]),o("div",Ct,f(b.title),1),o("div",Dt,[o("h6",$t,f(b.change)+"% ",1),g[4]||(g[4]=o("span",{class:"text-disabled"},"from Total",-1))])]),_:2},1024)]),_:2},1032,["style","onClick","onMouseenter","onMouseleave"])])]),_:2},1032,["md"]))),128)),i(r).length==0||i(r).length%2!==0||i(d).admin_teacher_id?(u(),w(A,{key:0,md:i(r).length<=2?6:i(r).length<=4?3:i(r).length<=6?2:6,cols:"12",sm:"6",onClick:_},{default:t(()=>[o("div",null,[e(O,{class:"logistics-card-statistics cursor-pointer"},{default:t(()=>[e(U,null,{default:t(()=>[o("div",St,[e(G,{variant:"tonal",class:"avatar-hover",rounded:"",size:"85"},{default:t(()=>[e(B,{size:"42",icon:"tabler-plus"})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["md"])):P("",!0),i(d).admin_teacher_id?(u(),w(Vt,{key:1,"is-dialog-visible":i(p),"onUpdate:isDialogVisible":g[2]||(g[2]=b=>X(p)?p.value=b:null),mode:i(y),"selected-data":i(v),onSubmit:k,onDelete:m},null,8,["is-dialog-visible","mode","selected-data"])):P("",!0)]),_:1}))}},At=le(Nt,[["__scopeId","data-v-895108c5"]]),Va={__name:"finance",setup($){const d=ge("userData"),r=D([]),p=D([]),y=D([]),v=D([]),h=D([]),a=D([]),n=D([]),c=D({text:[],value:[]}),s=D([]);D("");async function _(k=""){var K,ie;const l=(await j(`/dashboard-finance?year=${k}`)).data.value;if(console.log("financeData: ",l),!l)return;r.value=l.nonKitchen||[],p.value=l.houseHold||[],y.value=l.students||[],v.value=l.expenses||[],h.value=l.outgoings||[],a.value=l.inputs||[],n.value=l.payCurrentMonth||[];const g=l.payDelivery||[];c.value={text:g.map(N=>N.billing),value:g.map(N=>N.amount>0?Math.round(Number(N.paidAmount)/N.amount*100):0)};const b=((K=l.allocation)==null?void 0:K.finances)||[],V=((ie=l.allocation)==null?void 0:ie.payments)||[],C=b.reduce((N,E)=>N+Number(E.amount),0),z=Array.from(new Set([...b.map(N=>N.allocation),...V.map(N=>N.number)]));s.value=z.map(N=>{const E=b.find(ee=>ee.allocation===N),W=V.find(ee=>ee.number===N),R=Number((E==null?void 0:E.amount)||0),Q=Number((W==null?void 0:W.amount)||0);return{...E,...W,allocation:(W==null?void 0:W.description)||(E==null?void 0:E.description)||"",payment:Q,expense:R,balance:Q-R,percentage:C>0?R/C*100:0,remain:R>0?100-Math.round((Q-R)/R*100):100}})}const x=k=>{_(k)};return be(()=>_()),(k,m)=>(u(),w(re,{class:"match-height"},{default:t(()=>[e(A,{cols:"12"},{default:t(()=>[e(At)]),_:1}),e(A,{cols:"12",md:"6"},{default:t(()=>[e(_t,{data:r.value},null,8,["data"])]),_:1}),e(A,{cols:"12",md:"6"},{default:t(()=>[e(Ke,{data:p.value,onYearSelected:x},null,8,["data"])]),_:1}),i(d).admin_teacher_id?(u(),w(A,{key:0,cols:"12",md:"4"},{default:t(()=>[e(xt,{payments:n.value,students:y.value},null,8,["payments","students"])]),_:1})):P("",!0),e(A,{cols:"12",md:i(d).admin_teacher_id?4:6},{default:t(()=>[e(ht,{data:c.value},null,8,["data"])]),_:1},8,["md"]),e(A,{cols:"12",md:i(d).admin_teacher_id?4:6},{default:t(()=>[e(st,{data:{expenses:v.value,outgoings:h.value,inputs:a.value}},null,8,["data"])]),_:1},8,["md"]),e(A,{cols:"12"},{default:t(()=>[i(d).admin_teacher_id?(u(),w(Ye,{key:0,data:s.value},null,8,["data"])):P("",!0)]),_:1})]),_:1}))}};export{Va as default};
