import{u as R}from"./useApi-2f2d676b.js";import{_ as q}from"./MoreBtn-1891c99e.js";import{a as L,V as B,b as Ve}from"./VCard-a39876b1.js";import{V as ke}from"./VDivider-6be2b96b.js";import{V as fe}from"./VTable-2039da19.js";import{V as G}from"./VAvatar-6d04c863.js";import{a5 as F,o as d,f as k,e as t,b as e,d as n,c as S,F as M,i as T,x as _,a0 as O,y as H,v as I,aZ as _e,z as P,r as C,w as ve,ai as j,s as we,n as c,aU as X,J as he,be as ne,a$ as De,cE as Ce,cF as $e,$ as ge,H as be}from"./main-7487d517.js";import{V as ce}from"./VChip-2f95e3fb.js";import{m as ye}from"./vue3-apexcharts-4354b5f0.js";import{V as Se}from"./VMenu-64e26677.js";import{V as xe,a as Z,b as le,c as Ne}from"./VList-1bc1b4f4.js";import{V as U}from"./VCardText-5f738b43.js";import{h as J,s as Ae}from"./helpers-3fbb07dd.js";import{V as Fe,a as Ie}from"./VTabs-b6095b63.js";import{V as ze,a as te}from"./VWindowItem-0e9b2898.js";import{V as ae,a as oe}from"./VTimelineItem-096d9ad1.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import{r as ue}from"./validators-c9e19b76.js";import{_ as Me}from"./AppTextField-f3519212.js";import{_ as Te}from"./DialogCloseBtn-f5d2513b.js";import{_ as de}from"./AppSelect-abb85e9c.js";import{V as Pe}from"./VForm-601bdd25.js";import{V as re}from"./VRow-9d945ad9.js";import{V as A}from"./VCol-fe7d94c6.js";import{V as Ee}from"./VDialog-93f6154c.js";import{V as Be}from"./VSnackbar-1e4937a9.js";import"./VImg-07fecb91.js";import"./VOverlay-f41b538e.js";import"./easing-9f15041e.js";import"./lazy-d84728e0.js";import"./scopeId-a8e59773.js";import"./forwardRefs-8348545e.js";import"./dialog-transition-30fb99f7.js";import"./ssrBoot-6d306988.js";import"./no-profile-4221a4a6.js";import"./VSlideGroup-32c55a80.js";import"./form-ae5f14e6.js";import"./VTextField-1ea2f494.js";/* empty css                   */import"./VCounter-295b60c2.js";import"./VField-66cd25e5.js";import"./VInput-d4c18c39.js";import"./VSelect-ce1bc86e.js";import"./VCheckboxBtn-fe4983bb.js";import"./VSelectionControl-643c6274.js";const Oe={class:"d-flex align-center"},Ue={class:"text-body-2 text-high-emphasis font-weight-medium"},We={class:"d-flex align-center gap-x-4",style:{"min-inline-size":"200px"}},Le={class:"w-100"},Ye={class:"text-body-1 bg-var-theme-background"},Re={class:"font-weight-medium"},je={__name:"AllocationTable",props:{data:{type:Array,default:()=>[]}},setup($){const p=$,i=[{title:"ACCOUNT",key:"description"},{title:"PAYMENT",key:"payment"},{title:"EXPENSES",key:"expense"},{title:"BALANCE",key:"balance"},{title:"REMAIN",key:"percentage"}],f=a=>typeof a!="number"?a:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),x=a=>a>0?"success":a<0?"error":"warning",g=a=>a>100?"error":a>90?"warning":"primary",w=F(()=>p.data.reduce((a,l)=>a+l.balance,0));return(a,l)=>{const s=q;return p.data.length?(d(),k(B,{key:0},{default:t(()=>[e(L,{title:"Allocation"},{append:t(()=>[e(s)]),_:1}),e(ke),e(fe,{class:"text-no-wrap"},{default:t(()=>[n("thead",null,[n("tr",null,[(d(),S(M,null,T(i,o=>n("th",{key:o.key,scope:"col",class:"text-uppercase"},_(o.title),1)),64))])]),n("tbody",null,[(d(!0),S(M,null,T(p.data,o=>(d(),S("tr",{key:o.allocation},[n("td",null,[n("div",Oe,[e(G,{color:o.payment>0?"primary":"error",variant:"tonal",class:"me-2",size:"34"},{default:t(()=>[e(O,{icon:o.payment>0?"tabler-building-bank":"tabler-wallet",size:"22"},null,8,["icon"])]),_:2},1032,["color"]),n("span",Ue,_(o.allocation||"No Allocated"),1)])]),n("td",{class:H(Number(o.payment)<0?"text-error":"text-secondary")},_(f(Number(o.payment))),3),n("td",{class:H(Number(o.expense)<0?"text-success":"text-secondary")},_(f(Number(o.expense))),3),n("td",null,[e(ce,{color:x(o.balance),label:""},{default:t(()=>[I(_(f(o.balance)),1)]),_:2},1032,["color"])]),n("td",null,[n("div",We,[n("div",Le,[e(_e,{"model-value":o.remain,color:g(o.remain),height:10,rounded:""},null,8,["model-value","color"])]),l[0]||(l[0]=n("div",{class:"text-body-2"},null,-1))])])]))),128))]),n("tfoot",null,[n("tr",Ye,[l[1]||(l[1]=n("th",{colspan:"2",scope:"row"},null,-1)),l[2]||(l[2]=n("th",{class:"font-weight-medium text-high-emphasis"}," Total Balance ",-1)),n("td",Re,[e(ce,{color:x(w.value),label:""},{default:t(()=>[I(_(f(w.value)),1)]),_:1},8,["color"])]),l[3]||(l[3]=n("td",null,null,-1))])])]),_:1})]),_:1})):P("",!0)}}};const He="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",pe="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",qe="rgba(var(--v-border-color), var(--v-border-opacity))",Ke={__name:"ExpenseStatistics",props:{data:{type:Array,default:()=>[]}},emits:["year-selected"],setup($,{emit:p}){const i=$,f=p,x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=C("All");ve(g,u=>{f("yearSelected",u==="All"?"":u)});const w=F(()=>{const b=new Date().getFullYear(),V=[];for(let m=b;m>=2023;m--)V.push(m);return V}),a=F(()=>{const u=[],b=[],V=[];return i.data.forEach(m=>{const[r,v]=m.month.split("-");u.push(`${x[parseInt(v)-1]}-${r}`),u.push(`${x[parseInt(v)-1]}`),b.push(Number(m.official)),V.push(Number(m.non_official))}),{bulan:u,official:b,non_official:V}}),l={line:{series1:"#FFB400",series2:"#9055FD",series3:"#7367f029"}},s=F(()=>[{name:"Kitchen",type:"column",data:a.value.official},{name:"Household",type:"line",data:a.value.non_official}]),o=F(()=>({chart:{type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},markers:{size:5,colors:"#fff",strokeColors:l.line.series2,hover:{size:6},borderRadius:4},stroke:{curve:"smooth",width:[0,3],lineCap:"round"},legend:{show:!0,position:"bottom",markers:{width:8,height:8,offsetX:-3},height:40,itemMargin:{horizontal:10,vertical:0},fontSize:"15px",fontFamily:"Open Sans",fontWeight:400,labels:{colors:He,useSeriesColors:!1},offsetY:10},grid:{strokeDashArray:8,borderColor:qe},colors:[l.line.series1,l.line.series2],fill:{opacity:[1,1]},plotOptions:{bar:{columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4}},dataLabels:{enabled:!1},xaxis:{tickAmount:10,categories:a.value.bulan,labels:{style:{colors:pe,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{tickAmount:4,labels:{style:{colors:pe,fontSize:"13px",fontWeight:400},formatter(u){return u>=1e6?`${(u/1e6).toFixed(0)} jt`:(u==null?void 0:u.toLocaleString("id-ID"))||0}}},responsive:[{breakpoint:1400,options:{chart:{height:320},xaxis:{labels:{style:{fontSize:"10px"}}},legend:{itemMargin:{vertical:0,horizontal:10},fontSize:"13px",offsetY:12}}},{breakpoint:1025,options:{chart:{height:415},plotOptions:{bar:{columnWidth:"50%"}}}},{breakpoint:982,options:{plotOptions:{bar:{columnWidth:"30%"}}}},{breakpoint:480,options:{chart:{height:250},legend:{offsetY:7}}}]}));return(u,b)=>{const V=ye;return d(),k(B,null,{default:t(()=>[e(L,{title:"Expense statistics",subtitle:"Monthly expenses"},{append:t(()=>[e(Se,{"offset-y":""},{activator:t(({props:m})=>[e(j,we(m,{variant:"tonal","append-icon":"tabler-chevron-down"}),{default:t(()=>[I(_(g.value),1)]),_:2},1040)]),default:t(()=>[e(xe,null,{default:t(()=>[e(Z,{onClick:b[0]||(b[0]=m=>g.value="All")},{default:t(()=>[e(le,null,{default:t(()=>b[1]||(b[1]=[I("All")])),_:1})]),_:1}),(d(!0),S(M,null,T(w.value,m=>(d(),k(Z,{key:m,onClick:r=>g.value=m},{default:t(()=>[e(le,null,{default:t(()=>[I(_(m),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(V,{id:"shipment-statistics",type:"line",height:"320",options:o.value,series:s.value},null,8,["options","series"])]),_:1})]),_:1})}}};const Je={class:"text-caption text-uppercase text-success"},Ge={class:"app-timeline-title"},Xe={class:"app-timeline-text"},Ze={class:"text-caption text-uppercase text-warning"},Qe={class:"app-timeline-title"},et={class:"app-timeline-text"},tt={class:"text-caption text-uppercase text-error"},at={class:"app-timeline-title"},ot={class:"app-timeline-text"},nt={__name:"FinanceHistory",props:{data:{type:Object,default:()=>({expenses:[],outgoings:[],inputs:[]})}},setup($){const p=$,i=C("Input"),f=["Input","Outgoing","Expenses"];return(x,g)=>{const w=q;return d(),k(B,{class:"country-order-card"},{default:t(()=>[e(L,{title:"Payment History",subtitle:"Transactions"},{append:t(()=>[e(w)]),_:1}),e(Fe,{modelValue:c(i),"onUpdate:modelValue":g[0]||(g[0]=a=>X(i)?i.value=a:null),grow:"",class:"disable-tab-transition"},{default:t(()=>[(d(),S(M,null,T(f,(a,l)=>e(Ie,{key:l},{default:t(()=>[I(_(a),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(U,null,{default:t(()=>[e(ze,{modelValue:c(i),"onUpdate:modelValue":g[1]||(g[1]=a=>X(i)?i.value=a:null)},{default:t(()=>[e(te,null,{default:t(()=>[n("div",null,[p.data.inputs.length?(d(),k(ae,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(d(!0),S(M,null,T(p.data.inputs,(a,l)=>(d(),k(oe,{key:l,icon:"tabler-circle-check","dot-color":"rgba(var(--v-theme-surface))","icon-color":"success","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[n("div",Je,_(a.remark),1),n("div",Ge,_(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),n("div",Xe,_(c(J)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1}),e(te,null,{default:t(()=>[n("div",null,[p.data.outgoings.length?(d(),k(ae,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(d(!0),S(M,null,T(p.data.outgoings,(a,l)=>(d(),k(oe,{key:l,icon:"tabler-arrow-up-right","dot-color":"rgba(var(--v-theme-surface))","icon-color":"warning","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[n("div",Ze,_(a.remark),1),n("div",Qe,_(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),n("div",et,_(c(J)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1}),e(te,null,{default:t(()=>[n("div",null,[p.data.expenses.length?(d(),k(ae,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(d(!0),S(M,null,T(p.data.expenses,(a,l)=>(d(),k(oe,{key:l,icon:"tabler-arrow-up-right-circle","dot-color":"rgba(var(--v-theme-surface))","icon-color":"error","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[n("div",tt,_(a.remark),1),n("div",at,_(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a.amount)),1),n("div",ot,_(c(J)(a.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}};const lt={key:0,class:"d-flex mb-8"},st={class:"vehicle-progress-label position-relative mb-4 text-body-1 d-none d-sm-block text-truncate"},rt={class:"table-container"},it={width:"70%"},ct={class:"text-body-1 text-high-emphasis"},ut={class:"text-end"},dt={class:"font-weight-medium text-body-1 text-high-emphasis"},pt={class:"text-end"},mt={class:"text-body-1"},ft={__name:"NonKitchenOverview",props:{data:{type:Array,required:!0}},setup($){const p=$,i=F(()=>{const a=Array.isArray(p.data)?p.data:[],l=a.reduce((s,o)=>s+Number(o.amount||0),0);return a.map(s=>{var o,u;return{icon:w((o=s.finance_account)==null?void 0:o.description),title:((u=s.finance_account)==null?void 0:u.description)||"Unknown",amount:Number(s.amount||0),time:Number(s.amount||0).toLocaleString("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}),percentage:l>0?Number(s.amount||0)/l*100:0}})}),f=F(()=>{const a=i.value.slice().sort((b,V)=>V.amount-b.amount);if(a.length===0)return[];if(a.length<=4){const V=100/a.reduce((m,r)=>m+r.percentage,0);return a.map(m=>({...m,percentage:parseFloat((m.percentage*V).toFixed(1))}))}const l=a.slice(0,3),o=a.slice(3).reduce((b,V)=>b+V.percentage,0),u={title:"Lain-lain",percentage:parseFloat(o.toFixed(1)),icon:"tabler-dots"};return[...l.map(b=>({...b,percentage:parseFloat(b.percentage.toFixed(1))})),u]}),x=["rgba(var(--v-theme-on-surface), var(--v-hover-opacity))","rgb(var(--v-theme-primary))","rgb(var(--v-theme-info))","#212121"],g=a=>x[a%x.length],w=a=>({"Sewa Gedung":"tabler-building","Internet & Tools":"tabler-wifi","Gaji Karyawan":"tabler-users","Gaji Guru":"tabler-school"})[a]||"tabler-receipt-2";return(a,l)=>{const s=q;return d(),k(B,null,{default:t(()=>[e(L,{title:"Non Kitchen overview"},{append:t(()=>[e(s)]),_:1}),e(U,null,{default:t(()=>[f.value.length?(d(),S("div",lt,[(d(!0),S(M,null,T(f.value,(o,u)=>(d(),S("div",{key:o.title,style:he({"inline-size":`${o.percentage}%`})},[n("div",st,_(o.title),1),e(c(_e),{color:g(u),"model-value":"100",height:"46",class:H({"rounded-s-0":u>0&&f.value.length>1,"rounded-e-0":u<f.value.length-1,"rounded-sm":f.value.length===1})},{default:t(()=>[n("strong",{class:H(["vehicle-progress-text",u>0?"text-white":""])},_(o.percentage)+"%",3)]),_:2},1032,["color","class"])],4))),128))])):P("",!0),n("div",rt,[e(fe,{class:"text-no-wrap"},{default:t(()=>[n("tbody",null,[(d(!0),S(M,null,T(i.value,(o,u)=>(d(),S("tr",{key:u},[n("td",it,[e(O,{icon:o.icon,size:"24",class:"me-2"},null,8,["icon"]),n("span",ct,_(o.title),1)]),n("td",ut,[n("div",dt,_(o.time),1)]),n("td",pt,[n("span",mt,_(o.percentage.toFixed(1))+"%",1)])]))),128))])]),_:1})])]),_:1})]),_:1})}}},_t=se(ft,[["__scopeId","data-v-a8ff2595"]]),me="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",vt="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",ht={__name:"PaymentDelivery",props:{data:{type:Object,default:()=>({text:[],value:[]})}},setup($){const p=$,i={donut:{series1:"#56ca00",series2:"#56ca00cc",series3:"#56ca0099",series4:"#56ca0066"}},f=F(()=>{const a=ne(p.data.value)||[];return a.length?a.reduce((l,s)=>l+Number(s),0)/a.length:0}),x=F(()=>{var a,l;return(l=(a=p.data)==null?void 0:a.value)!=null&&l.length?p.data.value.map(s=>Number(s)||0):[0]}),g={chart:{animations:{enabled:!1}},colors:[i.donut.series1,i.donut.series2,i.donut.series3,i.donut.series4],stroke:{width:0},dataLabels:{enabled:!1,formatter(a){return`${Number.parseInt(a)}%`}},legend:{show:!0,position:"bottom",offsetY:10,markers:{width:8,height:8,offsetX:-3},itemMargin:{horizontal:15,vertical:5},fontSize:"13px",fontWeight:400,labels:{colors:me,useSeriesColors:!1}},tooltip:{theme:!1},grid:{padding:{top:15}},plotOptions:{pie:{donut:{size:"75%",labels:{show:!0,value:{fontSize:"26px",color:me,fontWeight:500,offsetY:-15,formatter(a){return`${Number.parseInt(a)}%`}},name:{offsetY:30},total:{show:!0,fontSize:"0.75rem",fontWeight:400,label:"AVG. Total",color:vt,formatter:()=>`${Number.parseInt(f.value)}%`}}}}},responsive:[{breakpoint:420,options:{chart:{height:400}}}]},w=F(()=>{var a,l;return{...g,labels:(l=(a=p.data)==null?void 0:a.text)!=null&&l.length?p.data.text:["No Data"]}});return(a,l)=>{const s=q,o=ye;return d(),k(B,null,{default:t(()=>[e(L,{title:"Payment Delivery"},{append:t(()=>[e(s)]),_:1}),e(U,null,{default:t(()=>[e(o,{type:"donut",height:"400",options:w.value,series:x.value},null,8,["options","series"])]),_:1})]),_:1})}}};const gt={class:"table-container"},bt={__name:"PaymentPerformance",props:{students:{type:Array,required:!0},payments:{type:Array,required:!0}},setup($){const p=$,i=new Date,f=i.toLocaleString("en-US",{month:"short"}),x=i.getFullYear(),g=`${f}-${x}`,w=F(()=>{if(!p.students||p.students.length===0)return[];const a=p.students.map(l=>{const s=p.payments.filter(u=>Number(u.admin_student_id)===Number(l.id)&&u.billing&&u.billing.includes(g)),o=s.length>0;return{title:l.name,length:s.length,date:o?J(s[0].date)||s[0].date:"-",billing:o?s[0].billing:"Waiting",icon:o?"tabler-circle-check":"tabler-circle-x",color:o?s.length>=3?"success":"primary":"warning"}});return console.log("Hasil akhir deliveryData:",a),a});return(a,l)=>{const s=q;return d(),k(B,null,{default:t(()=>[e(L,{title:"Monthly overview",subtitle:g},{append:t(()=>[e(s)]),_:1}),e(U,null,{default:t(()=>[n("div",gt,[e(xe,{class:"card-list text-no-wrap"},{default:t(()=>[(d(!0),S(M,null,T(w.value,(o,u)=>(d(),k(Z,{key:u},{prepend:t(()=>[e(G,{color:o.color,variant:"tonal",rounded:"",size:"38"},{default:t(()=>[e(O,{icon:o.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])]),append:t(()=>[n("small",null,_(o.date),1)]),default:t(()=>[e(le,null,{default:t(()=>[I(_(c(Ae)(o.title)),1)]),_:2},1024),e(Ne,null,{default:t(()=>[n("div",{class:H([o.billing=="Waiting"?"text-secondary":o.length>=3?"text-success":"text-primary","d-flex align-center"])},[e(O,{icon:o.billing=="Waiting"?"tabler-chevron-down":o.length>=3?"tabler-chevrons-up":"tabler-chevron-up",class:"me-1"},null,8,["icon"]),n("span",null,_(o.billing),1)],2)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1})]),_:1})}}},yt=se(bt,[["__scopeId","data-v-872cafa3"]]),xt={__name:"AddDepositDialog",props:{mode:{type:String,required:!0},selectedData:{type:Object,required:!1,default:()=>({id:null,title:"",amount:0,icon:"",color:""})},isDialogVisible:{type:Boolean,required:!0}},emits:["submit","delete","update:isDialogVisible"],setup($,{emit:p}){const i=$,f=p,x=C(),g=F(()=>i.mode==="add"?"Add Deposit":"Edit Deposit"),w=F(()=>i.mode==="add"?"Submit":"Update"),a=[{label:"Bank",value:"tabler-building-bank"},{label:"Piggy Bank",value:"tabler-pig-money"},{label:"Wallet",value:"tabler-wallet"},{label:"Credit Card",value:"tabler-credit-card"},{label:"Cash",value:"tabler-cash"}],l=[{text:"Primary",value:"primary"},{text:"Warning",value:"warning"},{text:"Info",value:"info"},{text:"Success",value:"success"},{text:"Error",value:"error"},{text:"Secondary",value:"secondary"}],s=C(structuredClone(ne(i.selectedData)));ve(()=>i.isDialogVisible,m=>{m&&(s.value=structuredClone(ne(i.selectedData)))});const o=()=>{var m;(m=x.value)==null||m.validate().then(({valid:r})=>{r&&(f("update:isDialogVisible",!1),f("submit",{mode:i.mode,data:s.value}))})},u=()=>{f("update:isDialogVisible",!1)},b=()=>{s.value.id&&f("delete",s.value.id)},V=m=>{f("update:isDialogVisible",m)};return(m,r)=>{const v=Te,h=Me;return d(),k(Ee,{width:m.$vuetify.display.smAndDown?"auto":420,"model-value":i.isDialogVisible,"onUpdate:modelValue":V},{default:t(()=>[e(v,{onClick:r[0]||(r[0]=y=>V(!1))}),e(B,{class:"pa-sm-8 pa-5"},{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(Ve,{class:"text-h3"},{default:t(()=>[I(_(c(g)),1)]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(Pe,{ref_key:"refForm",ref:x,class:"mt-4",onSubmit:De(o,["prevent"])},{default:t(()=>[e(re,null,{default:t(()=>[e(A,{cols:"12"},{default:t(()=>[e(h,{modelValue:c(s).title,"onUpdate:modelValue":r[1]||(r[1]=y=>c(s).title=y),rules:["requiredValidator"in m?m.requiredValidator:c(ue)],label:"Title",placeholder:"Deposit Account"},null,8,["modelValue","rules"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(h,{modelValue:c(s).amount,"onUpdate:modelValue":r[2]||(r[2]=y=>c(s).amount=y),rules:["requiredValidator"in m?m.requiredValidator:c(ue)],label:"amount",placeholder:"Deposit Amount",type:"number"},null,8,["modelValue","rules"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(de,{modelValue:c(s).icon,"onUpdate:modelValue":r[3]||(r[3]=y=>c(s).icon=y),label:"Deposit Icon",placeholder:"Deposit Icon",items:a,"item-title":"label","item-value":"value"},{item:t(({props:y,item:D})=>[e(Z,Ce($e(y)),{default:t(()=>[e(O,{icon:D.raw.value,class:"me-2"},null,8,["icon"]),n("span",null,_(D.raw.label),1)]),_:2},1040)]),selection:t(({item:y})=>[e(O,{icon:y.raw.value,class:"me-2"},null,8,["icon"]),n("span",null,_(y.raw.label),1)]),_:1},8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(de,{modelValue:c(s).color,"onUpdate:modelValue":r[4]||(r[4]=y=>c(s).color=y),label:"Deposit Color",placeholder:"Deposit Color",items:l,"item-title":"text","item-value":"value"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12",class:"d-flex flex-wrap justify-center gap-2 mt-6"},{default:t(()=>[e(j,{type:"submit"},{default:t(()=>[I(_(c(w)),1)]),_:1}),e(j,{color:"secondary",variant:"tonal",onClick:u},{default:t(()=>r[5]||(r[5]=[I(" Cancel ")])),_:1}),i.mode==="edit"?(d(),k(j,{key:0,color:"error",variant:"tonal",onClick:b},{default:t(()=>r[6]||(r[6]=[I(" Delete ")])),_:1})):P("",!0)]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};const Vt={class:"d-flex align-center gap-x-4 mb-2"},kt={class:"text-h5 font-weight-medium"},wt={class:"text-body-1"},Dt={class:"d-flex gap-x-2"},Ct={class:"text-h6 font-weight-medium"},$t={class:"d-flex align-center gap-x-4 mb-2"},St={__name:"SaldoCardStatistics",setup($){const p=ge("userData"),i=C([]),f=C(!1),x=C("add"),g=C({}),w=async()=>{var r;try{const{data:v}=await R("/deposits"),h=((r=v.value)==null?void 0:r.data)||[],y=h.reduce((D,z)=>D+z.amount,0);i.value=h.map(D=>({...D,value:new Intl.NumberFormat("id-ID").format(D.amount),change:y>0?parseFloat((D.amount/y*100).toFixed(0)):0,isHover:!1}))}catch(v){o("Failed to fetch deposits.","error"),console.error(v)}};be(w);const a=C(!1),l=C(""),s=C("primary"),o=(r,v="primary")=>{l.value=r,s.value=v,a.value=!0,setTimeout(()=>{a.value=!1},1e4)},u=()=>{x.value="add",g.value={title:"",amount:0,icon:"tabler-building-bank",color:"primary"},f.value=!0},b=r=>{x.value="edit",g.value=JSON.parse(JSON.stringify(r)),f.value=!0},V=async r=>{var y;const{mode:v,data:h}=r;try{let D;if(v==="add"?D=await R("/deposits",{method:"POST",body:JSON.stringify(h),headers:{"Content-Type":"application/json",Accept:"application/json"}}):D=await R(`/deposits/${h.id}`,{method:"PUT",body:JSON.stringify(h),headers:{"Content-Type":"application/json",Accept:"application/json"}}),(y=D.response.value)!=null&&y.ok)o(`Deposit ${v==="add"?"added":"updated"} successfully.`,"success"),w();else{const z=D.data.value,K=z!=null&&z.errors?Object.values(z.errors).flat().join(`
`):(z==null?void 0:z.message)||`Failed to ${v} deposit.`;o(K,"error")}}catch(D){o(`Failed to ${v} deposit.`,"error"),console.error(D)}},m=async r=>{try{await R(`/deposits/${r}`,{method:"DELETE"}),o("Deposit deleted successfully.","success"),w()}catch(v){o("Failed to delete deposit.","error"),console.error(v)}f.value=!1};return(r,v)=>(d(),k(re,null,{default:t(()=>[e(Be,{modelValue:c(a),"onUpdate:modelValue":v[1]||(v[1]=h=>X(a)?a.value=h:null),location:"center",variant:"tonal",transition:"scale-transition",color:c(s),class:"text-center"},{actions:t(()=>[e(j,{color:c(s),onClick:v[0]||(v[0]=h=>a.value=!1)},{default:t(()=>v[3]||(v[3]=[I(" Close ")])),_:1},8,["color"])]),default:t(()=>[I(_(c(l))+" ",1)]),_:1},8,["modelValue","color"]),(d(!0),S(M,null,T(c(i),(h,y)=>(d(),k(A,{key:y,cols:"12",md:c(i).length<=2?6:c(i).length<=4?3:c(i).length<=6?2:6,sm:"6"},{default:t(()=>[n("div",null,[e(B,{class:"logistics-card-statistics cursor-pointer",style:he(h.isHover?{"border-block-end":`2px solid rgba(var(--v-theme-${h.color}))`}:{"border-block-end":`2px solid rgba(var(--v-theme-${h.color}), var(--v-disabled-opacity))`}),onClick:D=>b(h),onMouseenter:D=>h.isHover=!0,onMouseleave:D=>h.isHover=!1},{default:t(()=>[e(U,null,{default:t(()=>[n("div",Vt,[e(G,{variant:"tonal",class:"avatar-hover",color:h.color,rounded:""},{default:t(()=>[e(O,{icon:h.icon,size:"28"},null,8,["icon"])]),_:2},1032,["color"]),n("h5",kt,_(h.value),1)]),n("div",wt,_(h.title),1),n("div",Dt,[n("h6",Ct,_(h.change)+"% ",1),v[4]||(v[4]=n("span",{class:"text-disabled"},"from Total",-1))])]),_:2},1024)]),_:2},1032,["style","onClick","onMouseenter","onMouseleave"])])]),_:2},1032,["md"]))),128)),c(i).length==0||c(i).length%2!==0||c(p).admin_teacher_id?(d(),k(A,{key:0,md:c(i).length<=2?6:c(i).length<=4?3:c(i).length<=6?2:6,cols:"12",sm:"6",onClick:u},{default:t(()=>[n("div",null,[e(B,{class:"logistics-card-statistics cursor-pointer"},{default:t(()=>[e(U,null,{default:t(()=>[n("div",$t,[e(G,{variant:"tonal",class:"avatar-hover",rounded:"",size:"85"},{default:t(()=>[e(O,{size:"42",icon:"tabler-plus"})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["md"])):P("",!0),c(p).admin_teacher_id?(d(),k(xt,{key:1,"is-dialog-visible":c(f),"onUpdate:isDialogVisible":v[2]||(v[2]=h=>X(f)?f.value=h:null),mode:c(x),"selected-data":c(g),onSubmit:V,onDelete:m},null,8,["is-dialog-visible","mode","selected-data"])):P("",!0)]),_:1}))}},Nt=se(St,[["__scopeId","data-v-895108c5"]]),xa={__name:"finance",setup($){const p=ge("userData"),i=C([]),f=C([]),x=C([]),g=C([]),w=C([]),a=C([]),l=C([]),s=C({text:[],value:[]}),o=C([]);C("");async function u(V=""){var K,ie;const r=(await R(`/dashboard-finance?year=${V}`)).data.value;if(console.log("financeData: ",r),!r)return;i.value=r.nonKitchen||[],f.value=r.houseHold||[],x.value=r.students||[],g.value=r.expenses||[],w.value=r.outgoings||[],a.value=r.inputs||[],l.value=r.payCurrentMonth||[];const v=r.payDelivery||[];s.value={text:v.map(N=>N.billing),value:v.map(N=>N.amount>0?Math.round(Number(N.paidAmount)/N.amount*100):0)};const h=((K=r.allocation)==null?void 0:K.finances)||[],y=((ie=r.allocation)==null?void 0:ie.payments)||[],D=h.reduce((N,E)=>N+Number(E.amount),0),z=Array.from(new Set([...h.map(N=>N.allocation),...y.map(N=>N.number)]));o.value=z.map(N=>{const E=h.find(ee=>ee.allocation===N),W=y.find(ee=>ee.number===N),Y=Number((E==null?void 0:E.amount)||0),Q=Number((W==null?void 0:W.amount)||0);return{...E,...W,allocation:(W==null?void 0:W.description)||(E==null?void 0:E.description)||"",payment:Q,expense:Y,balance:Q-Y,percentage:D>0?Y/D*100:0,remain:Y>0?100-Math.round((Q-Y)/Y*100):100}})}const b=V=>{u(V)};return be(()=>u()),(V,m)=>(d(),k(re,{class:"match-height"},{default:t(()=>[e(A,{cols:"12"},{default:t(()=>[e(Nt)]),_:1}),e(A,{cols:"12",md:"6"},{default:t(()=>[e(_t,{data:i.value},null,8,["data"])]),_:1}),e(A,{cols:"12",md:"6"},{default:t(()=>[e(Ke,{data:f.value,onYearSelected:b},null,8,["data"])]),_:1}),c(p).admin_teacher_id?(d(),k(A,{key:0,cols:"12",md:"4"},{default:t(()=>[e(yt,{payments:l.value,students:x.value},null,8,["payments","students"])]),_:1})):P("",!0),e(A,{cols:"12",md:c(p).admin_teacher_id?4:6},{default:t(()=>[e(ht,{data:s.value},null,8,["data"])]),_:1},8,["md"]),e(A,{cols:"12",md:c(p).admin_teacher_id?4:6},{default:t(()=>[e(nt,{data:{expenses:g.value,outgoings:w.value,inputs:a.value}},null,8,["data"])]),_:1},8,["md"]),e(A,{cols:"12"},{default:t(()=>[c(p).admin_teacher_id?(d(),k(je,{key:0,data:o.value},null,8,["data"])):P("",!0)]),_:1})]),_:1}))}};export{xa as default};
