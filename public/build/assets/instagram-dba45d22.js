import{c as P,a as W}from"./formatters-a579ec9f.js";import{i as H,f as K,c as X}from"./fetchProjectData-68a7cbad.js";import{N as Z,F as ee}from"./front-page-navbar-c77e0fd3.js";import{r as m,a6 as te,H as J,b6 as ae,a as q,o as r,f as p,e as l,b as a,z as C,d as o,n,x as c,v as V,c as h,F as L,aV as I,a1 as U,a$ as se,aj as Y,d7 as le,w as oe,f9 as ne,i as O}from"./main-4f88f0ef.js";import{_ as re}from"./AppTextarea-dc54ff33.js";import{_ as ie}from"./AppSelect-0e01f2b7.js";import{t as de,f as me}from"./fetchTeacherData-72ab198b.js";import{_ as ce}from"./InstagramEmbed-aeabf438.js";import{a as B}from"./no-profile-4221a4a6.js";import{$ as ue}from"./api-9abf3ce1.js";import{V as pe}from"./VCardText-9f2226ac.js";import{V as E,a as y}from"./VRow-f91e85cc.js";import{V as F}from"./VAvatar-e5a31aae.js";import{V as A}from"./VImg-68e835e8.js";import{V as z}from"./VRating-d9728d33.js";import{V as ve}from"./VAlert-72287be2.js";import{V as fe}from"./VForm-8272ee06.js";import{V as Q,b as _e,c as he,a as ge}from"./VList-feb05806.js";import{V as G}from"./VCard-63e71bf1.js";import{V as be}from"./VDivider-b9cb0238.js";import"./helpers-86b04518.js";import"./useApi-e555f480.js";import"./AppTextField-0a702a89.js";import"./form-c8cd72fd.js";import"./VTextField-4fe060dc.js";/* empty css                   */import"./VCounter-04ac2a91.js";import"./VField-cac243f5.js";import"./easing-9f15041e.js";import"./VInput-55c72d65.js";import"./forwardRefs-8348545e.js";import"./VNodeRenderer-73a08832.js";import"./useGenerateImageVariant-b18e3e22.js";import"./VChip-fdf96eb5.js";import"./VContainer-c5c24486.js";import"./NavbarThemeSwitcher-6f425a14.js";import"./VTooltip-5ebf368b.js";import"./VOverlay-323f114c.js";import"./lazy-a29a8712.js";import"./scopeId-7cb11928.js";import"./VMenu-ce97e0a3.js";import"./dialog-transition-2ef940ae.js";import"./ssrBoot-78ccd235.js";import"./VNavigationDrawer-fc355904.js";import"./VToolbar-cfb1ebb9.js";import"./VSpacer-087c8f6f.js";import"./VSelect-7d289760.js";import"./VCheckboxBtn-ec3e0aa2.js";import"./VSelectionControl-c713929d.js";import"./index-de6040c1.js";import"./index-9c720871.js";const ye={class:"d-flex justify-space-between align-center mb-2"},Ve={class:"d-flex align-center"},we={class:"text-base text-primary"},xe={class:"text-sm text-medium-emphasis"},ke={class:"d-flex flex-column text-end"},Se={class:"text-sm text-primary"},Ie=["href"],Ne={class:"text-body-1 text-primary"},$e={class:"text-body-2 d-inline"},Te={class:"d-flex align-center mt-4"},Ce={key:1},Le={class:"d-flex flex-column"},Ae={class:"d-flex flex-column"},je={class:"text-base text-primary ms-1"},Re={class:"text-sm text-medium-emphasis cursor-pointer"},Be={class:"text-body-2 mt-2"},De={class:"d-flex justify-space-between my-4 flex-wrap action-icons"},Me={class:""},Pe={key:0,class:"modal-overlay"},Ue={class:"modal-content"},ze={class:"flex-grow-1 overflow-auto d-none",style:{"max-block-size":"100%"}},Ee=["innerHTML"],Fe={__name:"InstagramCard",props:{taskId:Number,taskName:String,description:String,subject:String,theme:String,stars:Number,media:String,postId:String,studentName:String,nickname:String,email:String,teacher:Object,studentImg:String,teacherImg:String,accepted:Number,review:String,date:String},setup(D){const s=D,N=localStorage.getItem("participant"),k=N?JSON.parse(N):null,w=m(!1),v=m(""),f=m(s.teacher),x=m(s.accepted?"Yes":"No"),g=m(s.review),u=m(s.stars),$=m(!!s.accepted),M=te(()=>de.value.map(e=>({title:e.nickname,value:{id:e.id,name:e.nickname}}))),j=e=>{e==="Yes"?$.value=!0:$.value=!1},i=async()=>{if(f.value===""){v.value="Please select a mentor";return}else if(x.value===""){v.value="Please select accepted";return}else if(u.value===0){v.value="Please select a rating";return}else if(g.value===""){v.value="Please write a review";return}else{const e={admin_teacher_id:f.value.id,accepted:x.value=="Yes"?1:0,rate:u.value,review:g.value};console.log("Rating submitted:",e);try{const t=await ue(`/public/update-task-accepted/${s.taskId}`,{method:"POST",body:e,onResponseError({err:b}){v.value=b}});console.log("Rating response:",t),u.value=t.data.rate,g.value=t.data.review}catch(t){console.error("Error submitting rating:",t)}w.value=!1}},_=()=>{(window.scrollY||document.documentElement.scrollTop)>100&&(w.value=!1)};J(()=>{me(),window.addEventListener("scroll",_)}),ae(()=>{window.removeEventListener("scroll",_)});const S=[{prependAvatar:B,title:"Brunch this weekend?",subtitle:`<span class="text-primary">Ali Connors</span> &mdash; I'll be in your neighborhood doing errands this weekend. Do you want to hang out?`},{type:"divider",inset:!0},{prependAvatar:B,title:"Summer BBQ",subtitle:`<span class="text-primary">to Alex, Scott, Jennifer</span> &mdash; Wish I could come, but I'm out of town this weekend.`},{type:"divider",inset:!0}];return(e,t)=>{const b=q("RouterLink"),T=ie,R=re;return r(),p(G,{class:"mb-4"},{default:l(()=>[a(pe,null,{default:l(()=>[a(E,null,{default:l(()=>[a(y,{cols:"12",md:"6",class:"border border-red"},{default:l(()=>[s.media=="Instagram"?(r(),p(ce,{key:0,"post-id":s.postId},null,8,["post-id"])):C("",!0)]),_:1}),a(y,{cols:"12",md:"6"},{default:l(()=>[o("div",null,[o("div",ye,[o("div",Ve,[a(F,{size:"34",variant:"tonal",color:"primary",class:"me-3"},{default:l(()=>[s.studentImg?(r(),p(A,{key:0,src:`/storage/${s.studentImg}`,cover:""},null,8,["src"])):(r(),p(A,{key:1,src:n(B)},null,8,["src"]))]),_:1}),a(b,{to:`/?search=${("abbreviateName"in e?e.abbreviateName:n(P))(s.studentName,10,1).toLowerCase()}`,class:"d-flex flex-column"},{default:l(()=>[o("h6",we,c(("abbreviateName"in e?e.abbreviateName:n(P))(s.studentName,30,3)),1),o("span",xe,c(s.email||s.nickname),1)]),_:1},8,["to"])]),o("div",ke,[o("small",Se,c(new Date(s.date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})),1),o("a",{href:`/?search=${s.taskId}`,class:"text-sm text-medium-emphasis"},c(s.taskId),9,Ie)])]),t[11]||(t[11]=o("hr",{class:"my-custom-line"},null,-1)),a(b,{to:`/?search=${("abbreviateName"in e?e.abbreviateName:n(P))(s.theme,30,4).toLowerCase()}`,class:"d-flex flex-column"},{default:l(()=>[o("p",Ne,c(s.subject+": "+s.theme),1)]),_:1},8,["to"]),o("p",$e,[a(b,{to:`/?search=${D.taskId}`,class:"text-primary"},{default:l(()=>[V(c(s.taskName.split(" ").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" ")),1)]),_:1},8,["to"]),V(" "+c(s.description),1)]),o("div",Te,[a(F,{size:s.accepted?void 0:34,color:s.accepted?void 0:e.warning,variant:"tonal",class:"me-3"},{default:l(()=>[s.accepted?(r(),h(L,{key:0},[s.teacherImg?(r(),p(A,{key:0,src:`/storage/${s.teacherImg}`,cover:""},null,8,["src"])):(r(),p(A,{key:1,src:n(B)},null,8,["src"]))],64)):(r(),h("span",Ce,c(("avatarText"in e?e.avatarText:n(W))(n(f).name)),1))]),_:1},8,["size","color"]),o("div",Le,[o("div",Ae,[o("h6",je,c(n(f).name),1)]),o("div",Re,[n(k)&&n(k).role>1?(r(),h("div",{key:0,class:"d-flex flex-column",onClick:t[1]||(t[1]=d=>w.value=!0)},[a(z,{modelValue:n(u),"onUpdate:modelValue":t[0]||(t[0]=d=>I(u)?u.value=d:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])])):(r(),p(b,{key:1,to:"/front/bookmark",class:"d-flex flex-column"},{default:l(()=>[a(z,{modelValue:n(u),"onUpdate:modelValue":t[2]||(t[2]=d=>I(u)?u.value=d:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])]),_:1}))])])]),o("p",Be,c(n(g)),1),t[12]||(t[12]=o("hr",{class:"my-custom-line"},null,-1)),o("div",De,[o("div",Me,[a(U,{icon:"tabler-message-2"}),a(U,{icon:"tabler-heart",class:"ms-2"})]),a(U,{icon:"tabler-bookmark"})]),n(w)?(r(),h("div",Pe,[o("div",Ue,[n(v)?(r(),p(ve,{key:0,type:"error",class:"mb-5",dismissible:"",onClick:t[3]||(t[3]=d=>v.value="")},{default:l(()=>[V(c(n(v)),1)]),_:1})):C("",!0),a(fe,{onSubmit:se(d=>({}),["prevent"])},{default:l(()=>[a(E,null,{default:l(()=>[a(y,{cols:"12"},{default:l(()=>[a(T,{modelValue:n(f),"onUpdate:modelValue":t[4]||(t[4]=d=>I(f)?f.value=d:null),label:"Mentor",placeholder:"Select Mentor",items:n(M),"item-title":"value.name","item-value":"value"},null,8,["modelValue","items"])]),_:1}),a(y,{cols:"12"},{default:l(()=>[a(T,{modelValue:n(x),"onUpdate:modelValue":[t[5]||(t[5]=d=>I(x)?x.value=d:null),j],label:"Accepted",placeholder:"Not Accepted",items:["Yes","No"]},null,8,["modelValue"])]),_:1}),n($)?(r(),p(y,{key:0,cols:"12",class:"text-center"},{default:l(()=>[a(z,{modelValue:n(u),"onUpdate:modelValue":t[6]||(t[6]=d=>I(u)?u.value=d:null),"half-increments":"",hover:""},null,8,["modelValue"]),a(R,{modelValue:n(g),"onUpdate:modelValue":t[7]||(t[7]=d=>I(g)?g.value=d:null),placeholder:"Write your review...",rows:3},null,8,["modelValue"])]),_:1})):C("",!0),a(y,{cols:"12",class:"mt-4"},{default:l(()=>[a(Y,{type:"submit",class:"me-2",onClick:i},{default:l(()=>t[9]||(t[9]=[V(" Save ")])),_:1}),a(Y,{color:"secondary",class:"me-2",onClick:t[8]||(t[8]=d=>w.value=!1)},{default:l(()=>t[10]||(t[10]=[V(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})])])):C("",!0),o("div",ze,[a(Q,{lines:"three",items:S,"item-props":""},{subtitle:l(({subtitle:d})=>[o("div",{innerHTML:d},null,8,Ee)]),_:1})])])]),_:1})]),_:1})]),_:1})]),_:1})}}};const He={class:"landing-page-wrapper"},Ye={class:"instagram-card"},Oe={key:1},Ht={__name:"instagram",setup(D){const s=m(null),N=m([]),k=m(!1),w=m(2);console.log("instagramTasks:",H.value),J(async()=>{var i;await K(),s.value=(i=H.value)==null?void 0:i.data,s.value&&j(),window.addEventListener("scroll",v)});const v=async()=>{var S;const i=window.scrollY+window.innerHeight,_=document.documentElement.scrollHeight-10;if(i>=_&&!k.value){k.value=!0;const e=await X(w.value++);(S=e.data)!=null&&S.length&&(s.value.push(...e.data),j()),k.value=!1}},f=m(),x=m(),g=m(),u=m(),$=m(),M=m();function j(){N.value=[{type:"subheader",title:"Best of the Week"},...s.value.filter(i=>i.rate>=4).flatMap(i=>{var _;return[{prependAvatar:le,title:((_=i.admin_student)==null?void 0:_.name)||"Unknown Student",subtitle:i.name||"No Task Name"},{type:"divider",inset:!0}]})]}return oe(s,i=>{console.log("Task data updated:",i)}),ne([x,g,u,$,M],([{isIntersecting:i,target:_}])=>{i&&(f.value=_.id)},{threshold:.25}),(i,_)=>{const S=q("VSubheader");return r(),h(L,null,[o("div",He,[a(Z,{"active-id":f.value},null,8,["active-id"]),o("div",Ye,[a(E,{class:"m-0 p-0"},{default:l(()=>[a(y,{class:"d-none d-lg-block",cols:"12",lg:"3"},{default:l(()=>[a(G,{style:{position:"sticky","inset-block-start":"6rem"}},{default:l(()=>[a(Q,{lines:"three"},{default:l(()=>[(r(!0),h(L,null,O(N.value,(e,t)=>(r(),h(L,{key:t},[e.prependAvatar?(r(),p(ge,{key:0,class:"custom-list-item"},{prepend:l(()=>[a(F,{size:"34",variant:"tonal",color:"primary",class:"me-3"},{default:l(()=>[i.avatar?(r(),p(A,{key:0,src:i.avatar},null,8,["src"])):(r(),h("span",Oe,c(("avatarText"in i?i.avatarText:n(W))(e.title)),1))]),_:2},1024)]),default:l(()=>[a(_e,null,{default:l(()=>[V(c(e.title),1)]),_:2},1024),a(he,null,{default:l(()=>[V(c(e.subtitle),1)]),_:2},1024)]),_:2},1024)):e.type==="divider"?(r(),p(be,{key:`divider-${t}`,inset:""})):e.type==="subheader"?(r(),p(S,{key:2,class:"ps-3 mb-2 font-weight-medium text-primary"},{default:l(()=>[V(c(e.title),1)]),_:2},1024)):C("",!0)],64))),128))]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"9"},{default:l(()=>[o("div",null,[(r(!0),h(L,null,O(s.value,e=>{var t,b,T,R;return r(),h("div",{key:e.id},[a(Fe,{"task-id":e.id,"task-name":e.name,"task-date":e.date,description:e.description,subject:e.project_plan.subject,theme:e.project_plan.theme,stars:e.rate,media:e.media,"post-id":((b=(t=e.link)==null?void 0:t.match(/\/(?:p|reel)\/([\w-]+)/))==null?void 0:b[1])||"N/A","student-name":e.admin_student.name,nickname:e.admin_student.nickname,email:e.admin_student.email,teacher:e.admin_teacher?{id:e.admin_teacher.id,name:e.admin_teacher.nickname}:"Not Accepted","student-img":(T=e.admin_student)==null?void 0:T.image,"teacher-img":(R=e.admin_teacher)==null?void 0:R.image,accepted:e.accepted,review:(e==null?void 0:e.review)||null,date:e.date},null,8,["task-id","task-name","task-date","description","subject","theme","stars","media","post-id","student-name","nickname","email","teacher","student-img","teacher-img","accepted","review","date"])])}),128))])]),_:1})]),_:1})])]),a(ee)],64)}}};export{Ht as default};
