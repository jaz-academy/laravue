import{a as E}from"./formatters-6300d5fa.js";import{a6 as w,a as L,o as c,f as C,e as i,b as a,s as P,n as d,a1 as x,K as b,v as r,x as u,L as g,c as h,F as $,i as D,z as A,d as y,y as I,a$ as R,aj as M,r as U,b0 as q}from"./main-b871c247.js";import{P as F}from"./vue3-perfect-scrollbar.esm-1b05bf3b.js";import{V as z}from"./VBadge-825ab8b2.js";import{V as O}from"./VMenu-8c238fe7.js";import{V as j,a as K,b as G,c as H}from"./VCard-b2c7daaa.js";import{V as J}from"./VTooltip-33e7a5fa.js";import{V as N}from"./VDivider-adb1395f.js";import{V as Q,a as T,b as B,c as W}from"./VList-5ecced89.js";import{V as X}from"./VListItemAction-39ddfddc.js";import{V as Y}from"./VAvatar-8e3ed6ed.js";import{u as k}from"./useApi-e86a5383.js";import"./helpers-29c4dea8.js";import"./no-profile-29bc384c.js";import"./VImg-8fc3d1b5.js";import"./VOverlay-6dc4db6e.js";import"./easing-9f15041e.js";import"./lazy-b1156225.js";import"./scopeId-bd2d2045.js";import"./forwardRefs-8348545e.js";import"./dialog-transition-d47abf0e.js";import"./VCardText-de098736.js";import"./ssrBoot-f3061ed5.js";const Z={key:0},ee={class:"text-xs text-disabled"},te={class:"d-flex flex-column align-center gap-4"},ae={style:{"block-size":"28px","inline-size":"28px"}},ie={__name:"Notifications",props:{notifications:{type:Array,required:!0},badgeProps:{type:null,required:!1,default:void 0},location:{type:null,required:!1,default:"bottom end"}},emits:["read","unread","remove","click:notification"],setup(S,{emit:p}){const n=S,l=p,m=w(()=>n.notifications.every(s=>s.isSeen)),_=()=>{const s=n.notifications.map(e=>e.id);m.value?l("unread",s):l("read",s)},V=w(()=>n.notifications.filter(s=>s.isSeen===!1).length);return(s,e)=>{const o=L("IconBtn");return c(),C(o,{id:"notification-btn"},{default:i(()=>[a(z,P(n.badgeProps,{"model-value":n.notifications.some(t=>!t.isSeen),color:"error",content:d(V),class:"notification-badge"}),{default:i(()=>[a(x,{size:"26",icon:"tabler-bell"})]),_:1},16,["model-value","content"]),a(O,{activator:"parent",width:"380px",location:n.location,offset:"14px","close-on-content-click":!1},{default:i(()=>[a(j,{class:"d-flex flex-column"},{default:i(()=>[a(K,{class:"notification-section"},{append:i(()=>[b(a(o,{onClick:_},{default:i(()=>[a(x,{icon:d(m)?"tabler-mail-opened":"tabler-mail"},null,8,["icon"]),a(J,{activator:"parent",location:"start"},{default:i(()=>[r(u(d(m)?"Mark all as read":"Mark all as unread"),1)]),_:1})]),_:1},512),[[g,n.notifications.length]])]),default:i(()=>[a(G,{class:"text-lg"},{default:i(()=>e[0]||(e[0]=[r(" Notifications ")])),_:1})]),_:1}),a(N),a(d(F),{options:{wheelPropagation:!1},style:{"max-block-size":"23.75rem"}},{default:i(()=>[a(Q,{class:"notification-list rounded-0 py-0"},{default:i(()=>[(c(!0),h($,null,D(n.notifications,(t,v)=>(c(),h($,{key:t.title},[v>0?(c(),C(N,{key:0})):A("",!0),a(T,{link:"",lines:"one","min-height":"66px",class:"list-item-hover-class",onClick:f=>s.$emit("click:notification",t)},{prepend:i(()=>[a(X,{start:""},{default:i(()=>[a(Y,{size:"40",color:t.color&&t.icon?t.color:void 0,image:t.img||void 0,icon:t.icon||void 0,variant:t.img?void 0:"tonal"},{default:i(()=>[t.text?(c(),h("span",Z,u(("avatarText"in s?s.avatarText:d(E))(t.text)),1)):A("",!0)]),_:2},1032,["color","image","icon","variant"])]),_:2},1024)]),append:i(()=>[y("div",te,[a(z,{dot:"",color:t.isSeen?"#a8aaae":"primary",class:I(`${t.isSeen?"visible-in-hover":""} ms-1`),onClick:R(f=>s.$emit(t.isSeen?"unread":"read",[t.id]),["stop"])},null,8,["color","class","onClick"]),y("div",ae,[a(o,{size:"small",class:"visible-in-hover",onClick:f=>s.$emit("remove",t.id)},{default:i(()=>[a(x,{size:"20",icon:"tabler-x"})]),_:2},1032,["onClick"])])])]),default:i(()=>[a(B,{class:"font-weight-medium"},{default:i(()=>[r(u(t.title),1)]),_:2},1024),a(W,null,{default:i(()=>[r(u(t.subtitle),1)]),_:2},1024),y("span",ee,u(t.time),1)]),_:2},1032,["onClick"])],64))),128)),b(a(T,{class:"text-center text-medium-emphasis",style:{"block-size":"56px"}},{default:i(()=>[a(B,null,{default:i(()=>e[1]||(e[1]=[r("No Notification Found!")])),_:1})]),_:1},512),[[g,!n.notifications.length]])]),_:1})]),_:1}),a(N),b(a(H,{class:"notification-footer"},{default:i(()=>[a(M,{block:""},{default:i(()=>e[2]||(e[2]=[r(" View All Notifications ")])),_:1})]),_:1},512),[[g,n.notifications.length]])]),_:1})]),_:1},8,["location"])]),_:1})}}},we={__name:"NavBarNotifications",setup(S){const{data:p,error:n}=k("/notifications").json(),l=U([]);q(()=>{Array.isArray(p.value)&&(l.value=p.value.map(e=>{var o,t,v,f;return{id:e.id,title:((o=e.data)==null?void 0:o.title)??"Notification",subtitle:((t=e.data)==null?void 0:t.message)??"",img:(v=e.data)==null?void 0:v.img,text:((f=e.data)==null?void 0:f.text)||"Abu Kafa",time:new Date(e.created_at).toLocaleString(),isSeen:e.read_at!==null}}))});const m=async e=>{await k(`/notifications/${e}`,{method:"DELETE"}),l.value=l.value.filter(o=>o.id!==e)},_=async e=>{await k(`/notifications/${e}/read`,{method:"POST"}),l.value.forEach(o=>{e.forEach(t=>{t===o.id&&(o.isSeen=!0)})})},V=async e=>{await k(`/notifications/${e}/unread`,{method:"POST"}),l.value.forEach(o=>{e.forEach(t=>{t===o.id&&(o.isSeen=!1)})})},s=e=>{e.isSeen||_([e.id])};return(e,o)=>{const t=ie;return c(),C(t,{notifications:d(l),onRemove:m,onRead:_,onUnread:V,"onClick:notification":s},null,8,["notifications"])}}};export{we as default};
