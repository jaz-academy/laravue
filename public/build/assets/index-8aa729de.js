import{r as d,a6 as Q,H as J,b6 as W,a as G,o as i,f as v,e as r,b as o,z as V,d as s,n,x as _,c as g,aV as S,a1 as N,v as M,a$ as Z,aj as H,j as X,k as ee,w as te,aZ as ae,b7 as se,K as oe,b8 as le,b9 as re,F as ne,i as ie}from"./main-4f88f0ef.js";import{u as ce}from"./useApi-e555f480.js";import{N as me,F as de}from"./front-page-navbar-c77e0fd3.js";import{H as ue}from"./hero-section-71fa7dda.js";import{_ as pe}from"./AppTextarea-dc54ff33.js";import{_ as ve}from"./AppSelect-0e01f2b7.js";import{c as B}from"./formatters-a579ec9f.js";import{a as T}from"./no-profile-4221a4a6.js";import{_ as fe}from"./GDriveEmbed-a63b6ac5.js";import{_ as _e}from"./InstagramEmbed-aeabf438.js";import{t as he,f as ge}from"./fetchTeacherData-72ab198b.js";import{$ as ye}from"./api-9abf3ce1.js";import{V as xe}from"./VCardText-9f2226ac.js";import{V as Y,a as $}from"./VRow-f91e85cc.js";import{V as K}from"./VAvatar-e5a31aae.js";import{V as R}from"./VImg-68e835e8.js";import{V as D}from"./VRating-d9728d33.js";import{V as be}from"./VAlert-72287be2.js";import{V as ke}from"./VForm-8272ee06.js";import{V as we}from"./VList-feb05806.js";import{V as Ve}from"./VCard-63e71bf1.js";import"./AppTextField-0a702a89.js";import"./form-c8cd72fd.js";import"./VTextField-4fe060dc.js";/* empty css                   */import"./VCounter-04ac2a91.js";import"./VField-cac243f5.js";import"./easing-9f15041e.js";import"./VInput-55c72d65.js";import"./forwardRefs-8348545e.js";import"./VNodeRenderer-73a08832.js";import"./useGenerateImageVariant-b18e3e22.js";import"./VChip-fdf96eb5.js";import"./VContainer-c5c24486.js";import"./NavbarThemeSwitcher-6f425a14.js";import"./VTooltip-5ebf368b.js";import"./VOverlay-323f114c.js";import"./lazy-a29a8712.js";import"./scopeId-7cb11928.js";import"./VMenu-ce97e0a3.js";import"./dialog-transition-2ef940ae.js";import"./VNavigationDrawer-fc355904.js";import"./ssrBoot-78ccd235.js";import"./VToolbar-cfb1ebb9.js";import"./VSpacer-087c8f6f.js";import"./hero-elements-light-b61b0468.js";/* empty css                 */import"./VSelect-7d289760.js";import"./VCheckboxBtn-ec3e0aa2.js";import"./VSelectionControl-c713929d.js";import"./helpers-86b04518.js";import"./index-de6040c1.js";import"./index-9c720871.js";import"./VDivider-b9cb0238.js";const Se={class:"d-flex justify-space-between align-center mb-2"},$e={class:"d-flex align-center"},Ie={class:"text-base text-primary"},Ne={class:"text-sm text-medium-emphasis"},Ce={class:"d-flex flex-column text-end"},je={class:"text-sm text-primary"},Ae=["href"],Te={class:"text-body-1 text-primary"},Re={class:"text-body-2 d-inline"},Me=["href"],Le=["href"],Ue={class:"d-flex align-center mt-4"},Pe={class:"d-flex flex-column"},Be={class:"font-weight-medium text-link ps-1"},De={class:"text-base text-primary ms-1"},He={class:"text-sm text-medium-emphasis cursor-pointer"},qe={class:"text-body-2 mt-2"},ze={class:"d-flex justify-space-between my-4 flex-wrap action-icons"},Ee={class:""},Oe={key:0,class:"modal-overlay"},Fe={class:"modal-content"},Ye={class:"flex-grow-1 overflow-auto d-none",style:{"max-block-size":"100%"}},Ke=["innerHTML"],Qe={__name:"HomeCard",props:{taskId:Number,taskName:String,description:String,subject:String,theme:String,stars:String,media:String,postId:String,studentName:String,nickname:String,email:String,teacher:Object,review:String,studentImg:String,teacherImg:String,accepted:Number,link:String,date:String},setup(L){const t=L,C=localStorage.getItem("participant"),y=C?JSON.parse(C):null,x=d(!1),p=d(""),f=d(t.teacher),k=d(t.accepted?"Yes":"No"),h=d(t.review),c=d(t.stars),b=d(!!t.accepted),U=Q(()=>he.value.map(u=>({title:u.nickname,value:{id:u.id,name:u.nickname}}))),P=u=>{u==="Yes"?b.value=!0:b.value=!1},w=async()=>{if(f.value===""){p.value="Please select a mentor";return}else if(k.value===""){p.value="Please select accepted";return}else if(c.value===0){p.value="Please select a rating";return}else if(h.value===""){p.value="Please write a review";return}else{const u={admin_teacher_id:f.value.id,accepted:k.value=="Yes"?1:0,rate:c.value,review:h.value};console.log("Rating submitted:",u);try{const e=await ye(`/public/update-task-accepted/${t.taskId}`,{method:"POST",body:u,onResponseError({err:m}){p.value=m}});console.log("Rating response:",e),c.value=e.data.rate,h.value=e.data.review}catch(e){console.error("Error submitting rating:",e)}x.value=!1}},j=()=>{(window.scrollY||document.documentElement.scrollTop)>100&&(x.value=!1)};J(()=>{ge(),window.addEventListener("scroll",j)}),W(()=>{window.removeEventListener("scroll",j)});const I=[{prependAvatar:T,title:"Brunch this weekend?",subtitle:`<span class="text-primary">Ali Connors</span> &mdash; I'll be in your neighborhood doing errands this weekend. Do you want to hang out?`},{type:"divider",inset:!0},{prependAvatar:T,title:"Summer BBQ",subtitle:`<span class="text-primary">to Alex, Scott, Jennifer</span> &mdash; Wish I could come, but I'm out of town this weekend.`},{type:"divider",inset:!0}];return(u,e)=>{const m=G("RouterLink"),a=ve,A=pe;return i(),v(Ve,{class:"posting-card"},{default:r(()=>[o(xe,null,{default:r(()=>[o(Y,null,{default:r(()=>[o($,{cols:"12",md:"7"},{default:r(()=>[t.media=="Google Drive"?(i(),v(fe,{key:0,"post-id":t.postId},null,8,["post-id"])):V("",!0),t.media=="Instagram"?(i(),v(_e,{key:1,"post-id":t.postId},null,8,["post-id"])):V("",!0)]),_:1}),o($,{cols:"12",md:"5"},{default:r(()=>[s("div",null,[s("div",Se,[s("div",$e,[o(K,{size:"34",variant:"tonal",color:"primary",class:"me-3"},{default:r(()=>[t.studentImg?(i(),v(R,{key:0,src:`/storage/${t.studentImg}`,cover:""},null,8,["src"])):(i(),v(R,{key:1,src:n(T)},null,8,["src"]))]),_:1}),o(m,{to:`/?search=${n(B)(t.studentName,10,1).toLowerCase()}`,class:"d-flex flex-column"},{default:r(()=>[s("h6",Ie,_(n(B)(t.studentName,30,3)),1),s("span",Ne,_(t.email||t.nickname),1)]),_:1},8,["to"])]),s("div",Ce,[s("small",je,_(new Date(t.date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})),1),s("a",{href:`/?search=${t.taskId}`,class:"text-sm text-medium-emphasis"},_(t.taskId),9,Ae)])]),e[11]||(e[11]=s("hr",{class:"my-custom-line"},null,-1)),o(m,{to:`/?search=${n(B)(t.theme,30,4).toLowerCase()}`,class:"d-flex flex-column"},{default:r(()=>[s("p",Te,_(t.subject+": "+t.theme),1)]),_:1},8,["to"]),s("p",Re,[s("a",{href:t.link?t.link:`/?search=${t.taskId}`,class:"text-primary",target:"_blank",rel:"noopener noreferrer"},_(t.taskName.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),9,Me),s("a",{href:L.link,target:"_blank",rel:"noopener noreferrer",class:"text-secondary"},_(" "+t.description),9,Le)]),s("div",Ue,[o(K,{size:"34",variant:"tonal",class:"me-3",color:t.accepted?"primary":"warning"},{default:r(()=>[t.teacherImg?(i(),v(R,{key:0,src:`/storage/${t.teacherImg}`,cover:""},null,8,["src"])):(i(),v(R,{key:1,src:n(T)},null,8,["src"]))]),_:1},8,["color"]),s("div",Pe,[s("div",Be,[s("h6",De,_(n(f).name),1)]),s("div",He,[n(y)&&n(y).role>1?(i(),g("div",{key:0,class:"d-flex flex-column",onClick:e[1]||(e[1]=l=>x.value=!0)},[o(D,{modelValue:n(c),"onUpdate:modelValue":e[0]||(e[0]=l=>S(c)?c.value=l:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])])):(i(),v(m,{key:1,to:"/front/bookmark",class:"d-flex flex-column"},{default:r(()=>[o(D,{modelValue:n(c),"onUpdate:modelValue":e[2]||(e[2]=l=>S(c)?c.value=l:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])]),_:1}))])])]),s("p",qe,_(n(h)),1),e[12]||(e[12]=s("hr",{class:"my-custom-line"},null,-1)),s("div",ze,[s("div",Ee,[o(N,{icon:"tabler-heart"}),o(N,{icon:"tabler-message-2",class:"ms-2"})]),o(N,{icon:"tabler-bookmark"})]),n(x)?(i(),g("div",Oe,[s("div",Fe,[n(p)?(i(),v(be,{key:0,type:"error",class:"mb-5",dismissible:"",onClick:e[3]||(e[3]=l=>p.value="")},{default:r(()=>[M(_(n(p)),1)]),_:1})):V("",!0),o(ke,{onSubmit:Z(l=>({}),["prevent"])},{default:r(()=>[o(Y,null,{default:r(()=>[o($,{cols:"12"},{default:r(()=>[o(a,{modelValue:n(f),"onUpdate:modelValue":e[4]||(e[4]=l=>S(f)?f.value=l:null),label:"Mentor",placeholder:"Select Mentor",items:n(U),"item-title":"value.name","item-value":"value"},null,8,["modelValue","items"])]),_:1}),o($,{cols:"12"},{default:r(()=>[o(a,{modelValue:n(k),"onUpdate:modelValue":[e[5]||(e[5]=l=>S(k)?k.value=l:null),P],label:"Accepted",placeholder:"Not Accepted",items:["Yes","No"]},null,8,["modelValue"])]),_:1}),n(b)?(i(),v($,{key:0,cols:"12",class:"text-center"},{default:r(()=>[o(D,{modelValue:n(c),"onUpdate:modelValue":e[6]||(e[6]=l=>S(c)?c.value=l:null),"half-increments":"",hover:""},null,8,["modelValue"]),o(A,{modelValue:n(h),"onUpdate:modelValue":e[7]||(e[7]=l=>S(h)?h.value=l:null),placeholder:"Write your review...",rows:3},null,8,["modelValue"])]),_:1})):V("",!0),o($,{cols:"12",class:"mt-4"},{default:r(()=>[o(H,{type:"submit",class:"me-2",onClick:w},{default:r(()=>e[9]||(e[9]=[M(" Save ")])),_:1}),o(H,{color:"secondary",class:"me-2",onClick:e[8]||(e[8]=l=>x.value=!1)},{default:r(()=>e[10]||(e[10]=[M(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})])])):V("",!0),s("div",Ye,[o(we,{lines:"three",items:I,"item-props":""},{subtitle:r(({subtitle:l})=>[s("div",{innerHTML:l},null,8,Ke)]),_:1})])])]),_:1})]),_:1})]),_:1})]),_:1})}}};const Je={class:"landing-page-wrapper"},We={key:1,class:"text-center sticky-header bg-background pb-8"},Ge={class:"input-group mt-16 justify-center",style:{display:"flex","align-items":"center",gap:"0.5rem"}},Ze=["href"],Xe={key:2,class:"text-center my-16 py-2"},et={key:0,class:"flex justify-center items-center"},tt={key:1,class:"text-gray-400"},aa={__name:"index",setup(L){const t=X(),C=ee(),y=d(t.query.search||""),x=Q(()=>Object.keys(t.query).length>0),p=d([]),f=d(1),k=d(3),h=d(t.query.search||""),c=d(!1),b=d(!0),U=d(null),P=d(null),w=d(null),j=()=>{C.push({query:{...t.query,search:y.value}})},I=async()=>{var a;if(c.value||!b.value)return;c.value=!0;const{data:e}=await ce(`/public/tasks?page=${f.value}&perPage=${k.value}&search=${h.value}&rates=5`),m=((a=e.value)==null?void 0:a.data)||[];m.length?(p.value.push(...m),f.value++):b.value=!1,c.value=!1};te(()=>t.query.search,async e=>{y.value=e||"",f.value=1,p.value=[],b.value=!0,await I(),console.log(p.value)});let u;return J(async()=>{await I(),await ae(),w.value&&(u=new IntersectionObserver(e=>{e[0].isIntersecting&&I()}),u.observe(w.value))}),se(()=>{u&&w.value&&u.unobserve(w.value)}),(e,m)=>(i(),g("div",Je,[o(me,{"active-id":U.value},null,8,["active-id"]),x.value?V("",!0):(i(),v(ue,{key:0,ref:"refHome",class:"mb-16"},null,512)),x.value?(i(),g("div",We,[m[1]||(m[1]=s("br",null,null,-1)),m[2]||(m[2]=s("br",null,null,-1)),s("div",Ge,[oe(s("input",{"onUpdate:modelValue":m[0]||(m[0]=a=>y.value=a),type:"text",placeholder:"Search by Id, Name, Mentor, Theme...",class:"border w-50 px-3 py-2 rounded",onKeyup:re(j,["enter"])},null,544),[[le,y.value]]),s("a",{href:`?search=${encodeURIComponent(y.value)}`,class:"btn btn-primary"},[o(H,null,{default:r(()=>[o(N,{icon:"tabler-search"})]),_:1})],8,Ze)])])):(i(),g("div",Xe," . ")),s("div",{id:"content-post",ref_key:"scrollContainer",ref:P},[(i(!0),g(ne,null,ie(p.value,a=>{var A,l,q,z,E,O,F;return i(),g("div",{key:a.id},[o(Qe,{class:"card-post","task-id":a.id,"task-name":a.name,description:a.description,subject:a.project_plan.subject,theme:a.project_plan.theme,stars:a.rate,media:a.media,"post-id":a.media=="Instagram"?(l=(A=a.link)==null?void 0:A.match(/\/(?:p|reel)\/([\w-]+)/))==null?void 0:l[1]:((z=(q=a.link)==null?void 0:q.match(/\/d\/(.*?)\//))==null?void 0:z[1])||"N/A","student-name":a.admin_student.name,nickname:a.admin_student.nickname,email:a.admin_student.email,mentor:((E=a.admin_teacher)==null?void 0:E.nickname)||"Not Accepted",review:(a==null?void 0:a.review)||null,teacher:a.admin_teacher?{id:a.admin_teacher.id,name:a.admin_teacher.nickname}:"Not Accepted","student-img":(O=a.admin_student)==null?void 0:O.image,"teacher-img":(F=a.admin_teacher)==null?void 0:F.image,accepted:a.accepted,link:a.link,date:a.date},null,8,["task-id","task-name","description","subject","theme","stars","media","post-id","student-name","nickname","email","mentor","review","teacher","student-img","teacher-img","accepted","link","date"])])}),128)),s("div",{ref_key:"loadMoreTrigger",ref:w,class:"py-4 text-center text-gray-400"},[c.value?(i(),g("div",et,[o(N,{icon:"mdi-loading",spin:"",class:"mr-2"}),m[3]||(m[3]=M(" Loading... "))])):b.value?V("",!0):(i(),g("div",tt," No more tasks. "))],512)],512),o(de)]))}};export{aa as default};
