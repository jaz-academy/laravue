import{_ as q}from"./AppTextField-a9d65adc.js";import{_ as F}from"./AppSelect-1495259f.js";import{r as m,j as E,k as z,H as O,a as G,o as V,f as y,e as l,b as a,d as i,n as u,I as H,a$ as J,aj as Z,v as k,a0 as b,aZ as K}from"./main-e40851b7.js";import{f as Q,s as W}from"./fetchStudentData-18e5af88.js";import{f as X,t as Y}from"./fetchTeacherData-86645937.js";import{u as ee}from"./useAbility-3ced6271.js";import{a as ae,b as te,c as le,d as oe}from"./auth-v2-register-illustration-light-25193346.js";import{a as se,b as re}from"./misc-mask-light-a3cab517.js";import{V as ie}from"./VNodeRenderer-b3a0c65a.js";import{u as S}from"./useGenerateImageVariant-99d63f92.js";import{$ as ne}from"./api-e6efa3e7.js";import{V as I}from"./VImg-d0687b57.js";import{a as r,V as x}from"./VRow-f8693abc.js";import{V as ue}from"./VCard-c8ea4733.js";import{V as T}from"./VCardText-e11304cd.js";import{V as de}from"./VForm-4a2fa4d7.js";import{V as me}from"./VSwitch-af41bfe7.js";import{V as pe}from"./VCheckbox-49b0f7b1.js";import{V as ce}from"./form-c3e0076b.js";import"./VTextField-bbc7a2fc.js";/* empty css                   */import"./VCounter-f770fb79.js";import"./VField-a2644e25.js";import"./easing-9f15041e.js";import"./VInput-6eaa5e55.js";import"./forwardRefs-8348545e.js";import"./VSelect-28fcf519.js";import"./VList-deb9c324.js";import"./ssrBoot-282be025.js";import"./VAvatar-43d2e5c8.js";import"./VDivider-06554ebe.js";import"./dialog-transition-13233f06.js";import"./VMenu-57cdd853.js";import"./VOverlay-c77512d0.js";import"./lazy-924c41e8.js";import"./scopeId-4e41f258.js";import"./VCheckboxBtn-d41b44e1.js";import"./VSelectionControl-6e4301a8.js";import"./VChip-f703cea5.js";import"./useApi-765b1997.js";import"./index-8c7cbe3e.js";import"./index-9c720871.js";const fe={class:"position-relative bg-background rounded-lg w-100 ma-8 me-0"},ve={class:"d-flex align-center justify-center w-100 h-100"},Ve={class:"demo-space-x"},ye={class:"d-flex align-center mt-2 mb-4"},ia={__name:"register",setup(be){const R=S(oe,le,te,ae,!0),C=S(re,se),g=m(),c=m(!0),o=m({adminStudentId:"Select",adminTeacherId:"Select",email:"lubna@jazacademy.id",password:"",passwordConfirmation:"",privacyPolicies:!1}),h=E(),j=z(),M=ee(),n=m(!1),P=m({}),A=m(""),v=s=>!!s||"This field is required",D=s=>/.+@.+\..+/.test(s)||"E-mail must be valid",N=s=>e=>e===s||"Password does not match";O(async()=>{await Q(),await X()});const U=async()=>{var e,p,d,f;const s={...o.value,adminStudentId:((e=o.value.adminStudentId)==null?void 0:e.id)||null,adminTeacherId:((p=o.value.adminTeacherId)==null?void 0:p.id)||null,name:((d=o.value.adminStudentId)==null?void 0:d.name)||((f=o.value.adminTeacherId)==null?void 0:f.name)};try{const t=await ne("/auth/register",{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"},onResponseError({response:_}){P.value=_._data.errors,A.value=_._data.message||"Register failed"}}),{accessToken:B,userData:L,userAbilityRules:w}=t;b("userAbilityRules").value=w,M.update(w),b("userData").value=L,b("accessToken").value=B,await K(()=>{j.replace(h.query.to?String(h.query.to):"/login")})}catch(t){console.error(t)}},$=()=>{var s;(s=g.value)==null||s.validate().then(({valid:e})=>{e&&U()})};return(s,e)=>{const p=F,d=q,f=G("RouterLink");return V(),y(x,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:l(()=>[a(r,{md:"8",class:"d-none d-md-flex"},{default:l(()=>[i("div",fe,[i("div",ve,[a(I,{"max-width":"441",src:u(R),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),a(I,{class:"auth-footer-mask",src:u(C)},null,8,["src"])])]),_:1}),a(r,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:l(()=>[a(ue,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:l(()=>[a(T,null,{default:l(()=>[a(u(ie),{nodes:u(H).app.logo,class:"mb-6"},null,8,["nodes"]),e[9]||(e[9]=i("h5",{class:"text-h5 mb-1"}," Adventure starts here 🚀 ",-1)),e[10]||(e[10]=i("p",{class:"mb-0"}," Make your app management easy and fun! ",-1))]),_:1}),a(T,null,{default:l(()=>[a(u(de),{ref_key:"refVForm",ref:g,onSubmit:J($,["prevent"])},{default:l(()=>[a(x,null,{default:l(()=>[a(r,{cols:"12"},{default:l(()=>[i("div",Ve,[a(me,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),label:c.value?"I'm Student":"I'm Teacher"},null,8,["modelValue","label"])])]),_:1}),c.value?(V(),y(r,{key:0,cols:"12"},{default:l(()=>[a(p,{modelValue:o.value.adminStudentId,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.adminStudentId=t),hint:"Select Student Name",items:u(W),"item-title":"name","item-value":"id","persistent-hint":"","return-object":"","single-line":"",placeholder:"Select Student"},null,8,["modelValue","items"])]),_:1})):(V(),y(r,{key:1,cols:"12"},{default:l(()=>[a(p,{modelValue:o.value.adminTeacherId,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.adminTeacherId=t),hint:"Select Teacher Name",items:u(Y),"item-title":"name","item-value":"id","persistent-hint":"","return-object":"","single-line":"",placeholder:"Select Teacher"},null,8,["modelValue","items"])]),_:1})),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.email,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.email=t),rules:[v,D],label:"Email",type:"email",placeholder:"lubna@jazacademy.id"},null,8,["modelValue","rules"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.password,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.password=t),rules:[v],label:"Password",placeholder:"············",type:n.value?"text":"password","append-inner-icon":n.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[5]||(e[5]=t=>n.value=!n.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.passwordConfirmation,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.passwordConfirmation=t),rules:[v,N(o.value.password)],label:"Re-Type Password",placeholder:"············",type:n.value?"text":"password","append-inner-icon":n.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[7]||(e[7]=t=>n.value=!n.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[i("div",ye,[a(pe,{id:"privacy-policy",modelValue:o.value.privacyPolicies,"onUpdate:modelValue":e[8]||(e[8]=t=>o.value.privacyPolicies=t),inline:""},null,8,["modelValue"]),a(ce,{for:"privacy-policy",style:{opacity:"1"}},{default:l(()=>e[11]||(e[11]=[i("span",{class:"me-1"},"I agree to",-1),i("a",{href:"javascript:void(0)",class:"text-primary"},"privacy policy & terms",-1)])),_:1})]),a(Z,{block:"",type:"submit"},{default:l(()=>e[12]||(e[12]=[k(" Sign up ")])),_:1})]),_:1}),a(r,{cols:"12",class:"text-center text-base"},{default:l(()=>[e[14]||(e[14]=i("span",null,"Already have an account?",-1)),a(f,{class:"text-primary ms-2",to:{name:"login"}},{default:l(()=>e[13]||(e[13]=[k(" Sign in instead ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})}}};export{ia as default};
