import{p as ge,a as he}from"./formatters-6300d5fa.js";import{_ as Y}from"./AppTextField-8792b8bb.js";import{_ as j}from"./AppSelect-596fd622.js";import{f as ye,t as G,a as be}from"./fetchTeacherData-2b0eec0b.js";import{r as A}from"./validators-6a4b56bc.js";import{r as i,o as B,f as E,e as t,b as e,n as s,aV as w,a$ as _e,aj as I,v as k,aZ as oe,a0 as we,H as ke,a6 as M,a as se,c as Z,d,F as Se,i as xe,x as f,y as Ce,a1 as K,z as ne,s as ie}from"./main-b871c247.js";import{_ as Te}from"./AppDateTimePicker-23bd7343.js";import{_ as De}from"./AppDrawerHeaderSection-89559e45.js";import{P as Pe}from"./vue3-perfect-scrollbar.esm-1b05bf3b.js";import{V as R}from"./VCard-b2c7daaa.js";import{V as W}from"./VCardText-de098736.js";import{V as Ue}from"./VForm-804f51cb.js";import{V as X,a as p}from"./VRow-6fcd1b0a.js";import{V as qe}from"./VNavigationDrawer-97c9a758.js";import{p as Ae}from"./paginationMeta-4ad053a4.js";import{u as ue}from"./useApi-e86a5383.js";import{V as Be}from"./VAlert-c640a60b.js";import{V as de}from"./VAvatar-8e3ed6ed.js";import{V as Ne}from"./VSpacer-acf0b0f1.js";import{V as me}from"./VDivider-adb1395f.js";import{V as Fe}from"./VDataTableServer-abada779.js";import{V as Le}from"./VImg-8fc3d1b5.js";import{V as $e}from"./VChip-294e7624.js";import{V as ze}from"./VPagination-778a8738.js";import"./helpers-29c4dea8.js";import"./no-profile-29bc384c.js";import"./form-7cc48b0d.js";import"./VTextField-51610683.js";/* empty css                   */import"./VCounter-4d3eaf5c.js";import"./VField-3696a4fc.js";import"./easing-9f15041e.js";import"./VInput-8e497f2d.js";import"./forwardRefs-8348545e.js";import"./VSelect-9561332e.js";import"./VList-5ecced89.js";import"./ssrBoot-f3061ed5.js";import"./dialog-transition-d47abf0e.js";import"./VMenu-8c238fe7.js";import"./VOverlay-6dc4db6e.js";import"./lazy-b1156225.js";import"./scopeId-bd2d2045.js";import"./VCheckboxBtn-9057ced3.js";import"./VSelectionControl-780f9710.js";import"./VDataTable-67e51235.js";import"./VTable-fd133ee3.js";import"./filter-2153fd22.js";const Oe={__name:"AddNewTeacher",props:{isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","userData"],setup(ee,{emit:C}){const $=ee,S=C,N=new Date().getFullYear(),T=i(!1),g=i(),F=i(""),L=i(""),h=i(""),c=i(""),V=i(N),D=i("7"),P=i(""),y=i(""),z=i(""),H=n=>Array.from({length:n},(o,U)=>N-U),b=()=>{S("update:isDrawerOpen",!1),oe(()=>{var n,o;(n=g.value)==null||n.reset(),(o=g.value)==null||o.resetValidation()})},J=()=>{var n;(n=g.value)==null||n.validate().then(({valid:o})=>{o&&(S("userData",{nig:F.value,name:L.value,nickname:h.value,gender:c.value,grade:D.value,registered:V.value,phone:P.value,birth_date:z.value,birth_place:y.value}),S("update:isDrawerOpen",!1),oe(()=>{var U,q;(U=g.value)==null||U.reset(),(q=g.value)==null||q.resetValidation()}))})},O=n=>{S("update:isDrawerOpen",n)};return(n,o)=>{const U=De,q=Te;return B(),E(qe,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":$.isDrawerOpen,"onUpdate:modelValue":O},{default:t(()=>[e(U,{title:"Add New Teacher",onCancel:b}),e(s(Pe),{options:{wheelPropagation:!1}},{default:t(()=>[e(R,{flat:""},{default:t(()=>[e(W,null,{default:t(()=>[e(Ue,{ref_key:"refForm",ref:g,modelValue:s(T),"onUpdate:modelValue":o[9]||(o[9]=u=>w(T)?T.value=u:null),onSubmit:_e(J,["prevent"])},{default:t(()=>[e(X,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[e(Y,{modelValue:s(F),"onUpdate:modelValue":o[0]||(o[0]=u=>w(F)?F.value=u:null),rules:["requiredValidator"in n?n.requiredValidator:s(A)],label:"NIG",placeholder:"201122"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(Y,{modelValue:s(L),"onUpdate:modelValue":o[1]||(o[1]=u=>w(L)?L.value=u:null),rules:["requiredValidator"in n?n.requiredValidator:s(A)],label:"Name",placeholder:"John Doe"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(Y,{modelValue:s(h),"onUpdate:modelValue":o[2]||(o[2]=u=>w(h)?h.value=u:null),rules:["requiredValidator"in n?n.requiredValidator:s(A)],label:"Nickname",placeholder:"John"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(j,{modelValue:s(c),"onUpdate:modelValue":o[3]||(o[3]=u=>w(c)?c.value=u:null),label:"Select Gender",placeholder:"Select Gender",rules:["requiredValidator"in n?n.requiredValidator:s(A)],items:["Laki-laki","Perempuan"]},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(j,{modelValue:s(V),"onUpdate:modelValue":o[4]||(o[4]=u=>w(V)?V.value=u:null),rules:["requiredValidator"in n?n.requiredValidator:s(A)],label:"Registered",placeholder:"2025",items:H(3)},null,8,["modelValue","rules","items"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(j,{modelValue:s(D),"onUpdate:modelValue":o[5]||(o[5]=u=>w(D)?D.value=u:null),rules:["requiredValidator"in n?n.requiredValidator:s(A)],label:"Grade",placeholder:"1",items:["1","2","3","4","5","6","7"]},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(Y,{modelValue:s(P),"onUpdate:modelValue":o[6]||(o[6]=u=>w(P)?P.value=u:null),rules:["requiredValidator"in n?n.requiredValidator:s(A)],label:"Phone Number",placeholder:"+62 888 1234 5678"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(Y,{modelValue:s(y),"onUpdate:modelValue":o[7]||(o[7]=u=>w(y)?y.value=u:null),rules:["requiredValidator"in n?n.requiredValidator:s(A)],label:"Birth Place",placeholder:"Where your Birth place?"},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(q,{modelValue:s(z),"onUpdate:modelValue":o[8]||(o[8]=u=>w(z)?z.value=u:null),label:"Select Birth Date",placeholder:"Select date"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(I,{type:"submit",class:"me-3"},{default:t(()=>o[10]||(o[10]=[k(" Submit ")])),_:1}),e(I,{type:"reset",variant:"outlined",color:"secondary",onClick:b},{default:t(()=>o[11]||(o[11]=[k(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Ge={class:"d-flex mb-6"},Ye={class:"d-flex justify-space-between"},Ie={class:"d-flex flex-column gap-y-1"},Me={class:"text-body-1 text-medium-emphasis"},Ee={class:"text-h4"},je={class:"text-sm"},Re={class:"me-3 d-flex gap-3"},We={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},He={style:{"inline-size":"10rem"}},Je={class:"d-flex align-center"},Qe={key:1},Ze={class:"d-flex flex-column"},Ke={class:"text-base"},Xe={class:"text-sm text-medium-emphasis"},ea={class:"d-flex align-center gap-4"},aa={class:"text-capitalize"},la={class:"text-capitalize font-weight-medium"},ta={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},ra={class:"text-sm text-disabled mb-0"},Xa={__name:"index",setup(ee){const C=we("userData").value;ke(()=>{ye()});const $=i(""),S=i(""),N=i(""),T=i(""),g=i(!1),F=i(""),L=i("primary"),h=(r,a="primary")=>{F.value=r,L.value=a,g.value=!0,setTimeout(()=>{g.value=!1},1e4)},c=i(10),V=i(1),D=i(""),P=i(""),y=i([]),z=r=>{var a;V.value=r.page,c.value=r.itemsPerPage,$.value=r.search||"",T.value=r.status||"",N.value=r.city||"",S.value=r.year||"",(a=r.sortBy)!=null&&a.length?(D.value=r.sortBy[0].key,P.value=r.sortBy[0].order):(D.value=null,P.value=null),b()},H=[{title:"Name",key:"name"},{title:"Year",key:"registered"},{title:"City",key:"city"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],b=async()=>{const r={q:$.value||"",status:T.value||"",city:N.value||"",year:S.value||"",itemsPerPage:c.value,page:V.value,sortBy:D.value||"",orderBy:P.value||""};try{const a=await be(r);console.log("ðŸ“¦ FETCHING with:",r,a),y.value=a}catch(a){console.error("Error fetching Teachers:",a.message)}},J=M(()=>{var r;return((r=y.value)==null?void 0:r.users)||[]}),O=M(()=>{var r;return((r=y.value)==null?void 0:r.totalUsers)||0}),n=M(()=>{var m,_;const r=((_=(m=y.value)==null?void 0:m.users)==null?void 0:_.map(v=>v.registered))||[];return[...new Set(r.filter(v=>typeof v=="number"))].map(v=>({title:String(v),value:String(v)}))}),o=M(()=>{var m,_;const r=((_=(m=y.value)==null?void 0:m.users)==null?void 0:_.map(v=>v.city))||[];return[...new Set(r.filter(Boolean))].map(v=>({title:v,value:v}))}),U=[{title:"Active",value:"active"},{title:"On Duty",value:"on_duty"},{title:"Passive",value:"passive"},{title:"Suspend",value:"suspend"}],q=r=>G.value.filter(a=>(a.gender||"").toLowerCase()===r.toLowerCase()&&a.status==="Active").length,u=r=>G.value.length===0?0:(q(r)/G.value.length*100).toFixed(0),ae=M(()=>G.value.filter(r=>r.status==="Suspend").length),ce=r=>G.value.length===0?0:(r/G.value.length*100).toFixed(0),pe=r=>{if(!r)return"primary";const a=r.toLowerCase();return a==="active"?"primary":a==="passive"?"warning":a==="on duty"?"success":a==="suspend"?"error":"primary"},Q=i(!1),ve=async r=>{var a;console.log("Sending userData:",r);try{const{data:m,response:_}=await ue("/teachers",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Accept:"application/json"}});_.value.ok?(h("Data berhasil ditambahkan","success"),console.log("Teacher created:",m),b()):h(_.value.statusText||"Gagal menambahkan data","error")}catch(m){console.error("Create Teacher error:",((a=m==null?void 0:m.data)==null?void 0:a.errors)||m),h(m.message||"Gagal menambahkan data","error")}},fe=async r=>{try{confirm("Apakah kamu yakin ingin menghapus data ini?")&&(console.log("Deleting teacher with ID:",r),await ue(`/teachers/${r}`,{method:"DELETE"}),h("Data berhasil dihapus","success"),b())}catch(a){h(a.message||"Gagal menghapus data","error"),console.error(a)}},Ve=i([{title:"Male Active",value:q("Laki-laki").toLocaleString(),change:u("Laki-laki"),desc:"Total Teachers",icon:"tabler-user",iconColor:"primary"},{title:"Female Active",value:q("Perempuan").toLocaleString(),change:u("Perempuan"),desc:"Total Teachers",icon:"tabler-user",iconColor:"warning"},{title:"Suspended",value:ae.value,change:ce(ae.value),desc:"Suspended Teachers",icon:"tabler-user-exclamation",iconColor:"error"}]);return(r,a)=>{const m=j,_=Y,v=se("RouterLink"),le=se("IconBtn");return B(),Z("section",null,[d("div",Ge,[e(X,null,{default:t(()=>[(B(!0),Z(Se,null,xe(Ve.value,(l,x)=>(B(),E(p,{key:x,cols:"12",md:"4",sm:"6"},{default:t(()=>[e(R,null,{default:t(()=>[e(W,null,{default:t(()=>[d("div",Ye,[d("div",Ie,[d("span",Me,f(l.title),1),d("div",null,[d("h4",Ee,[k(f(l.value)+" ",1),d("span",{class:Ce(["text-base",l.change>0?"text-success":"text-error"])},"("+f(("prefixWithPlus"in r?r.prefixWithPlus:s(ge))(l.change))+"%)",3)])]),d("span",je,f(l.desc),1)]),e(de,{color:l.iconColor,variant:"tonal",rounded:"",size:"38"},{default:t(()=>[e(K,{icon:l.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),e(R,{title:"Filters",class:"mb-6"},{default:t(()=>[e(W,null,{default:t(()=>[e(X,null,{default:t(()=>[e(p,{cols:"12",sm:"4"},{default:t(()=>[e(m,{modelValue:S.value,"onUpdate:modelValue":[a[0]||(a[0]=l=>S.value=l),b],label:"Select Year",placeholder:"Select Year",items:n.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",sm:"4"},{default:t(()=>[e(m,{modelValue:N.value,"onUpdate:modelValue":[a[1]||(a[1]=l=>N.value=l),b],label:"Select City",placeholder:"Select City",items:o.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",sm:"4"},{default:t(()=>[e(m,{modelValue:T.value,"onUpdate:modelValue":[a[2]||(a[2]=l=>T.value=l),b],label:"Select Status",placeholder:"Select Status",items:U,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Be,{modelValue:g.value,"onUpdate:modelValue":a[3]||(a[3]=l=>g.value=l),closable:"","close-label":"Close Alert",class:"mb-6",color:L.value},{default:t(()=>[k(f(F.value),1)]),_:1},8,["modelValue","color"]),e(R,null,{default:t(()=>[e(W,{class:"d-flex flex-wrap py-4 gap-4"},{default:t(()=>{var l;return[d("div",Re,[e(m,{"model-value":c.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":a[4]||(a[4]=x=>c.value=parseInt(x,10))},null,8,["model-value"])]),e(Ne),d("div",We,[d("div",He,[e(_,{modelValue:$.value,"onUpdate:modelValue":a[5]||(a[5]=x=>$.value=x),placeholder:"Search",density:"compact",onInput:b},null,8,["modelValue"])]),e(I,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:t(()=>a[11]||(a[11]=[k(" Export ")])),_:1}),((l=s(C))==null?void 0:l.role)>=4?(B(),E(I,{key:0,"prepend-icon":"tabler-plus",onClick:a[6]||(a[6]=x=>Q.value=!0)},{default:t(()=>a[12]||(a[12]=[k(" Add New Teacher ")])),_:1})):ne("",!0)])]}),_:1}),e(me),e(s(Fe),{"items-per-page":c.value,"onUpdate:itemsPerPage":a[8]||(a[8]=l=>c.value=l),page:V.value,"onUpdate:page":a[9]||(a[9]=l=>V.value=l),items:J.value,"items-length":O.value,headers:H,class:"text-no-wrap","onUpdate:options":z},{"item.name":t(({item:l})=>[d("div",Je,[e(de,{size:"34",variant:l.avatar?void 0:"tonal",class:"me-3 overflow-hidden"},{default:t(()=>[l!=null&&l.image?(B(),E(Le,{key:0,cover:"",src:`/storage/${l.image}`},null,8,["src"])):(B(),Z("span",Qe,f(("avatarText"in r?r.avatarText:s(he))(l.name)),1))]),_:2},1032,["variant"]),d("div",Ze,[d("h6",Ke,[e(v,{to:{name:"profile-teacher-id-tab",params:{id:l.id,tab:"account"}},class:"font-weight-medium text-link"},{default:t(()=>[k(f(l.name),1)]),_:2},1032,["to"])]),d("span",Xe,f(l.nig)+" - "+f(l.nickname),1)])])]),"item.registered":t(({item:l})=>[d("div",ea,[d("span",aa,f(l.registered),1)])]),"item.city":t(({item:l})=>[d("span",la,f(l.city),1)]),"item.status":t(({item:l})=>[e($e,{color:pe(l.status||""),size:"small",label:"",class:"text-capitalize"},{default:t(()=>[k(f(l.status),1)]),_:2},1032,["color"])]),"item.actions":t(({item:l})=>{var x,te,re;return[((x=s(C))==null?void 0:x.role)>=4?(B(),E(le,{key:0,onClick:oa=>fe(l.id)},{default:t(()=>[e(K,{icon:"tabler-trash"})]),_:2},1032,["onClick"])):ne("",!0),e(le,{to:s(C).admin_teacher_id===l.id||((te=s(C))==null?void 0:te.role)>=4?{name:"profile-teacher-id-tab",params:{id:l.id,tab:"account"}}:void 0,disabled:s(C).admin_teacher_id!==l.id||((re=s(C))==null?void 0:re.role)<4},{default:t(()=>[e(K,{icon:"tabler-edit"})]),_:2},1032,["to","disabled"])]}),bottom:t(()=>[e(me),d("div",ta,[d("p",ra,f(s(Ae)({page:V.value,itemsPerPage:c.value},O.value)),1),e(ze,{modelValue:V.value,"onUpdate:modelValue":a[7]||(a[7]=l=>V.value=l),length:Math.ceil(O.value/c.value),"total-visible":r.$vuetify.display.xs?1:Math.ceil(O.value/c.value)},{prev:t(l=>[e(I,ie({variant:"tonal",color:"default"},l,{icon:!1}),{default:t(()=>a[13]||(a[13]=[k(" Previous ")])),_:2},1040)]),next:t(l=>[e(I,ie({variant:"tonal",color:"default"},l,{icon:!1}),{default:t(()=>a[14]||(a[14]=[k(" Next ")])),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),e(Oe,{"is-drawer-open":Q.value,"onUpdate:isDrawerOpen":a[10]||(a[10]=l=>Q.value=l),onUserData:ve},null,8,["is-drawer-open"])])}}};export{Xa as default};
