import{a as H}from"./formatters-fcc80aa5.js";import{_ as J}from"./AppSelect-90885faf.js";import{_ as L}from"./AppTextField-6f67a54a.js";import{u as Q,g as $}from"./helpers-00da9b75.js";import{p as K}from"./paginationMeta-4ad053a4.js";import{u as D}from"./useApi-651d1cd8.js";import{a as W}from"./fetchUserData-9d9bbc0b.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";import{V as Y}from"./VAlert-d324d98b.js";import{V as Z}from"./VCard-70db4173.js";import{V as ee}from"./VCardText-61e3901b.js";import{r as c,a5 as j,a as ae,o as d,c as h,b as r,e as l,n as o,aU as v,d as m,F as se,v as g,x as p,ai as C,f as k,y as te,a0 as E,s as I}from"./main-67b8cec6.js";import{V as M}from"./VDivider-e0fd92b0.js";import{V as oe}from"./VDataTableServer-8402525b.js";import{V as N}from"./VAvatar-42bec599.js";import{V as le}from"./VImg-3c3e7f31.js";import{V as re}from"./VChip-177f961c.js";import{V as ne}from"./VPagination-463fb518.js";import"./form-e6998416.js";import"./VSelect-2e4a8d4f.js";import"./VTextField-e3decb3d.js";/* empty css                   */import"./VCounter-6dd2f7e9.js";import"./VField-ddf3fe8e.js";import"./easing-9f15041e.js";import"./VInput-1124ae67.js";import"./forwardRefs-8348545e.js";import"./VList-20a5129c.js";import"./ssrBoot-74d8f6b8.js";import"./dialog-transition-df011ef4.js";import"./VMenu-3a17e05d.js";import"./VOverlay-1200b457.js";import"./lazy-0c0b49da.js";import"./scopeId-dd1b16f6.js";import"./VCheckboxBtn-4186776c.js";import"./VSelectionControl-3490ebc3.js";import"./no-profile-4221a4a6.js";import"./VDataTable-cee8b35e.js";import"./VTable-14aead0e.js";import"./filter-54f87f61.js";const ie={class:"d-flex justify-space-between flex-wrap gap-y-4"},ce={class:"d-flex flex-row gap-4 align-center flex-wrap"},de={class:"d-flex align-center gap-x-3"},me={key:1},pe={class:"d-flex flex-column"},ue={class:"font-weight-medium"},fe={class:"text-sm text-disabled"},ve={key:1,class:"text-capitalize"},ge={key:1},ye={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},_e={class:"text-sm text-disabled mb-0"},xe={__name:"index",setup(Ve){const{hasRole:A}=Q(),y=c(""),_=c(!1),T=c(""),S=c("primary"),x=(s,a="primary")=>{T.value=s,S.value=a,_.value=!0,setTimeout(()=>{_.value=!1},1e4)},n=c(10),i=c(1),w=c(""),P=c(""),B=c([]),F=s=>{var a;i.value=s.page,n.value=s.itemsPerPage,y.value=s.search||"",(a=s.sortBy)!=null&&a.length?(w.value=s.sortBy[0].key,P.value=s.sortBy[0].order):(w.value=null,P.value=null),b()},G=[{title:"Name",key:"name"},{title:"Member",key:"admin_student_id"},{title:"Role",key:"role"},{title:"Access",key:"access"},{title:"Actions",key:"actions",sortable:!1}],R=["Profile","Project","Awards","Courses","Assessment","Saving","Payment","Finance"],O=async s=>{try{confirm("Apakah kamu yakin ingin menghapus data ini?")&&(console.log("Deleting user with ID:",s),await D(`/users/${s}`,{method:"DELETE"}),x("Data berhasil dihapus","success"),b())}catch(a){x(a.message||"Gagal menghapus data","error"),console.error(a)}},z=async s=>{var a;console.log("Updating user:",s.id,s);try{const t={...s};Array.isArray(t.access)?t.access=t.access.filter(Boolean).join(","):typeof t.access=="string"&&t.access.includes(",")||(t.access===null||t.access===void 0||t.access==="")&&(t.access=null);const{data:u,response:V}=await D(`/users/${s.id}`,{method:"PATCH",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Accept:"application/json"}});V.value.ok?(x("Data berhasil diperbarui","success"),console.log("User updated:",u),b()):(x(V.value.statusText||"Gagal memperbarui data","error"),console.error("Update error response:",V.value))}catch(t){console.error("Update user error:",((a=t==null?void 0:t.data)==null?void 0:a.errors)||t),x(t.message||"Gagal memperbarui data","error")}},b=async()=>{const s={q:y.value||"",itemsPerPage:n.value,page:i.value,sortBy:w.value||"",orderBy:P.value||""};try{const a=await W(s);console.log("ðŸ“¦ FETCHING with:",s,a),a.users&&Array.isArray(a.users)&&(a.users=a.users.map(t=>(typeof t.access=="string"&&t.access.length>0?t.access=t.access.split(",").map(u=>u.trim()).filter(Boolean):t.access=[],t))),B.value=a}catch(a){console.error("Error fetching students:",a.message)}},q=j(()=>{var s;return((s=B.value)==null?void 0:s.users)||[]}),U=j(()=>{var s;return((s=B.value)==null?void 0:s.totalUsers)||0});return(s,a)=>{const t=L,u=J,V=ae("IconBtn");return d(),h(se,null,[r(Y,{modelValue:o(_),"onUpdate:modelValue":a[0]||(a[0]=e=>v(_)?_.value=e:null),closable:"","close-label":"Close Alert",class:"mb-6",color:o(S)},{default:l(()=>[g(p(o(T)),1)]),_:1},8,["modelValue","color"]),m("div",null,[r(Z,null,{default:l(()=>[r(ee,null,{default:l(()=>[m("div",ie,[r(t,{modelValue:o(y),"onUpdate:modelValue":[a[1]||(a[1]=e=>v(y)?y.value=e:null),b],style:{"max-inline-size":"200px","min-inline-size":"200px"},placeholder:"Search ..",density:"compact"},null,8,["modelValue"]),m("div",ce,[r(u,{modelValue:o(n),"onUpdate:modelValue":a[2]||(a[2]=e=>v(n)?n.value=e:null),density:"compact",items:[5,10,20,50,100]},null,8,["modelValue"]),r(C,{"prepend-icon":"tabler-screen-share",variant:"tonal",color:"secondary"},{default:l(()=>a[6]||(a[6]=[g(" Export ")])),_:1})])])]),_:1}),r(M),r(o(oe),{"items-per-page":o(n),"onUpdate:itemsPerPage":a[4]||(a[4]=e=>v(n)?n.value=e:null),page:o(i),"onUpdate:page":a[5]||(a[5]=e=>v(i)?i.value=e:null),items:o(q),headers:G,"items-length":o(U),class:"text-no-wrap","onUpdate:options":F},{"item.name":l(({item:e})=>[m("div",de,[r(N,{size:"34",variant:e.image?void 0:"tonal",class:"me-3 overflow-hidden"},{default:l(()=>[e!=null&&e.image?(d(),k(le,{key:0,cover:"",src:`/storage/${e.image}`},null,8,["src"])):(d(),h("span",me,p(("avatarText"in s?s.avatarText:o(H))(e.name)),1))]),_:2},1032,["variant"]),m("div",pe,[m("div",ue,p(e.name),1),m("span",fe,p(e.email),1)])])]),"item.admin_student_id":l(({item:e})=>[r(re,{color:e.admin_student_id>0?"primary":"info",size:"small",label:"",class:"text-capitalize"},{default:l(()=>[g(p(e.admin_student_id>0?"Student":"Teacher"),1)]),_:2},1032,["color"])]),"item.role":l(({item:e})=>[o(A)(4).value?(d(),k(u,{key:0,modelValue:e.role,"onUpdate:modelValue":[f=>e.role=f,f=>z(e)],items:[{text:"Annonimous",value:0},{text:"Guest",value:1},{text:"User",value:2},{text:"Superuser",value:3},{text:"Manager",value:4},{text:"Programmer",value:5}],"item-title":"text","item-value":"value"},null,8,["modelValue","onUpdate:modelValue"])):(d(),h("span",{key:1,class:te(o($)(e.role).color)},[r(N,{size:"30",variant:"tonal",class:"me-2"},{default:l(()=>[r(E,{icon:"tabler-user-square-rounded",size:"18"})]),_:1}),g(" "+p(o($)(e.role).label),1)],2))]),"item.access":l(({item:e})=>[o(A)(4).value?(d(),k(u,{key:0,modelValue:e.access,"onUpdate:modelValue":[f=>e.access=f,f=>z(e)],placeholder:"Select Access",multiple:"",items:R},null,8,["modelValue","onUpdate:modelValue"])):(d(),h("span",ve,p(e.access.length),1))]),"item.actions":l(({item:e})=>[o(A)(4).value?(d(),k(V,{key:0,onClick:f=>O(e.id)},{default:l(()=>[r(E,{icon:"tabler-trash"})]),_:2},1032,["onClick"])):(d(),h("span",ge,p(e.role===5?"Develop":e.role===4?"Delete":e.role===3?"Update":e.role===2?"Create":e.role===1?"Read":"Unknown"),1))]),bottom:l(()=>[r(M),m("div",ye,[m("p",_e,p(o(K)({page:o(i),itemsPerPage:o(n)},o(U))),1),r(ne,{modelValue:o(i),"onUpdate:modelValue":a[3]||(a[3]=e=>v(i)?i.value=e:null),length:Math.ceil(o(U)/o(n)),"total-visible":s.$vuetify.display.xs?1:Math.min(Math.ceil(o(U)/o(n)),5)},{prev:l(e=>[r(C,I({variant:"tonal",color:"default"},e,{icon:!1}),{default:l(()=>a[7]||(a[7]=[g(" Previous ")])),_:2},1040)]),next:l(e=>[r(C,I({variant:"tonal",color:"default"},e,{icon:!1}),{default:l(()=>a[8]||(a[8]=[g(" Next ")])),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1})])],64)}}},na=X(xe,[["__scopeId","data-v-ce8b38f8"]]);export{na as default};
