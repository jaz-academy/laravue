import{c as B,a as O}from"./formatters-b77a216c.js";import{i as H,f as K,c as X}from"./fetchProjectData-1d279c59.js";import{N as Z,F as ee}from"./front-page-navbar-96c432d4.js";import{t as te}from"./helpers-0ad46068.js";import{r as m,a5 as ae,H as W,b6 as se,a as J,o as n,f as p,e as o,b as t,z as S,d as l,c as v,F as $,i as E,n as i,v as y,x as c,aU as N,a0 as D,a$ as oe,ai as Y,d7 as le,w as ne,f8 as re,c1 as ie}from"./main-37de545e.js";import{_ as de}from"./AppTextarea-358e4645.js";import{_ as ce}from"./AppSelect-c31ef19a.js";import{t as me,f as ue}from"./fetchTeacherData-f454908a.js";import{_ as pe}from"./InstagramEmbed-9d0477c8.js";import{a as M}from"./no-profile-4221a4a6.js";import{$ as ve}from"./api-b41d5acf.js";import{V as fe}from"./VCardText-87a2555b.js";import{V as F,a as b}from"./VRow-fac58b63.js";import{V as P}from"./VAvatar-93aa4262.js";import{V as j}from"./VImg-ab0ba356.js";import{V as _e}from"./VTooltip-6c0a2c32.js";import{V as U}from"./VRating-d5ff9f67.js";import{V as he}from"./VAlert-df2ee2c3.js";import{V as ge}from"./VForm-8be29ffd.js";import{V as q,b as ye,c as be,a as ke}from"./VList-002b35c7.js";import{V as Q}from"./VCard-c1035577.js";import{V as Ve}from"./VDivider-bd657aeb.js";import"./useApi-7afb6e9f.js";import"./AppTextField-5723627d.js";import"./form-2eea43bf.js";import"./VTextField-e524b538.js";/* empty css                   */import"./VCounter-2e970494.js";import"./VField-5bdf7c6e.js";import"./easing-9f15041e.js";import"./VInput-9309032d.js";import"./forwardRefs-8348545e.js";import"./VNodeRenderer-9e6fcee6.js";import"./useGenerateImageVariant-5fc2e67d.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VChip-eda1d933.js";import"./VContainer-b5196252.js";import"./NavbarThemeSwitcher-fb6755c4.js";import"./VMenu-77bc6832.js";import"./VOverlay-f715a3c8.js";import"./lazy-f1e50cea.js";import"./scopeId-3f0b9f79.js";import"./dialog-transition-4715d8ab.js";import"./ssrBoot-a125e40e.js";import"./VNavigationDrawer-dbfad57c.js";import"./VToolbar-bf64507d.js";import"./VSpacer-33f3a832.js";import"./VSelect-89c1ecf3.js";import"./VCheckboxBtn-ecef6dcc.js";import"./VSelectionControl-8d59c827.js";import"./index-094d6f8e.js";import"./index-9c720871.js";const xe={class:"d-flex justify-space-between align-center mb-2"},we={class:"d-flex align-center"},Se={class:"v-avatar-group me-2"},Ie={class:"text-xs"},Ne={class:"text-base text-primary"},$e={class:"text-sm text-medium-emphasis"},Te={class:"d-flex flex-column text-end"},Ce={class:"text-sm text-primary"},Ae=["href"],Le={class:"text-body-1 text-primary"},Pe={class:"text-body-2 d-inline"},je={class:"d-flex align-center mt-4"},Re={key:1},ze={class:"d-flex flex-column"},Be={class:"d-flex flex-column"},De={class:"text-base text-primary ms-1"},Me={class:"text-sm text-medium-emphasis cursor-pointer"},Ue={class:"text-body-2 mt-2"},Ee={class:"d-flex justify-space-between my-4 flex-wrap action-icons"},Fe={class:""},He={key:0,class:"modal-overlay"},Ye={class:"modal-content"},Oe={class:"flex-grow-1 overflow-auto d-none",style:{"max-block-size":"100%"}},We=["innerHTML"],Je={__name:"InstagramCard",props:{taskId:Number,taskName:String,description:String,subject:String,theme:String,stars:String,media:String,postId:String,students:Array,teacher:Object,review:String,teacherImg:String,accepted:Number,link:String,date:String},setup(R){const a=R,T=localStorage.getItem("participant"),k=T?JSON.parse(T):null,V=m(!1),f=m(""),_=m(a.teacher),x=m(a.accepted?"Yes":"No"),h=m(a.review),u=m(a.stars),C=m(!!a.accepted),z=ae(()=>me.value.map(e=>({title:e.nickname,value:{id:e.id,name:e.nickname}}))),L=e=>{e==="Yes"?C.value=!0:C.value=!1},d=async()=>{if(_.value===""){f.value="Please select a mentor";return}else if(x.value===""){f.value="Please select accepted";return}else if(u.value===0){f.value="Please select a rating";return}else if(h.value===""){f.value="Please write a review";return}else{const e={admin_teacher_id:_.value.id,accepted:x.value=="Yes"?1:0,rate:u.value,review:h.value};console.log("Rating submitted:",e);try{const s=await ve(`/public/update-task-accepted/${a.taskId}`,{method:"POST",body:e,onResponseError({err:g}){f.value=g}});console.log("Rating response:",s),u.value=s.data.rate,h.value=s.data.review}catch(s){console.error("Error submitting rating:",s)}V.value=!1}},w=()=>{(window.scrollY||document.documentElement.scrollTop)>100&&(V.value=!1)};W(()=>{ue(),window.addEventListener("scroll",w)}),se(()=>{window.removeEventListener("scroll",w)});const I=[{prependAvatar:M,title:"Brunch this weekend?",subtitle:`<span class="text-primary">Ali Connors</span> &mdash; I'll be in your neighborhood doing errands this weekend. Do you want to hang out?`},{type:"divider",inset:!0},{prependAvatar:M,title:"Summer BBQ",subtitle:`<span class="text-primary">to Alex, Scott, Jennifer</span> &mdash; Wish I could come, but I'm out of town this weekend.`},{type:"divider",inset:!0}];return(e,s)=>{const g=J("RouterLink"),A=ce,G=de;return n(),p(Q,{class:"mb-4"},{default:o(()=>[t(fe,null,{default:o(()=>[t(F,null,{default:o(()=>[t(b,{cols:"12",md:"6",class:"border border-red"},{default:o(()=>[a.media=="Instagram"?(n(),p(pe,{key:0,"post-id":a.postId},null,8,["post-id"])):S("",!0)]),_:1}),t(b,{cols:"12",md:"6"},{default:o(()=>[l("div",null,[l("div",xe,[l("div",we,[l("div",Se,[(n(!0),v($,null,E(a.students.slice(0,3),r=>(n(),p(P,{key:r.id,color:"info",size:"34"},{default:o(()=>[t(j,{src:("takePic"in e?e.takePic:i(te))(r.image),cover:""},null,8,["src"]),t(_e,{location:"top",activator:"parent"},{default:o(()=>[y(c(r.nickname),1)]),_:2},1024)]),_:2},1024))),128)),a.students.length>3?(n(),p(P,{key:0,color:"secondary",size:"34"},{default:o(()=>[l("span",Ie,"+"+c(a.students.length-3),1)]),_:1})):S("",!0)]),t(g,{to:`/?search=${("abbreviateName"in e?e.abbreviateName:i(B))(a.students[0].nickname,10,1).toLowerCase()}`,class:"d-flex flex-column"},{default:o(()=>[l("h6",Ne,c(("abbreviateName"in e?e.abbreviateName:i(B))(a.students[0].name,30,3)),1),l("span",$e,c(a.students.length>1?`And ${a.students.length-1} others`:a.students[0].email||a.students[0].nickname),1)]),_:1},8,["to"])]),l("div",Te,[l("small",Ce,c(new Date(a.date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})),1),l("a",{href:`/?search=${a.taskId}`,class:"text-sm text-medium-emphasis"},c(a.taskId),9,Ae)])]),s[11]||(s[11]=l("hr",{class:"my-custom-line"},null,-1)),t(g,{to:`/?search=${("abbreviateName"in e?e.abbreviateName:i(B))(a.theme,30,4).toLowerCase()}`,class:"d-flex flex-column"},{default:o(()=>[l("p",Le,c(a.subject+": "+a.theme),1)]),_:1},8,["to"]),l("p",Pe,[t(g,{to:`/?search=${R.taskId}`,class:"text-primary"},{default:o(()=>[y(c(a.taskName.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")),1)]),_:1},8,["to"]),y(" "+c(a.description),1)]),l("div",je,[t(P,{size:a.accepted?void 0:34,color:a.accepted?void 0:e.warning,variant:"tonal",class:"me-3"},{default:o(()=>[a.accepted?(n(),v($,{key:0},[a.teacherImg?(n(),p(j,{key:0,src:`/storage/${a.teacherImg}`,cover:""},null,8,["src"])):(n(),p(j,{key:1,src:i(M)},null,8,["src"]))],64)):(n(),v("span",Re,c(("avatarText"in e?e.avatarText:i(O))(i(_).name)),1))]),_:1},8,["size","color"]),l("div",ze,[l("div",Be,[l("h6",De,c(i(_).name),1)]),l("div",Me,[i(k)&&i(k).role>1?(n(),v("div",{key:0,class:"d-flex flex-column",onClick:s[1]||(s[1]=r=>V.value=!0)},[t(U,{modelValue:i(u),"onUpdate:modelValue":s[0]||(s[0]=r=>N(u)?u.value=r:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])])):(n(),p(g,{key:1,to:"/front/bookmark",class:"d-flex flex-column"},{default:o(()=>[t(U,{modelValue:i(u),"onUpdate:modelValue":s[2]||(s[2]=r=>N(u)?u.value=r:null),readonly:"","half-increments":"",size:"x-small",density:"compact"},null,8,["modelValue"])]),_:1}))])])]),l("p",Ue,c(i(h)),1),s[12]||(s[12]=l("hr",{class:"my-custom-line"},null,-1)),l("div",Ee,[l("div",Fe,[t(D,{icon:"tabler-message-2"}),t(D,{icon:"tabler-heart",class:"ms-2"})]),t(D,{icon:"tabler-bookmark"})]),i(V)?(n(),v("div",He,[l("div",Ye,[i(f)?(n(),p(he,{key:0,type:"error",class:"mb-5",dismissible:"",onClick:s[3]||(s[3]=r=>f.value="")},{default:o(()=>[y(c(i(f)),1)]),_:1})):S("",!0),t(ge,{onSubmit:oe(r=>({}),["prevent"])},{default:o(()=>[t(F,null,{default:o(()=>[t(b,{cols:"12"},{default:o(()=>[t(A,{modelValue:i(_),"onUpdate:modelValue":s[4]||(s[4]=r=>N(_)?_.value=r:null),label:"Mentor",placeholder:"Select Mentor",items:i(z),"item-title":"value.name","item-value":"value"},null,8,["modelValue","items"])]),_:1}),t(b,{cols:"12"},{default:o(()=>[t(A,{modelValue:i(x),"onUpdate:modelValue":[s[5]||(s[5]=r=>N(x)?x.value=r:null),L],label:"Accepted",placeholder:"Not Accepted",items:["Yes","No"]},null,8,["modelValue"])]),_:1}),i(C)?(n(),p(b,{key:0,cols:"12",class:"text-center"},{default:o(()=>[t(U,{modelValue:i(u),"onUpdate:modelValue":s[6]||(s[6]=r=>N(u)?u.value=r:null),"half-increments":"",hover:""},null,8,["modelValue"]),t(G,{modelValue:i(h),"onUpdate:modelValue":s[7]||(s[7]=r=>N(h)?h.value=r:null),placeholder:"Write your review...",rows:3},null,8,["modelValue"])]),_:1})):S("",!0),t(b,{cols:"12",class:"mt-4"},{default:o(()=>[t(Y,{type:"submit",class:"me-2",onClick:d},{default:o(()=>s[9]||(s[9]=[y(" Save ")])),_:1}),t(Y,{color:"secondary",class:"me-2",onClick:s[8]||(s[8]=r=>V.value=!1)},{default:o(()=>s[10]||(s[10]=[y(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})])])):S("",!0),l("div",Oe,[t(q,{lines:"three",items:I,"item-props":""},{subtitle:o(({subtitle:r})=>[l("div",{innerHTML:r},null,8,We)]),_:1})])])]),_:1})]),_:1})]),_:1})]),_:1})}}};const qe={class:"landing-page-wrapper"},Qe={class:"instagram-card"},Ge={key:1},Ke={class:"py-4 text-center text-gray-400"},Xe={key:0,class:"flex justify-center items-center my-4 mt-6"},Kt={__name:"instagram",setup(R){const a=m(null),T=m([]),k=m(!1),V=m(2);console.log("instagramTasks:",H.value),W(async()=>{var d;await K(),a.value=(d=H.value)==null?void 0:d.data,a.value&&L(),window.addEventListener("scroll",f)});const f=async()=>{var I;const d=window.scrollY+window.innerHeight,w=document.documentElement.scrollHeight-10;if(d>=w&&!k.value){k.value=!0;const e=await X(V.value++);(I=e.data)!=null&&I.length&&(a.value.push(...e.data),L()),k.value=!1}},_=m(),x=m(),h=m(),u=m(),C=m(),z=m();function L(){T.value=[{type:"subheader",title:"Best of the Week"},...a.value.filter(d=>d.rate>=4).flatMap(d=>[{prependAvatar:le,students:d.students||[],subtitle:d.name||"No Task Name"},{type:"divider",inset:!0}])]}return ne(a,d=>{console.log("Task data updated:",d)}),re([x,h,u,C,z],([{isIntersecting:d,target:w}])=>{d&&(_.value=w.id)},{threshold:.25}),(d,w)=>{const I=J("VSubheader");return n(),v($,null,[l("div",qe,[t(Z,{"active-id":_.value},null,8,["active-id"]),l("div",Qe,[t(F,{class:"m-0 p-0"},{default:o(()=>[t(b,{class:"d-none d-lg-block",cols:"12",lg:"3"},{default:o(()=>[t(Q,{style:{position:"sticky","inset-block-start":"6rem"}},{default:o(()=>[t(q,{lines:"three"},{default:o(()=>[(n(!0),v($,null,E(T.value,(e,s)=>(n(),v($,{key:s},[e.prependAvatar?(n(),p(ke,{key:0,class:"custom-list-item"},{prepend:o(()=>[t(P,{size:"34",variant:"tonal",color:"primary",class:"me-1 mt-2"},{default:o(()=>[e.students[0].image?(n(),p(j,{key:0,src:e.students[0].image},null,8,["src"])):(n(),v("span",Ge,c(("avatarText"in d?d.avatarText:i(O))(e.students[0].nickname)),1))]),_:2},1024)]),default:o(()=>[t(ye,null,{default:o(()=>[y(c(e.students.length>1?e.students[0].nickname+" And "+(e.students.length-1)+" others":e.students[0].name),1)]),_:2},1024),t(be,null,{default:o(()=>[y(c(e.subtitle),1)]),_:2},1024)]),_:2},1024)):e.type==="divider"?(n(),p(Ve,{key:`divider-${s}`,inset:""})):e.type==="subheader"?(n(),p(I,{key:2,class:"ps-3 mb-2 font-weight-medium text-primary"},{default:o(()=>[y(c(e.title),1)]),_:2},1024)):S("",!0)],64))),128))]),_:1})]),_:1})]),_:1}),t(b,{cols:"12",lg:"9"},{default:o(()=>[l("div",null,[(n(!0),v($,null,E(a.value,e=>{var s,g,A;return n(),v("div",{key:e.id},[t(Je,{"task-id":e.id,"task-name":e.name,"task-date":e.date,description:e.description,subject:e.project_plan.subject,theme:e.project_plan.theme,stars:e.rate,media:e.media,"post-id":((g=(s=e.link)==null?void 0:s.match(/\/(?:p|reel)\/([\w-]+)/))==null?void 0:g[1])||"N/A",students:e.students,teacher:e.admin_teacher?{id:e.admin_teacher.id,name:e.admin_teacher.nickname}:"Not Accepted","teacher-img":(A=e.admin_teacher)==null?void 0:A.image,accepted:e.accepted,review:(e==null?void 0:e.review)||null,date:e.date},null,8,["task-id","task-name","task-date","description","subject","theme","stars","media","post-id","students","teacher","teacher-img","accepted","review","date"])])}),128))])]),_:1})]),_:1}),l("div",Ke,[!a.value||k.value?(n(),v("div",Xe,[t(ie,{size:50,color:"primary",indeterminate:""})])):S("",!0)])])]),t(ee)],64)}}};export{Kt as default};
