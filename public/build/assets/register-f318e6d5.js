import{_ as q}from"./AppTextField-5723627d.js";import{_ as F}from"./AppSelect-c31ef19a.js";import{r as m,j as E,k as z,H as O,a as G,o as V,f as y,e as l,b as a,d as i,n as u,I as H,a$ as J,ai as Y,v as k,$ as b,aY as K}from"./main-37de545e.js";import{f as Q,s as W}from"./fetchStudentData-9aefa5e4.js";import{f as X,t as Z}from"./fetchTeacherData-f454908a.js";import{u as ee}from"./useAbility-f473c84a.js";import{a as ae,b as te,c as le,d as oe}from"./auth-v2-register-illustration-light-25193346.js";import{a as se,b as re}from"./misc-mask-light-a3cab517.js";import{V as ie}from"./VNodeRenderer-9e6fcee6.js";import{u as S}from"./useGenerateImageVariant-5fc2e67d.js";import{$ as ne}from"./api-b41d5acf.js";import{V as I}from"./VImg-ab0ba356.js";import{a as r,V as x}from"./VRow-fac58b63.js";import{V as ue}from"./VCard-c1035577.js";import{V as T}from"./VCardText-87a2555b.js";import{V as de}from"./VForm-8be29ffd.js";import{V as me}from"./VSwitch-ef4c8bc3.js";import{V as pe}from"./VCheckbox-e75ad08b.js";import{V as ce}from"./form-2eea43bf.js";import"./VTextField-e524b538.js";/* empty css                   */import"./VCounter-2e970494.js";import"./VField-5bdf7c6e.js";import"./easing-9f15041e.js";import"./VInput-9309032d.js";import"./forwardRefs-8348545e.js";import"./VSelect-89c1ecf3.js";import"./VList-002b35c7.js";import"./ssrBoot-a125e40e.js";import"./VAvatar-93aa4262.js";import"./VDivider-bd657aeb.js";import"./dialog-transition-4715d8ab.js";import"./VMenu-77bc6832.js";import"./VOverlay-f715a3c8.js";import"./lazy-f1e50cea.js";import"./scopeId-3f0b9f79.js";import"./VCheckboxBtn-ecef6dcc.js";import"./VSelectionControl-8d59c827.js";import"./VChip-eda1d933.js";import"./useApi-7afb6e9f.js";import"./index-094d6f8e.js";import"./index-9c720871.js";const fe={class:"position-relative bg-background rounded-lg w-100 ma-8 me-0"},ve={class:"d-flex align-center justify-center w-100 h-100"},Ve={class:"demo-space-x"},ye={class:"d-flex align-center mt-2 mb-4"},ia={__name:"register",setup(be){const R=S(oe,le,te,ae,!0),C=S(re,se),g=m(),c=m(!0),o=m({adminStudentId:"Select",adminTeacherId:"Select",email:"lubna@jazacademy.id",password:"",passwordConfirmation:"",privacyPolicies:!1}),h=E(),j=z(),M=ee(),n=m(!1),P=m({}),$=m(""),v=s=>!!s||"This field is required",A=s=>/.+@.+\..+/.test(s)||"E-mail must be valid",D=s=>e=>e===s||"Password does not match";O(async()=>{await Q(),await X()});const N=async()=>{var e,p,d,f;const s={...o.value,adminStudentId:((e=o.value.adminStudentId)==null?void 0:e.id)||null,adminTeacherId:((p=o.value.adminTeacherId)==null?void 0:p.id)||null,name:((d=o.value.adminStudentId)==null?void 0:d.name)||((f=o.value.adminTeacherId)==null?void 0:f.name)};try{const t=await ne("/auth/register",{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"},onResponseError({response:_}){P.value=_._data.errors,$.value=_._data.message||"Register failed"}}),{accessToken:B,userData:L,userAbilityRules:w}=t;b("userAbilityRules").value=w,M.update(w),b("userData").value=L,b("accessToken").value=B,await K(()=>{j.replace(h.query.to?String(h.query.to):"/login")})}catch(t){console.error(t)}},U=()=>{var s;(s=g.value)==null||s.validate().then(({valid:e})=>{e&&N()})};return(s,e)=>{const p=F,d=q,f=G("RouterLink");return V(),y(x,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:l(()=>[a(r,{md:"8",class:"d-none d-md-flex"},{default:l(()=>[i("div",fe,[i("div",ve,[a(I,{"max-width":"441",src:u(R),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),a(I,{class:"auth-footer-mask",src:u(C)},null,8,["src"])])]),_:1}),a(r,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:l(()=>[a(ue,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:l(()=>[a(T,null,{default:l(()=>[a(u(ie),{nodes:u(H).app.logo,class:"mb-6"},null,8,["nodes"]),e[9]||(e[9]=i("h5",{class:"text-h5 mb-1"}," Adventure starts here 🚀 ",-1)),e[10]||(e[10]=i("p",{class:"mb-0"}," Make your app management easy and fun! ",-1))]),_:1}),a(T,null,{default:l(()=>[a(u(de),{ref_key:"refVForm",ref:g,onSubmit:J(U,["prevent"])},{default:l(()=>[a(x,null,{default:l(()=>[a(r,{cols:"12"},{default:l(()=>[i("div",Ve,[a(me,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),label:c.value?"I'm Student":"I'm Teacher"},null,8,["modelValue","label"])])]),_:1}),c.value?(V(),y(r,{key:0,cols:"12"},{default:l(()=>[a(p,{modelValue:o.value.adminStudentId,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.adminStudentId=t),hint:"Select Student Name",items:u(W),"item-title":"name","item-value":"id","persistent-hint":"","return-object":"","single-line":"",placeholder:"Select Student"},null,8,["modelValue","items"])]),_:1})):(V(),y(r,{key:1,cols:"12"},{default:l(()=>[a(p,{modelValue:o.value.adminTeacherId,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.adminTeacherId=t),hint:"Select Teacher Name",items:u(Z),"item-title":"name","item-value":"id","persistent-hint":"","return-object":"","single-line":"",placeholder:"Select Teacher"},null,8,["modelValue","items"])]),_:1})),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.email,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.email=t),rules:[v,A],label:"Email",type:"email",placeholder:"lubna@jazacademy.id"},null,8,["modelValue","rules"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.password,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.password=t),rules:[v],label:"Password",placeholder:"············",type:n.value?"text":"password","append-inner-icon":n.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[5]||(e[5]=t=>n.value=!n.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[a(d,{modelValue:o.value.passwordConfirmation,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.passwordConfirmation=t),rules:[v,D(o.value.password)],label:"Re-Type Password",placeholder:"············",type:n.value?"text":"password","append-inner-icon":n.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[7]||(e[7]=t=>n.value=!n.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),a(r,{cols:"12"},{default:l(()=>[i("div",ye,[a(pe,{id:"privacy-policy",modelValue:o.value.privacyPolicies,"onUpdate:modelValue":e[8]||(e[8]=t=>o.value.privacyPolicies=t),inline:""},null,8,["modelValue"]),a(ce,{for:"privacy-policy",style:{opacity:"1"}},{default:l(()=>e[11]||(e[11]=[i("span",{class:"me-1"},"I agree to",-1),i("a",{href:"javascript:void(0)",class:"text-primary"},"privacy policy & terms",-1)])),_:1})]),a(Y,{block:"",type:"submit"},{default:l(()=>e[12]||(e[12]=[k(" Sign up ")])),_:1})]),_:1}),a(r,{cols:"12",class:"text-center text-base"},{default:l(()=>[e[14]||(e[14]=i("span",null,"Already have an account?",-1)),a(f,{class:"text-primary ms-2",to:{name:"login"}},{default:l(()=>e[13]||(e[13]=[k(" Sign in instead ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})}}};export{ia as default};
