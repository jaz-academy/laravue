import{u as R}from"./useApi-608e4ca2.js";import{_ as q}from"./MoreBtn-587f7e87.js";import{a as L,V as B,b as Ve}from"./VCard-afaa5d27.js";import{V as we}from"./VDivider-f6620f51.js";import{V as fe}from"./VTable-9b09b8cc.js";import{V as G}from"./VAvatar-277a8b10.js";import{a5 as F,o as u,f as w,e as t,b as e,d as n,c as S,F as M,i as T,x as _,a0 as O,y as H,v as I,aZ as _e,z as P,r as C,w as he,ai as j,s as ke,n as c,aU as X,J as ve,be as ne,a$ as De,cE as Ce,cF as $e,$ as ge,H as be}from"./main-d9f3424d.js";import{V as ce}from"./VChip-b6bedac6.js";import{m as ye}from"./vue3-apexcharts-7f8f0297.js";import{V as Se}from"./VMenu-b53d0f28.js";import{V as xe,a as Z,b as se,c as Ne}from"./VList-c368e352.js";import{V as U}from"./VCardText-cf9fd2ab.js";import{h as J,s as Ae}from"./helpers-ddaee727.js";import{V as Fe,a as Ie}from"./VTabs-273de8d8.js";import{V as ze,a as te}from"./VWindowItem-bed7e0f7.js";import{V as oe,a as ae}from"./VTimelineItem-d0d3fd47.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";import{r as ue}from"./validators-1368e188.js";import{_ as Me}from"./AppTextField-760889a8.js";import{_ as Te}from"./DialogCloseBtn-4a4fd1c1.js";import{_ as de}from"./AppSelect-b4c02f4e.js";import{V as Pe}from"./VForm-ce8bb408.js";import{V as re}from"./VRow-da5b93ce.js";import{V as A}from"./VCol-ac94f502.js";import{V as Ee}from"./VDialog-cd2d399b.js";import{V as Be}from"./VSnackbar-50c0a2ee.js";import"./VImg-f55b59e7.js";import"./VOverlay-6cf31c8f.js";import"./easing-9f15041e.js";import"./lazy-3da88233.js";import"./scopeId-c2687b41.js";import"./forwardRefs-8348545e.js";import"./dialog-transition-93f1260e.js";import"./ssrBoot-51c609c5.js";import"./no-profile-4221a4a6.js";import"./VSlideGroup-fd82e852.js";import"./form-26233cc1.js";import"./VTextField-0356918e.js";/* empty css                   */import"./VCounter-17d4f7ca.js";import"./VField-9bf8b145.js";import"./VInput-ca1cb71d.js";import"./VSelect-1d333a1c.js";import"./VCheckboxBtn-bb1e1fec.js";import"./VSelectionControl-28f4217c.js";const Oe={class:"d-flex align-center"},Ue={class:"text-body-2 text-high-emphasis font-weight-medium"},We={class:"d-flex align-center gap-x-4",style:{"min-inline-size":"200px"}},Le={class:"w-100"},Ye={class:"text-body-1 bg-var-theme-background"},Re={class:"font-weight-medium"},je={__name:"AllocationTable",props:{data:{type:Array,default:()=>[]}},setup($){const d=$,i=[{title:"ACCOUNT",key:"description"},{title:"PAYMENT",key:"payment"},{title:"EXPENSES",key:"expense"},{title:"BALANCE",key:"balance"},{title:"REMAIN",key:"percentage"}],f=o=>typeof o!="number"?o:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o),x=o=>o>0?"success":o<0?"error":"warning",g=o=>o>100?"error":o>90?"warning":"primary",k=F(()=>d.data.reduce((o,s)=>o+s.balance,0));return(o,s)=>{const l=q;return d.data.length?(u(),w(B,{key:0},{default:t(()=>[e(L,{title:"Allocation"},{append:t(()=>[e(l)]),_:1}),e(we),e(fe,{class:"text-no-wrap"},{default:t(()=>[n("thead",null,[n("tr",null,[(u(),S(M,null,T(i,a=>n("th",{key:a.key,scope:"col",class:"text-uppercase"},_(a.title),1)),64))])]),n("tbody",null,[(u(!0),S(M,null,T(d.data,a=>(u(),S("tr",{key:a.allocation},[n("td",null,[n("div",Oe,[e(G,{color:a.payment>0?"primary":"error",variant:"tonal",class:"me-2",size:"34"},{default:t(()=>[e(O,{icon:a.payment>0?"tabler-building-bank":"tabler-wallet",size:"22"},null,8,["icon"])]),_:2},1032,["color"]),n("span",Ue,_(a.allocation||"No Allocated"),1)])]),n("td",{class:H(Number(a.payment)<0?"text-error":"text-secondary")},_(f(Number(a.payment))),3),n("td",{class:H(Number(a.expense)<0?"text-success":"text-secondary")},_(f(Number(a.expense))),3),n("td",null,[e(ce,{color:x(a.balance),label:""},{default:t(()=>[I(_(f(a.balance)),1)]),_:2},1032,["color"])]),n("td",null,[n("div",We,[n("div",Le,[e(_e,{"model-value":a.remain,color:g(a.remain),height:10,rounded:""},null,8,["model-value","color"])]),s[0]||(s[0]=n("div",{class:"text-body-2"},null,-1))])])]))),128))]),n("tfoot",null,[n("tr",Ye,[s[1]||(s[1]=n("th",{colspan:"2",scope:"row"},null,-1)),s[2]||(s[2]=n("th",{class:"font-weight-medium text-high-emphasis"}," Total Balance ",-1)),n("td",Re,[e(ce,{color:x(k.value),label:""},{default:t(()=>[I(_(f(k.value)),1)]),_:1},8,["color"])]),s[3]||(s[3]=n("td",null,null,-1))])])]),_:1})]),_:1})):P("",!0)}}};const He="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",pe="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",qe="rgba(var(--v-border-color), var(--v-border-opacity))",Ke={__name:"ExpenseStatistics",props:{data:{type:Array,default:()=>[]}},emits:["year-selected"],setup($,{emit:d}){const i=$,f=d,x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=C("All");he(g,m=>{f("yearSelected",m==="All"?"":m)});const k=F(()=>{const b=new Date().getFullYear(),V=[];for(let p=b;p>=2023;p--)V.push(p);return V}),o=F(()=>{const m=[],b=[],V=[];return i.data.forEach(p=>{const[r,h]=p.month.split("-");m.push(`${x[parseInt(h)-1]}-${r}`),m.push(`${x[parseInt(h)-1]}`),b.push(Number(p.official)),V.push(Number(p.non_official))}),{bulan:m,official:b,non_official:V}}),s={line:{series1:"#FFB400",series2:"#9055FD",series3:"#7367f029"}},l=F(()=>[{name:"Kitchen",type:"column",data:o.value.official},{name:"Household",type:"line",data:o.value.non_official}]),a=F(()=>({chart:{type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},markers:{size:5,colors:"#fff",strokeColors:s.line.series2,hover:{size:6},borderRadius:4},stroke:{curve:"smooth",width:[0,3],lineCap:"round"},legend:{show:!0,position:"bottom",markers:{width:8,height:8,offsetX:-3},height:40,itemMargin:{horizontal:10,vertical:0},fontSize:"15px",fontFamily:"Open Sans",fontWeight:400,labels:{colors:He,useSeriesColors:!1},offsetY:10},grid:{strokeDashArray:8,borderColor:qe},colors:[s.line.series1,s.line.series2],fill:{opacity:[1,1]},plotOptions:{bar:{columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4}},dataLabels:{enabled:!1},xaxis:{tickAmount:10,categories:o.value.bulan,labels:{style:{colors:pe,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{tickAmount:4,labels:{style:{colors:pe,fontSize:"13px",fontWeight:400},formatter(m){return m>=1e6?`${(m/1e6).toFixed(0)} jt`:(m==null?void 0:m.toLocaleString("id-ID"))||0}}},responsive:[{breakpoint:1400,options:{chart:{height:320},xaxis:{labels:{style:{fontSize:"10px"}}},legend:{itemMargin:{vertical:0,horizontal:10},fontSize:"13px",offsetY:12}}},{breakpoint:1025,options:{chart:{height:415},plotOptions:{bar:{columnWidth:"50%"}}}},{breakpoint:982,options:{plotOptions:{bar:{columnWidth:"30%"}}}},{breakpoint:480,options:{chart:{height:250},legend:{offsetY:7}}}]}));return(m,b)=>{const V=ye;return u(),w(B,null,{default:t(()=>[e(L,{title:"Expense statistics",subtitle:"Monthly expenses"},{append:t(()=>[e(Se,{"offset-y":""},{activator:t(({props:p})=>[e(j,ke(p,{variant:"tonal","append-icon":"tabler-chevron-down"}),{default:t(()=>[I(_(g.value),1)]),_:2},1040)]),default:t(()=>[e(xe,null,{default:t(()=>[e(Z,{onClick:b[0]||(b[0]=p=>g.value="All")},{default:t(()=>[e(se,null,{default:t(()=>b[1]||(b[1]=[I("All")])),_:1})]),_:1}),(u(!0),S(M,null,T(k.value,p=>(u(),w(Z,{key:p,onClick:r=>g.value=p},{default:t(()=>[e(se,null,{default:t(()=>[I(_(p),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(V,{id:"shipment-statistics",type:"line",height:"320",options:a.value,series:l.value},null,8,["options","series"])]),_:1})]),_:1})}}};const Je={class:"text-caption text-uppercase text-success"},Ge={class:"app-timeline-title"},Xe={class:"app-timeline-text"},Ze={class:"text-caption text-uppercase text-warning"},Qe={class:"app-timeline-title"},et={class:"app-timeline-text"},tt={class:"text-caption text-uppercase text-error"},ot={class:"app-timeline-title"},at={class:"app-timeline-text"},nt={__name:"FinanceHistory",props:{data:{type:Object,default:()=>({expenses:[],outgoings:[],inputs:[]})}},setup($){const d=$,i=C("Input"),f=["Input","Outgoing","Expenses"];return(x,g)=>{const k=q;return u(),w(B,{class:"country-order-card"},{default:t(()=>[e(L,{title:"Payment History",subtitle:"Transactions"},{append:t(()=>[e(k)]),_:1}),e(Fe,{modelValue:c(i),"onUpdate:modelValue":g[0]||(g[0]=o=>X(i)?i.value=o:null),grow:"",class:"disable-tab-transition"},{default:t(()=>[(u(),S(M,null,T(f,(o,s)=>e(Ie,{key:s},{default:t(()=>[I(_(o),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(U,null,{default:t(()=>[e(ze,{modelValue:c(i),"onUpdate:modelValue":g[1]||(g[1]=o=>X(i)?i.value=o:null)},{default:t(()=>[e(te,null,{default:t(()=>[n("div",null,[d.data.inputs.length?(u(),w(oe,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(M,null,T(d.data.inputs,(o,s)=>(u(),w(ae,{key:s,icon:"tabler-circle-check","dot-color":"rgba(var(--v-theme-surface))","icon-color":"success","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[n("div",Je,_(o.remark),1),n("div",Ge,_(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(o.amount)),1),n("div",Xe,_(c(J)(o.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1}),e(te,null,{default:t(()=>[n("div",null,[d.data.outgoings.length?(u(),w(oe,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(M,null,T(d.data.outgoings,(o,s)=>(u(),w(ae,{key:s,icon:"tabler-arrow-up-right","dot-color":"rgba(var(--v-theme-surface))","icon-color":"warning","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[n("div",Ze,_(o.remark),1),n("div",Qe,_(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(o.amount)),1),n("div",et,_(c(J)(o.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1}),e(te,null,{default:t(()=>[n("div",null,[d.data.expenses.length?(u(),w(oe,{key:0,align:"start","truncate-line":"both",side:"end",density:"compact","line-thickness":"1",class:"table-container"},{default:t(()=>[(u(!0),S(M,null,T(d.data.expenses,(o,s)=>(u(),w(ae,{key:s,icon:"tabler-arrow-up-right-circle","dot-color":"rgba(var(--v-theme-surface))","icon-color":"error","fill-dot":"",size:"22",elevation:0,class:"text-no-wrap"},{default:t(()=>[n("div",tt,_(o.remark),1),n("div",ot,_(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(o.amount)),1),n("div",at,_(c(J)(o.date)),1)]),_:2},1024))),128))]),_:1})):P("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}};const st={key:0,class:"d-flex mb-8"},lt={class:"vehicle-progress-label position-relative mb-4 text-body-1 d-none d-sm-block text-truncate"},rt={class:"table-container"},it={width:"70%"},ct={class:"text-body-1 text-high-emphasis"},ut={class:"text-end"},dt={class:"font-weight-medium text-body-1 text-high-emphasis"},pt={class:"text-end"},mt={class:"text-body-1"},ft={__name:"NonKitchenOverview",props:{data:{type:Array,required:!0}},setup($){const d=$,i=F(()=>{const o=Array.isArray(d.data)?d.data:[],s=o.reduce((l,a)=>l+Number(a.amount||0),0);return o.map(l=>{var a,m;return{icon:k((a=l.finance_account)==null?void 0:a.description),title:((m=l.finance_account)==null?void 0:m.description)||"Unknown",amount:Number(l.amount||0),time:Number(l.amount||0).toLocaleString("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}),percentage:s>0?Number(l.amount||0)/s*100:0}})}),f=F(()=>{const o=i.value.slice().sort((b,V)=>V.amount-b.amount);if(o.length===0)return[];if(o.length<=4){const V=100/o.reduce((p,r)=>p+r.percentage,0);return o.map(p=>({...p,percentage:parseFloat((p.percentage*V).toFixed(1))}))}const s=o.slice(0,3),a=o.slice(3).reduce((b,V)=>b+V.percentage,0),m={title:"Lain-lain",percentage:parseFloat(a.toFixed(1)),icon:"tabler-dots"};return[...s.map(b=>({...b,percentage:parseFloat(b.percentage.toFixed(1))})),m]}),x=["rgba(var(--v-theme-on-surface), var(--v-hover-opacity))","rgb(var(--v-theme-primary))","rgb(var(--v-theme-info))","#212121"],g=o=>x[o%x.length],k=o=>({"Sewa Gedung":"tabler-building","Internet & Tools":"tabler-wifi","Gaji Karyawan":"tabler-users","Gaji Guru":"tabler-school"})[o]||"tabler-receipt-2";return(o,s)=>{const l=q;return u(),w(B,null,{default:t(()=>[e(L,{title:"Non Kitchen overview"},{append:t(()=>[e(l)]),_:1}),e(U,null,{default:t(()=>[f.value.length?(u(),S("div",st,[(u(!0),S(M,null,T(f.value,(a,m)=>(u(),S("div",{key:a.title,style:ve({"inline-size":`${a.percentage}%`})},[n("div",lt,_(a.title),1),e(c(_e),{color:g(m),"model-value":"100",height:"46",class:H({"rounded-s-0":m>0&&f.value.length>1,"rounded-e-0":m<f.value.length-1,"rounded-sm":f.value.length===1})},{default:t(()=>[n("strong",{class:H(["vehicle-progress-text",m>0?"text-white":""])},_(a.percentage)+"%",3)]),_:2},1032,["color","class"])],4))),128))])):P("",!0),n("div",rt,[e(fe,{class:"text-no-wrap"},{default:t(()=>[n("tbody",null,[(u(!0),S(M,null,T(i.value,(a,m)=>(u(),S("tr",{key:m},[n("td",it,[e(O,{icon:a.icon,size:"24",class:"me-2"},null,8,["icon"]),n("span",ct,_(a.title),1)]),n("td",ut,[n("div",dt,_(a.time),1)]),n("td",pt,[n("span",mt,_(a.percentage.toFixed(1))+"%",1)])]))),128))])]),_:1})])]),_:1})]),_:1})}}},_t=le(ft,[["__scopeId","data-v-a8ff2595"]]),me="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",ht="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",vt={__name:"PaymentDelivery",props:{data:{type:Object,default:()=>({text:[],value:[]})}},setup($){const d=$,i={donut:{series1:"#56ca00",series2:"#56ca00cc",series3:"#56ca0099",series4:"#56ca0066"}},f=F(()=>{const o=ne(d.data.value)||[];return o.length?o.reduce((s,l)=>s+Number(l),0)/o.length:0}),x=F(()=>{var o,s;return(s=(o=d.data)==null?void 0:o.value)!=null&&s.length?d.data.value.map(l=>Number(l)||0):[0]}),g={chart:{animations:{enabled:!1}},colors:[i.donut.series1,i.donut.series2,i.donut.series3,i.donut.series4],stroke:{width:0},dataLabels:{enabled:!1,formatter(o){return`${Number.parseInt(o)}%`}},legend:{show:!0,position:"bottom",offsetY:10,markers:{width:8,height:8,offsetX:-3},itemMargin:{horizontal:15,vertical:5},fontSize:"13px",fontWeight:400,labels:{colors:me,useSeriesColors:!1}},tooltip:{theme:!1},grid:{padding:{top:15}},plotOptions:{pie:{donut:{size:"75%",labels:{show:!0,value:{fontSize:"26px",color:me,fontWeight:500,offsetY:-15,formatter(o){return`${Number.parseInt(o)}%`}},name:{offsetY:30},total:{show:!0,fontSize:"0.75rem",fontWeight:400,label:"AVG. Total",color:ht,formatter:()=>`${Number.parseInt(f.value)}%`}}}}},responsive:[{breakpoint:420,options:{chart:{height:400}}}]},k=F(()=>{var o,s;return{...g,labels:(s=(o=d.data)==null?void 0:o.text)!=null&&s.length?d.data.text:["No Data"]}});return(o,s)=>{const l=q,a=ye;return u(),w(B,null,{default:t(()=>[e(L,{title:"Payment Delivery"},{append:t(()=>[e(l)]),_:1}),e(U,null,{default:t(()=>[e(a,{type:"donut",height:"400",options:k.value,series:x.value},null,8,["options","series"])]),_:1})]),_:1})}}};const gt={class:"table-container"},bt={class:"text-high-emphasis text-body-1 font-weight-medium"},yt={__name:"PaymentPerformance",props:{students:{type:Array,required:!0},payments:{type:Array,required:!0}},setup($){const d=$,i=new Date,f=i.toLocaleString("en-US",{month:"short"}),x=i.getFullYear(),g=`${f}-${x}`,k=F(()=>!d.students||d.students.length===0?[]:(console.log("deliveryData: ",k),d.students.map(o=>{const s=d.payments.filter(a=>a.admin_student_id===o.id&&a.billing&&a.billing.includes(g)),l=s.length>0;return{title:o.name,length:s.length,date:l?J(s[0].date)||s[0].date:"-",billing:l?s[0].billing:"Waiting",icon:l?"tabler-circle-check":"tabler-circle-x",color:l?s.length>=3?"success":"primary":"warning"}})));return(o,s)=>{const l=q;return u(),w(B,null,{default:t(()=>[e(L,{title:"Monthly overview",subtitle:g},{append:t(()=>[e(l)]),_:1}),e(U,null,{default:t(()=>[n("div",gt,[e(xe,{class:"card-list text-no-wrap"},{default:t(()=>[(u(!0),S(M,null,T(k.value,(a,m)=>(u(),w(Z,{key:m},{prepend:t(()=>[e(G,{color:a.color,variant:"tonal",rounded:"",size:"38"},{default:t(()=>[e(O,{icon:a.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])]),append:t(()=>[n("span",bt,_(a.date),1)]),default:t(()=>[e(se,null,{default:t(()=>[I(_(c(Ae)(a.title)),1)]),_:2},1024),e(Ne,null,{default:t(()=>[n("div",{class:H([a.billing=="Waiting"?"text-secondary":a.length>=3?"text-success":"text-primary","d-flex align-center"])},[e(O,{icon:a.billing=="Waiting"?"tabler-chevron-down":a.length>=3?"tabler-chevrons-up":"tabler-chevron-up",class:"me-1"},null,8,["icon"]),n("span",null,_(a.billing),1)],2)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1})]),_:1})}}},xt=le(yt,[["__scopeId","data-v-dd763171"]]),Vt={__name:"AddDepositDialog",props:{mode:{type:String,required:!0},selectedData:{type:Object,required:!1,default:()=>({id:null,title:"",amount:0,icon:"",color:""})},isDialogVisible:{type:Boolean,required:!0}},emits:["submit","delete","update:isDialogVisible"],setup($,{emit:d}){const i=$,f=d,x=C(),g=F(()=>i.mode==="add"?"Add Deposit":"Edit Deposit"),k=F(()=>i.mode==="add"?"Submit":"Update"),o=[{label:"Bank",value:"tabler-building-bank"},{label:"Piggy Bank",value:"tabler-pig-money"},{label:"Wallet",value:"tabler-wallet"},{label:"Credit Card",value:"tabler-credit-card"},{label:"Cash",value:"tabler-cash"}],s=[{text:"Primary",value:"primary"},{text:"Warning",value:"warning"},{text:"Info",value:"info"},{text:"Success",value:"success"},{text:"Error",value:"error"},{text:"Secondary",value:"secondary"}],l=C(structuredClone(ne(i.selectedData)));he(()=>i.isDialogVisible,p=>{p&&(l.value=structuredClone(ne(i.selectedData)))});const a=()=>{var p;(p=x.value)==null||p.validate().then(({valid:r})=>{r&&(f("update:isDialogVisible",!1),f("submit",{mode:i.mode,data:l.value}))})},m=()=>{f("update:isDialogVisible",!1)},b=()=>{l.value.id&&f("delete",l.value.id)},V=p=>{f("update:isDialogVisible",p)};return(p,r)=>{const h=Te,v=Me;return u(),w(Ee,{width:p.$vuetify.display.smAndDown?"auto":420,"model-value":i.isDialogVisible,"onUpdate:modelValue":V},{default:t(()=>[e(h,{onClick:r[0]||(r[0]=y=>V(!1))}),e(B,{class:"pa-sm-8 pa-5"},{default:t(()=>[e(L,{class:"text-center"},{default:t(()=>[e(Ve,{class:"text-h3"},{default:t(()=>[I(_(c(g)),1)]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(Pe,{ref_key:"refForm",ref:x,class:"mt-4",onSubmit:De(a,["prevent"])},{default:t(()=>[e(re,null,{default:t(()=>[e(A,{cols:"12"},{default:t(()=>[e(v,{modelValue:c(l).title,"onUpdate:modelValue":r[1]||(r[1]=y=>c(l).title=y),rules:["requiredValidator"in p?p.requiredValidator:c(ue)],label:"Title",placeholder:"Deposit Account"},null,8,["modelValue","rules"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(v,{modelValue:c(l).amount,"onUpdate:modelValue":r[2]||(r[2]=y=>c(l).amount=y),rules:["requiredValidator"in p?p.requiredValidator:c(ue)],label:"amount",placeholder:"Deposit Amount",type:"number"},null,8,["modelValue","rules"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(de,{modelValue:c(l).icon,"onUpdate:modelValue":r[3]||(r[3]=y=>c(l).icon=y),label:"Deposit Icon",placeholder:"Deposit Icon",items:o,"item-title":"label","item-value":"value"},{item:t(({props:y,item:D})=>[e(Z,Ce($e(y)),{default:t(()=>[e(O,{icon:D.raw.value,class:"me-2"},null,8,["icon"]),n("span",null,_(D.raw.label),1)]),_:2},1040)]),selection:t(({item:y})=>[e(O,{icon:y.raw.value,class:"me-2"},null,8,["icon"]),n("span",null,_(y.raw.label),1)]),_:1},8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:t(()=>[e(de,{modelValue:c(l).color,"onUpdate:modelValue":r[4]||(r[4]=y=>c(l).color=y),label:"Deposit Color",placeholder:"Deposit Color",items:s,"item-title":"text","item-value":"value"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12",class:"d-flex flex-wrap justify-center gap-2 mt-6"},{default:t(()=>[e(j,{type:"submit"},{default:t(()=>[I(_(c(k)),1)]),_:1}),e(j,{color:"secondary",variant:"tonal",onClick:m},{default:t(()=>r[5]||(r[5]=[I(" Cancel ")])),_:1}),i.mode==="edit"?(u(),w(j,{key:0,color:"error",variant:"tonal",onClick:b},{default:t(()=>r[6]||(r[6]=[I(" Delete ")])),_:1})):P("",!0)]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};const wt={class:"d-flex align-center gap-x-4 mb-2"},kt={class:"text-h5 font-weight-medium"},Dt={class:"text-body-1"},Ct={class:"d-flex gap-x-2"},$t={class:"text-h6 font-weight-medium"},St={class:"d-flex align-center gap-x-4 mb-2"},Nt={__name:"SaldoCardStatistics",setup($){const d=ge("userData"),i=C([]),f=C(!1),x=C("add"),g=C({}),k=async()=>{var r;try{const{data:h}=await R("/deposits"),v=((r=h.value)==null?void 0:r.data)||[],y=v.reduce((D,z)=>D+z.amount,0);i.value=v.map(D=>({...D,value:new Intl.NumberFormat("id-ID").format(D.amount),change:y>0?parseFloat((D.amount/y*100).toFixed(0)):0,isHover:!1}))}catch(h){a("Failed to fetch deposits.","error"),console.error(h)}};be(k);const o=C(!1),s=C(""),l=C("primary"),a=(r,h="primary")=>{s.value=r,l.value=h,o.value=!0,setTimeout(()=>{o.value=!1},1e4)},m=()=>{x.value="add",g.value={title:"",amount:0,icon:"tabler-building-bank",color:"primary"},f.value=!0},b=r=>{x.value="edit",g.value=JSON.parse(JSON.stringify(r)),f.value=!0},V=async r=>{var y;const{mode:h,data:v}=r;try{let D;if(h==="add"?D=await R("/deposits",{method:"POST",body:JSON.stringify(v),headers:{"Content-Type":"application/json",Accept:"application/json"}}):D=await R(`/deposits/${v.id}`,{method:"PUT",body:JSON.stringify(v),headers:{"Content-Type":"application/json",Accept:"application/json"}}),(y=D.response.value)!=null&&y.ok)a(`Deposit ${h==="add"?"added":"updated"} successfully.`,"success"),k();else{const z=D.data.value,K=z!=null&&z.errors?Object.values(z.errors).flat().join(`
`):(z==null?void 0:z.message)||`Failed to ${h} deposit.`;a(K,"error")}}catch(D){a(`Failed to ${h} deposit.`,"error"),console.error(D)}},p=async r=>{try{await R(`/deposits/${r}`,{method:"DELETE"}),a("Deposit deleted successfully.","success"),k()}catch(h){a("Failed to delete deposit.","error"),console.error(h)}f.value=!1};return(r,h)=>(u(),w(re,null,{default:t(()=>[e(Be,{modelValue:c(o),"onUpdate:modelValue":h[1]||(h[1]=v=>X(o)?o.value=v:null),location:"center",variant:"tonal",transition:"scale-transition",color:c(l),class:"text-center"},{actions:t(()=>[e(j,{color:c(l),onClick:h[0]||(h[0]=v=>o.value=!1)},{default:t(()=>h[3]||(h[3]=[I(" Close ")])),_:1},8,["color"])]),default:t(()=>[I(_(c(s))+" ",1)]),_:1},8,["modelValue","color"]),(u(!0),S(M,null,T(c(i),(v,y)=>(u(),w(A,{key:y,cols:"12",md:c(i).length<=2?6:c(i).length<=4?3:c(i).length<=6?2:6,sm:"6"},{default:t(()=>[n("div",null,[e(B,{class:"logistics-card-statistics cursor-pointer",style:ve(v.isHover?{"border-block-end":`2px solid rgba(var(--v-theme-${v.color}))`}:{"border-block-end":`2px solid rgba(var(--v-theme-${v.color}), var(--v-disabled-opacity))`}),onClick:D=>b(v),onMouseenter:D=>v.isHover=!0,onMouseleave:D=>v.isHover=!1},{default:t(()=>[e(U,null,{default:t(()=>[n("div",wt,[e(G,{variant:"tonal",class:"avatar-hover",color:v.color,rounded:""},{default:t(()=>[e(O,{icon:v.icon,size:"28"},null,8,["icon"])]),_:2},1032,["color"]),n("h5",kt,_(v.value),1)]),n("div",Dt,_(v.title),1),n("div",Ct,[n("h6",$t,_(v.change)+"% ",1),h[4]||(h[4]=n("span",{class:"text-disabled"},"from Total",-1))])]),_:2},1024)]),_:2},1032,["style","onClick","onMouseenter","onMouseleave"])])]),_:2},1032,["md"]))),128)),c(i).length==0||c(i).length%2!==0||c(d).admin_teacher_id?(u(),w(A,{key:0,md:c(i).length<=2?6:c(i).length<=4?3:c(i).length<=6?2:6,cols:"12",sm:"6",onClick:m},{default:t(()=>[n("div",null,[e(B,{class:"logistics-card-statistics cursor-pointer"},{default:t(()=>[e(U,null,{default:t(()=>[n("div",St,[e(G,{variant:"tonal",class:"avatar-hover",rounded:"",size:"85"},{default:t(()=>[e(O,{size:"42",icon:"tabler-plus"})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["md"])):P("",!0),c(d).admin_teacher_id?(u(),w(Vt,{key:1,"is-dialog-visible":c(f),"onUpdate:isDialogVisible":h[2]||(h[2]=v=>X(f)?f.value=v:null),mode:c(x),"selected-data":c(g),onSubmit:V,onDelete:p},null,8,["is-dialog-visible","mode","selected-data"])):P("",!0)]),_:1}))}},At=le(Nt,[["__scopeId","data-v-895108c5"]]),wo={__name:"finance",setup($){const d=ge("userData"),i=C([]),f=C([]),x=C([]),g=C([]),k=C([]),o=C([]),s=C([]),l=C({text:[],value:[]}),a=C([]);C("");async function m(V=""){var K,ie;const r=(await R(`/dashboard-finance?year=${V}`)).data.value;if(console.log("financeData: ",r),!r)return;i.value=r.nonKitchen||[],f.value=r.houseHold||[],x.value=r.students||[],g.value=r.expenses||[],k.value=r.outgoings||[],o.value=r.inputs||[],s.value=r.payCurrentMonth||[];const h=r.payDelivery||[];l.value={text:h.map(N=>N.billing),value:h.map(N=>N.amount>0?Math.round(Number(N.paidAmount)/N.amount*100):0)};const v=((K=r.allocation)==null?void 0:K.finances)||[],y=((ie=r.allocation)==null?void 0:ie.payments)||[],D=v.reduce((N,E)=>N+Number(E.amount),0),z=Array.from(new Set([...v.map(N=>N.allocation),...y.map(N=>N.number)]));a.value=z.map(N=>{const E=v.find(ee=>ee.allocation===N),W=y.find(ee=>ee.number===N),Y=Number((E==null?void 0:E.amount)||0),Q=Number((W==null?void 0:W.amount)||0);return{...E,...W,allocation:(W==null?void 0:W.description)||(E==null?void 0:E.description)||"",payment:Q,expense:Y,balance:Q-Y,percentage:D>0?Y/D*100:0,remain:Y>0?100-Math.round((Q-Y)/Y*100):100}})}const b=V=>{m(V)};return be(()=>m()),(V,p)=>(u(),w(re,{class:"match-height"},{default:t(()=>[e(A,{cols:"12"},{default:t(()=>[e(At)]),_:1}),e(A,{cols:"12",md:"6"},{default:t(()=>[e(_t,{data:i.value},null,8,["data"])]),_:1}),e(A,{cols:"12",md:"6"},{default:t(()=>[e(Ke,{data:f.value,onYearSelected:b},null,8,["data"])]),_:1}),c(d).admin_teacher_id?(u(),w(A,{key:0,cols:"12",md:"4"},{default:t(()=>[e(xt,{payments:s.value,students:x.value},null,8,["payments","students"])]),_:1})):P("",!0),e(A,{cols:"12",md:c(d).admin_teacher_id?4:6},{default:t(()=>[e(vt,{data:l.value},null,8,["data"])]),_:1},8,["md"]),e(A,{cols:"12",md:c(d).admin_teacher_id?4:6},{default:t(()=>[e(nt,{data:{expenses:g.value,outgoings:k.value,inputs:o.value}},null,8,["data"])]),_:1},8,["md"]),e(A,{cols:"12"},{default:t(()=>[c(d).admin_teacher_id?(u(),w(je,{key:0,data:a.value},null,8,["data"])):P("",!0)]),_:1})]),_:1}))}};export{wo as default};
