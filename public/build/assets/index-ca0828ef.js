import{a as H}from"./formatters-8cae111f.js";import{_ as J}from"./AppSelect-f110362d.js";import{_ as L}from"./AppTextField-b5461782.js";import{u as Q,g as $}from"./helpers-c88007fe.js";import{p as K}from"./paginationMeta-4ad053a4.js";import{u as j}from"./useApi-c1588dfc.js";import{a as W}from"./fetchUserData-06cd6fab.js";import{_ as X,r as c,a6 as D,a as Y,o as d,c as h,b as r,e as o,n as l,aV as v,d as u,F as Z,v as g,x as m,aj as C,f as k,y as ee,a1 as E,s as I}from"./main-4585feec.js";import{V as ae}from"./VAlert-83fb7352.js";import{V as se}from"./VCard-a267c840.js";import{V as te}from"./VCardText-dd0c7bc9.js";import{V as M}from"./VDivider-e2924383.js";import{V as le}from"./VDataTableServer-73173b80.js";import{V as N}from"./VAvatar-fa9fec94.js";import{V as oe}from"./VImg-02cfc59c.js";import{V as re}from"./VChip-aabda9ce.js";import{V as ne}from"./VPagination-f3dedd03.js";import"./form-075a7c7b.js";import"./VSelect-e95c30a5.js";import"./VTextField-d2aea9dd.js";/* empty css                   */import"./VCounter-2f9e53e6.js";import"./VField-3decac3d.js";import"./easing-9f15041e.js";import"./VInput-3fb3d6fe.js";import"./forwardRefs-8348545e.js";import"./VList-4b4f9347.js";import"./ssrBoot-7fdf6b89.js";import"./dialog-transition-a9ebe0dc.js";import"./VMenu-dc1c4301.js";import"./VOverlay-27dbbcf8.js";import"./lazy-3e6a3ff5.js";import"./scopeId-326ce56f.js";import"./VCheckboxBtn-42d04193.js";import"./VSelectionControl-272cc15c.js";import"./no-profile-4221a4a6.js";import"./VDataTable-85865fe4.js";import"./VTable-7e1650ac.js";import"./filter-bef9984d.js";const ie={class:"d-flex justify-space-between flex-wrap gap-y-4"},ce={class:"d-flex flex-row gap-4 align-center flex-wrap"},de={class:"d-flex align-center gap-x-3"},ue={key:1},me={class:"d-flex flex-column"},pe={class:"font-weight-medium"},fe={class:"text-sm text-disabled"},ve={key:1,class:"text-capitalize"},ge={key:1},ye={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},_e={class:"text-sm text-disabled mb-0"},xe={__name:"index",setup(Ve){const{hasRole:A}=Q(),y=c(""),_=c(!1),T=c(""),S=c("primary"),x=(s,a="primary")=>{T.value=s,S.value=a,_.value=!0,setTimeout(()=>{_.value=!1},1e4)},n=c(10),i=c(1),w=c(""),P=c(""),B=c([]),F=s=>{var a;i.value=s.page,n.value=s.itemsPerPage,y.value=s.search||"",(a=s.sortBy)!=null&&a.length?(w.value=s.sortBy[0].key,P.value=s.sortBy[0].order):(w.value=null,P.value=null),b()},G=[{title:"Name",key:"name"},{title:"Member",key:"admin_student_id"},{title:"Role",key:"role"},{title:"Access",key:"access"},{title:"Actions",key:"actions",sortable:!1}],R=["Profile","Project","Awards","Courses","Assessment","Saving","Payment","Finance"],O=async s=>{try{confirm("Apakah kamu yakin ingin menghapus data ini?")&&(console.log("Deleting user with ID:",s),await j(`/users/${s}`,{method:"DELETE"}),x("Data berhasil dihapus","success"),b())}catch(a){x(a.message||"Gagal menghapus data","error"),console.error(a)}},z=async s=>{var a;console.log("Updating user:",s.id,s);try{const t={...s};Array.isArray(t.access)?t.access=t.access.filter(Boolean).join(","):typeof t.access=="string"&&t.access.includes(",")||(t.access===null||t.access===void 0||t.access==="")&&(t.access=null);const{data:p,response:V}=await j(`/users/${s.id}`,{method:"PATCH",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Accept:"application/json"}});V.value.ok?(x("Data berhasil diperbarui","success"),console.log("User updated:",p),b()):(x(V.value.statusText||"Gagal memperbarui data","error"),console.error("Update error response:",V.value))}catch(t){console.error("Update user error:",((a=t==null?void 0:t.data)==null?void 0:a.errors)||t),x(t.message||"Gagal memperbarui data","error")}},b=async()=>{const s={q:y.value||"",itemsPerPage:n.value,page:i.value,sortBy:w.value||"",orderBy:P.value||""};try{const a=await W(s);console.log("ðŸ“¦ FETCHING with:",s,a),a.users&&Array.isArray(a.users)&&(a.users=a.users.map(t=>(typeof t.access=="string"&&t.access.length>0?t.access=t.access.split(",").map(p=>p.trim()).filter(Boolean):t.access=[],t))),B.value=a}catch(a){console.error("Error fetching students:",a.message)}},q=D(()=>{var s;return((s=B.value)==null?void 0:s.users)||[]}),U=D(()=>{var s;return((s=B.value)==null?void 0:s.totalUsers)||0});return(s,a)=>{const t=L,p=J,V=Y("IconBtn");return d(),h(Z,null,[r(ae,{modelValue:l(_),"onUpdate:modelValue":a[0]||(a[0]=e=>v(_)?_.value=e:null),closable:"","close-label":"Close Alert",class:"mb-6",color:l(S)},{default:o(()=>[g(m(l(T)),1)]),_:1},8,["modelValue","color"]),u("div",null,[r(se,null,{default:o(()=>[r(te,null,{default:o(()=>[u("div",ie,[r(t,{modelValue:l(y),"onUpdate:modelValue":[a[1]||(a[1]=e=>v(y)?y.value=e:null),b],style:{"max-inline-size":"200px","min-inline-size":"200px"},placeholder:"Search ..",density:"compact"},null,8,["modelValue"]),u("div",ce,[r(p,{modelValue:l(n),"onUpdate:modelValue":a[2]||(a[2]=e=>v(n)?n.value=e:null),density:"compact",items:[5,10,20,50,100]},null,8,["modelValue"]),r(C,{"prepend-icon":"tabler-screen-share",variant:"tonal",color:"secondary"},{default:o(()=>a[6]||(a[6]=[g(" Export ")])),_:1})])])]),_:1}),r(M),r(l(le),{"items-per-page":l(n),"onUpdate:itemsPerPage":a[4]||(a[4]=e=>v(n)?n.value=e:null),page:l(i),"onUpdate:page":a[5]||(a[5]=e=>v(i)?i.value=e:null),items:l(q),headers:G,"items-length":l(U),class:"text-no-wrap","onUpdate:options":F},{"item.name":o(({item:e})=>[u("div",de,[r(N,{size:"34",variant:e.image?void 0:"tonal",class:"me-3 overflow-hidden"},{default:o(()=>[e!=null&&e.image?(d(),k(oe,{key:0,cover:"",src:`/storage/${e.image}`},null,8,["src"])):(d(),h("span",ue,m(("avatarText"in s?s.avatarText:l(H))(e.name)),1))]),_:2},1032,["variant"]),u("div",me,[u("div",pe,m(e.name),1),u("span",fe,m(e.email),1)])])]),"item.admin_student_id":o(({item:e})=>[r(re,{color:e.admin_student_id>0?"primary":"info",size:"small",label:"",class:"text-capitalize"},{default:o(()=>[g(m(e.admin_student_id>0?"Student":"Teacher"),1)]),_:2},1032,["color"])]),"item.role":o(({item:e})=>[l(A)(4).value?(d(),k(p,{key:0,modelValue:e.role,"onUpdate:modelValue":[f=>e.role=f,f=>z(e)],items:[{text:"Annonimous",value:0},{text:"Guest",value:1},{text:"User",value:2},{text:"Superuser",value:3},{text:"Manager",value:4},{text:"Programmer",value:5}],"item-title":"text","item-value":"value"},null,8,["modelValue","onUpdate:modelValue"])):(d(),h("span",{key:1,class:ee(l($)(e.role).color)},[r(N,{size:"30",variant:"tonal",class:"me-2"},{default:o(()=>[r(E,{icon:"tabler-user-square-rounded",size:"18"})]),_:1}),g(" "+m(l($)(e.role).label),1)],2))]),"item.access":o(({item:e})=>[l(A)(4).value?(d(),k(p,{key:0,modelValue:e.access,"onUpdate:modelValue":[f=>e.access=f,f=>z(e)],placeholder:"Select Access",multiple:"",items:R},null,8,["modelValue","onUpdate:modelValue"])):(d(),h("span",ve,m(e.access.length),1))]),"item.actions":o(({item:e})=>[l(A)(4).value?(d(),k(V,{key:0,onClick:f=>O(e.id)},{default:o(()=>[r(E,{icon:"tabler-trash"})]),_:2},1032,["onClick"])):(d(),h("span",ge,m(e.role===5?"Develop":e.role===4?"Delete":e.role===3?"Update":e.role===2?"Create":e.role===1?"Read":"Unknown"),1))]),bottom:o(()=>[r(M),u("div",ye,[u("p",_e,m(l(K)({page:l(i),itemsPerPage:l(n)},l(U))),1),r(ne,{modelValue:l(i),"onUpdate:modelValue":a[3]||(a[3]=e=>v(i)?i.value=e:null),length:Math.ceil(l(U)/l(n)),"total-visible":s.$vuetify.display.xs?1:Math.min(Math.ceil(l(U)/l(n)),5)},{prev:o(e=>[r(C,I({variant:"tonal",color:"default"},e,{icon:!1}),{default:o(()=>a[7]||(a[7]=[g(" Previous ")])),_:2},1040)]),next:o(e=>[r(C,I({variant:"tonal",color:"default"},e,{icon:!1}),{default:o(()=>a[8]||(a[8]=[g(" Next ")])),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1})])],64)}}},ra=X(xe,[["__scopeId","data-v-ce8b38f8"]]);export{ra as default};
